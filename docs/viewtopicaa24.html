<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=1895&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:42:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; error configure abinit with openmpi or error in practice</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>error configure abinit with openmpi or error in practice</h2>
		<p><a href="viewtopice43c.html?f=3&amp;t=1895">https://forum.abinit.org/viewtopic.php?f=3&amp;t=1895</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Mon Nov 26, 2012 8:35 am</strong></div>
				<div class="author">by <strong>arsyik</strong></div>
				<div class="content">Hello Dear,<br /><br />Please help me,<br /><br />&quot;OS OpenSUSE 11.4 32bit<br />in Computer Pentium Dual Core&quot;<br /><br />i use openmpi 1.6.2, extract and configure at /home/usrname/openmpi<br /><br />Setting LD_LIBRARY_PATH=&quot;/openmpi/lib/&quot; in .bashrc file<br /><br />and configure abinit with this command ./configure --enable-mpi --with-mpi-level=2 FC=gfortran --with-mpi-prefix=&quot;/home/usrname/openmpi&quot; --with-linalg-libs=&quot;-llapack -lbas&quot;<br /><br />give me this report<br /><br />Summary of important options:<br /><br />  * C compiler      : gnu version 4.5<br />  * Fortran compiler: gnu version 4.5<br />  * architecture    : unknown unknown (32 bits)<br /><br />  * debugging       : basic<br />  * optimizations   : standard<br /><br />  * MPI    enabled  : yes<br />  * MPI-IO enabled  : yes<br />  * GPU    enabled  : no (none)<br /><br />  * TRIO   flavor = netcdf-fallback+etsf_io-fallback<br />  * TIMER  flavor = abinit (libs: ignored)<br />  * LINALG flavor = netlib-fallback (libs: internal)<br />  * ALGO   flavor = none (libs: ignored)<br />  * FFT    flavor = none (libs: ignored)<br />  * MATH   flavor = none (libs: ignored)<br />  * DFT    flavor = libxc-fallback+atompaw-fallback+bigdft-fallback+wannier90-fallback<br /><br />Configuration complete.<br />You may now type &quot;make&quot; to build ABINIT.<br />(or, on a SMP machine, &quot;make mj4&quot;, or &quot;make multi multi_nprocs=&lt;n&gt;&quot;)<br /><br />then i type make multi multi_nprocs=2<br />give me this report <br /><br />==============================================================================<br />make[4]: Leaving directory `/home/arsyik/abinit/tests'<br />make[3]: Leaving directory `/home/arsyik/abinit/tests'<br />make[3]: Entering directory `/home/arsyik/abinit'<br />make[3]: Leaving directory `/home/arsyik/abinit'<br />make[2]: Leaving directory `/home/arsyik/abinit'<br />make[1]: Leaving directory `/home/arsyik/abinit'<br /><br />finally i type sudo make install<br />and give me this<br />.......<br />/bin/mkdir -p '/usr/local/share/abinit-test/fox'<br /> /usr/bin/install -c -m 644  fox/README fox/tests.cnf '/usr/local/share/abinit-test/fox'<br />make[3]: Leaving directory `/home/arsyik/abinit/tests'<br />make[2]: Leaving directory `/home/arsyik/abinit/tests'<br />make[1]: Leaving directory `/home/arsyik/abinit/tests'<br />make[1]: Entering directory `/home/arsyik/abinit'<br />make[2]: Entering directory `/home/arsyik/abinit'<br />make[2]: Nothing to be done for `install-exec-am'.<br />/usr/bin/install -c -d -m 755 /usr/local/lib/pkgconfig<br />/usr/bin/install -c -m 644 -m 644 config.pc \<br /> /usr/local/lib/pkgconfig/abinit.pc<br />make[2]: Leaving directory `/home/arsyik/abinit'<br />make[1]: Leaving directory `/home/arsyik/abinit'<br /><br />and i tried to run  <br />mpirun -np 2 /usr/local/bin/abinit &lt; tparal_1.files&gt; tparal.log<br />        or<br />mpirun -np 2 abinit &lt; tparal_1.files&gt; tparal.log<br /><br />that's give the same error <br /><br />[linux-u242.site:10094] [NO-NAME] ORTE_ERROR_LOG: Not found in file runtime/orte_init_stage1.c at line 182<br />--------------------------------------------------------------------------<br />It looks like orte_init failed for some reason; your parallel process is<br />likely to abort.  There are many reasons that a parallel process can<br />fail during orte_init; some of which are due to configuration or<br />environment problems.  This failure appears to be an internal failure;<br />here's some additional information (which may only be relevant to an<br />Open MPI developer):<br /><br />  orte_rml_base_select failed<br />  --&gt; Returned value -13 instead of ORTE_SUCCESS<br /><br />--------------------------------------------------------------------------<br />[linux-u242.site:10094] [NO-NAME] ORTE_ERROR_LOG: Not found in file runtime/orte_system_init.c at line 42<br />[linux-u242.site:10094] [NO-NAME] ORTE_ERROR_LOG: Not found in file runtime/orte_init.c at line 52<br />--------------------------------------------------------------------------<br />Open RTE was unable to initialize properly.  The error occured while<br />attempting to orte_init().  Returned value -13 instead of ORTE_SUCCESS.<br />--------------------------------------------------------------------------<br />How to fix it?<br /><br />thanks in advance</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Mon Nov 26, 2012 12:07 pm</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content">Hi,<br /><br />Several comments about your Abinit configure step <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>./configure --enable-mpi --with-mpi-level=2 FC=gfortran --with-mpi-prefix=&quot;/home/usrname/openmpi&quot; --with-linalg-libs=&quot;-llapack -lbas&quot;</code></pre></div><br />--with-mpi-prefix expects the root path where MPI has been installed i.e. a path with subdirs like bin, lib, include, ... If I understand /home/username/openmpi is the place where you built (compiled) openmpi and not where openmpi has been installed during the make install step. Seeing your LD_LIBRARY_PATH, I assume openmpi lives in /opempi (you should have /openmpi/bin/mpif90, /opempi/lib/, ...) and --with-mpi-prefix should equal /openmpi. Add PATH=/openmpi/bin:$PATH to help configure to find your mpi binaries in this unusual place.<br />Don't set FC=gfortran ... your fortran compiler is now mpif90. Try mpif90 -show, it should return the name of the backend gfortran compiler. Try which mpif90, it should return /openmpi/bin/mpif90<br />--with-mpi-level=2 is useless; openmpi is level 2 compliant.<br />--with-linalg-libs= .... first of all, it should be -lblas instead of -lbas and if your intention is to use the linear algebra libraries provided by Abinit, the option is useless<br /><br />All this to say that Abinit should configure with a configure --enable-mpi --with-mpi-prefix=/openmpi and the mentioned environment variables.<br />Please mention the version of Abinit you're working on.<br /><br />Kind regards,<br /><br />Alain</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Tue Nov 27, 2012 6:56 am</strong></div>
				<div class="author">by <strong>arsyik</strong></div>
				<div class="content">Hi,<br />Thanks for your reply<br /><br />i'm using abinit 6.12.3 and openmpi 1.6.2<br /><br />now i configure with this command <br /> ./configure --enable-mpi FC=mpif90 --with-mpi-prefix=&quot;/usr/lib/mpi/gcc/bin&quot; --with-linalg-libs=&quot;-llapack -lblas&quot;<br /><br />and give this report<br /> ==============================================================================<br /> === Overall startup                                                        ===<br /> ==============================================================================<br /><br />checking build system type... i686-pc-linux-gnu<br />checking host system type... i686-pc-linux-gnu<br />checking target system type... i686-pc-linux-gnu<br />checking for a BSD-compatible install... /usr/bin/install -c<br />checking whether build environment is sane... yes<br />checking for a thread-safe mkdir -p... /bin/mkdir -p<br />checking for gawk... gawk<br />checking whether make sets $(MAKE)... yes<br />checking whether make sets $(MAKE)... (cached) yes<br />checking whether ln -s works... yes<br />checking for a sed that does not truncate output... /usr/bin/sed<br />checking for gawk... (cached) gawk<br />checking for grep that handles long lines and -e... /usr/bin/grep<br />checking for egrep... /usr/bin/grep -E<br />configure: not loading options (no config file available)<br /><br /> ==============================================================================<br /> === Build-system information                                               ===<br /> ==============================================================================<br /><br />configure: ABINIT version 6.12.3<br />configure: M4 010416 - Autoconf 026800 - Automake 011100 - Libtool 020204<br />configure: reporting user interface changes:<br />configure:  * new option --enable-gui is available<br />configure:  * new option --enable-gw-openmp is available<br />configure:  * new option --with-algo-flavor is available<br />configure:  * new option --with-algo-incs is available<br />configure:  * new option --with-algo-libs is available<br />configure:  * --with-fallbacks-tardir removed<br /><br /> ==============================================================================<br /> === Option consistency checking                                            ===<br /> ==============================================================================<br /><br />configure: checking consistency of library-related options<br />configure:  |---&gt; all OK<br />configure: <br />configure: checking consistency of experimental options<br />configure:  |---&gt; all OK<br />configure: <br />configure:  |---&gt; all OK<br />configure: <br />configure: parsing command-line options<br /><br /> ==============================================================================<br /> === Multicore architecture startup                                         ===<br /> ==============================================================================<br /><br />configure: Initializing MPI support<br />configure: looking for MPI in /usr/lib/mpi/gcc/openmpi/bin<br />checking for a MPI C compiler... none found<br />checking for a MPI C++ compiler... none found<br />checking for a MPI Fortran compiler... none found<br />checking for a MPI runner... none found<br />configure: GPU support disabled from command-line<br /><br /> ==============================================================================<br /> === Utilities                                                              ===<br /> ==============================================================================<br /><br />checking for sh... /usr/bin/sh<br />checking for mv... /bin/mv<br />checking for perl... /usr/bin/perl<br />checking for rm... /bin/rm<br />checking for patch... patch<br />checking for tar... tar<br /><br /> ==============================================================================<br /> === C support                                                              ===<br /> ==============================================================================<br /><br />checking for gcc... gcc<br />checking whether the C compiler works... yes<br />checking for C compiler default output file name... a.out<br />checking for suffix of executables... <br />checking whether we are cross compiling... no<br />checking for suffix of object files... o<br />checking whether we are using the GNU C compiler... yes<br />checking whether gcc accepts -g... yes<br />checking for gcc option to accept ISO C89... none needed<br />checking for style of include used by make... GNU<br />checking dependency style of gcc... gcc3<br />checking how to run the C preprocessor... gcc -E<br />checking which type of compiler we have... gnu 4.5<br />checking for ANSI C header files... yes<br />checking for sys/types.h... yes<br />checking for sys/stat.h... yes<br />checking for stdlib.h... yes<br />checking for string.h... yes<br />checking for memory.h... yes<br />checking for strings.h... yes<br />checking for inttypes.h... yes<br />checking for stdint.h... yes<br />checking for unistd.h... yes<br />checking whether byte ordering is bigendian... no<br /><br /> ==============================================================================<br /> === C++ support                                                            ===<br /> ==============================================================================<br /><br />checking for g++... g++<br />checking whether we are using the GNU C++ compiler... yes<br />checking whether g++ accepts -g... yes<br />checking dependency style of g++... gcc3<br />checking which type of C++ compiler we have... gnu 4.5<br /><br /> ==============================================================================<br /> === Fortran support                                                        ===<br /> ==============================================================================<br /><br />checking for mpif90... /usr/lib/mpi/gcc/openmpi/bin/mpif90<br />checking whether we are using the GNU Fortran compiler... yes<br />checking whether mpif90 accepts -g... yes<br />checking which type of Fortran compiler we have... gnu 4.5<br />checking fortran 90 modules extension... mod<br />checking for Fortran flag to compile .F90 files... none<br />configure: determining Fortran module case<br />checking whether Fortran modules are upper-case... no<br />checking how to get verbose linking output from mpif90... -v<br />checking for Fortran libraries of mpif90...  -L/usr/lib/mpi/gcc/openmpi/lib -L/usr/lib/gcc/i586-suse-linux/4.5 -L/usr/lib/gcc/i586-suse-linux/4.5/../../../../i586-suse-linux/lib -L/usr/lib/gcc/i586-suse-linux/4.5/../../.. -lmpi_f90 -lmpi_f77 -lmpi -lopen-rte -lopen-pal -ldl -lnsl -lutil -lgfortran -lm -lpthread<br />checking for dummy main to link with Fortran libraries... unknown<br />configure: error: in `/home/arsyik/abinit':<br />configure: error: linking to Fortran libraries from C fails<br />See `config.log' for more details<br />arsyik@linux-u277:~/abinit&gt; <br /><br />What should i do next?<br /><br />Thanks</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Tue Nov 27, 2012 6:59 am</strong></div>
				<div class="author">by <strong>arsyik</strong></div>
				<div class="content">This my configure log file.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Tue Nov 27, 2012 12:02 pm</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content"><blockquote class="uncited"><div>configure: Initializing MPI support<br />configure: looking for MPI in /usr/lib/mpi/gcc/openmpi/bin<br />checking for a MPI C compiler... none found<br />checking for a MPI C++ compiler... none found<br />checking for a MPI Fortran compiler... none found<br />checking for a MPI runner... none found</div></blockquote><br /><br />configure cannot find the MPI executables and config.log shows that the MPI libraries cannot be located too. The --with-mpi-prefix option refers to the root of your MPI installation, configure expects to find the bin, lib, include subdirectories under the prefix path i.e. if you set --with-mpi-prefix=/xxx then you should find /xxx/bin/mpif90 executable and /xxx/lib/libmpi.so or /xxx/lib/libmpi.a.<br />So I assume that the right mpi-prefix for your system is /usr/lib/mpi/gcc/openmpi<br /><br />Kind regards,<br /><br />Alain</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Tue Nov 27, 2012 7:21 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content">Dear arsylik,<br /><br />I noticed that there could have a problem with your command (even with Alain's correction)<br /><br /><blockquote class="uncited"><div>./configure --enable-mpi FC=mpif90 --with-mpi-prefix=&quot;/usr/lib/mpi/gcc/openmpi&quot; --with-linalg-libs=&quot;-llapack -lblas&quot;</div></blockquote><br /><br />if you want to use your own linalg libs, you need to add ( replace the LIBPATH by the right path  <img class="smilies" src="images/smilies/icon_e_wink.gif" alt=";)" title="Wink" /> ):<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>--with-linalg-flavor=&quot;netlib&quot;&nbsp; &nbsp;--with-linalg-libs=&quot;-L${LIBPATH}/lib -llapack -lblas&quot;&nbsp; --with-linalg-incs=&quot;-L${LIBPATH}/include&quot; </code></pre></div><br /><br />and , also, in your environment, <br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>export LD_LIBRARY_PATH=/usr/lib/mpi/gcc/openmpi/lib:$LD_LIBRARY_PATH<br />export PATH=/usr/lib/mpi/gcc/openmpi/bin:$PATH</code></pre></div><br /><br />regards<br /><br />jmb</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: error configure abinit with openmpi or error in practice</h3>
				<div class="date">Posted: <strong>Fri Nov 30, 2012 4:59 am</strong></div>
				<div class="author">by <strong>arsyik</strong></div>
				<div class="content">Thanks for your reply<br /><br />now i'm doing this <br />./configure --with-linalg-flavor=netlib --enable-mpi FC=mpif90 --with-mpi-prefix=/usr/lib/mpi/gcc/openmpi<br /><br />make mj4<br />sudo make mj4 install<br /><br />then i tried to running abinit with mpirun with this command<br />mpirun -n 2 /usr/local/bin/abinit &lt; tparal_1.files &gt;&amp;log<br /><br />and in output file show this<br /><br />--------------------------------------------------------------------------------<br />------------- Echo of variables that govern the present computation ------------<br />--------------------------------------------------------------------------------<br />-<br />- outvars: echo of selected default values                                      <br />-   accesswff0 =  0 , fftalg0 =112 , wfoptalg0 =  0<br />-<br />- outvars: echo of global parameters not present in the input file              <br />-   nproc =    1<br />-<br /> -outvars: echo values of preprocessed input variables --------<br /><br />what should i do?<br />Thanks in advance<br /><br />arsyik</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=1895&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:42:19 GMT -->
</html>
