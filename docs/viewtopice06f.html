<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1324&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:55:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Finite electric field calculations without fixing ions</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Finite electric field calculations without fixing ions</h2>
		<p><a href="viewtopiccfe8.html?f=9&amp;t=1324">https://forum.abinit.org/viewtopic.php?f=9&amp;t=1324</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Sep 19, 2011 11:29 am</strong></div>
				<div class="author">by <strong>Anwar</strong></div>
				<div class="content">Hi everybody. I'm a newcomer and an inexperienced user of ABINIT. <br /><br />I've been trying to calculate the polarization of perovskite BaTiO3 as a function of finite electric field. So, following the tutorial about polarization and electric filed, I calculated the polarization for various electric field (using a structure that I have optimized previously). <br /><br />The problem I face is that the Polarization vs. Electric Filed curve comes out as a straight-line even for electric fields as high as 0.0001 a.u. Also there is no sign of hysteresis.<br /><br />So I thought may be the problem is that the nuclear positions are fixed in the tutorial whereas the hysteresis / polarization switching in perovskites is due to the movement of central B atom and the O atoms under electric field.<br /><br />Is there anyway to to calculate the polarization of a crystal without fixing the ions (i.e. with ionmov  = 2 or 6)? <br /><br />This is my input file:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code><br /><br /><br />#Definition of the elementary cell<br />#*********************************<br />&nbsp; &nbsp;acell 7.5120216890E+00&nbsp; 7.5120216890E+00&nbsp; 7.6915729471E+00 Bohr<br />&nbsp; &nbsp;rprim 1 0 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 1 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 0 1<br /><br />#Definition of the atoms<br />#***********************<br />&nbsp; &nbsp;natom 5<br />&nbsp; &nbsp;ntypat 3<br />&nbsp; &nbsp;znucl&nbsp; &nbsp;56 22 08<br />&nbsp; &nbsp;typat 1 2 3 3 3<br />&nbsp; &nbsp;ixc 11<br />&nbsp; &nbsp;xred&nbsp; &nbsp;0.0000000000E+00&nbsp; 0.0000000000E+00&nbsp; 0.0000000000E+00<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.0000000000E-01&nbsp; 5.0000000000E-01&nbsp; 5.1430000000E-01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.0000000000E-01&nbsp; 5.0000000000E-01 -3.0760000000E-02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.0000000000E-01&nbsp; 0.0000000000E+00&nbsp; 4.8422377187E-01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.0000000000E+00&nbsp; 5.0000000000E-01&nbsp; 4.8422377187E-01<br /><br />#Definition of the SCF procedure<br />#*******************************<br />&nbsp; &nbsp;iscf 5<br />&nbsp; &nbsp;nstep 100<br />&nbsp; &nbsp;nband 12<br />&nbsp; &nbsp;nbdbuf 0<br /><br /><br />#Definition of the plane wave basis set<br />#**************************************<br />&nbsp; &nbsp;ecut&nbsp; 35<br />&nbsp; &nbsp;ecutsm 0.5<br />&nbsp; &nbsp;dilatmx 1.15<br />&nbsp; &nbsp;ngkpt 6 6 6<br />&nbsp; &nbsp;nshiftk 1<br />&nbsp; &nbsp;shiftk 0.5 0.5 0.5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp;toldfe 1.0d-12<br />&nbsp; &nbsp;tphysel 300 K<br />&nbsp; &nbsp;getwfk&nbsp; -1<br /><br />&nbsp; ndtset&nbsp; 21<br />! ndtset&nbsp; &nbsp;3<br />jdtset&nbsp; 11<br />&nbsp; &nbsp; &nbsp; &nbsp; 21&nbsp; &nbsp; &nbsp;22&nbsp; 23&nbsp; 24&nbsp; 25&nbsp; &nbsp; &nbsp;# The additional 8 values of the field have been suppressed to spare CPU time<br />&nbsp; &nbsp; &nbsp; &nbsp; 31&nbsp; &nbsp; &nbsp;32&nbsp; 33&nbsp; 34&nbsp; 35<br />&nbsp; &nbsp; &nbsp; &nbsp; 41&nbsp; &nbsp; &nbsp;42&nbsp; 43&nbsp; 44&nbsp; 45<br />&nbsp; &nbsp; &nbsp; &nbsp; 51&nbsp; &nbsp; &nbsp;51&nbsp; 53&nbsp; 54&nbsp; 55<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />berryopt11 -1&nbsp; &nbsp; &nbsp; &nbsp;rfdir11&nbsp; &nbsp; 1 1 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />berryopt21&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield21&nbsp; &nbsp;0.000002&nbsp; 0.000002&nbsp; 0.000002&nbsp; &nbsp; <br />berryopt22&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield22&nbsp; &nbsp;0.000004&nbsp; 0.000004&nbsp; 0.000004&nbsp; &nbsp; <br />berryopt23&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield23&nbsp; &nbsp;0.000006&nbsp; 0.000006&nbsp; 0.000006&nbsp; &nbsp; <br />berryopt24&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield24&nbsp; &nbsp;0.000008&nbsp; 0.000008&nbsp; 0.000008&nbsp; &nbsp; <br />berryopt25&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield25&nbsp; &nbsp;0.000010&nbsp; 0.000010&nbsp; 0.000010&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />berryopt31&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield31&nbsp; 0.000008 0.000008 0.000008&nbsp; &nbsp; <br />berryopt32&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield32&nbsp; 0.000006 0.000006 0.000006&nbsp; &nbsp; <br />berryopt33&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield33&nbsp; 0.000004 0.000004 0.000004&nbsp; &nbsp; <br />berryopt34&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield34&nbsp; 0.000002 0.000002 0.000002&nbsp; &nbsp; <br />berryopt35&nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp;efield35&nbsp; 0.000 0.000 0.000&nbsp; &nbsp; <br /><br /><br /><br /></code></pre></div><br /><br />P.S. Another question has been bothering me. When I do the structural optimization run, the energy converges to a very high value (about 50 Ha). My input file for optimization:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code><br />&nbsp; ndtset&nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp;# There are 2 datasets in this calculation<br /><br /># Set 1 : Internal coordinate optimization<br /><br />&nbsp; ionmov1&nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp;# Use BFGS algorithm for structural optimization<br />&nbsp; &nbsp;ntime1&nbsp; &nbsp;7&nbsp; &nbsp; &nbsp; &nbsp;# Maximum number of optimization steps<br />&nbsp; tolmxf1&nbsp; &nbsp;1.0e-5&nbsp; # Optimization is converged when maximum force <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # (Hartree/Bohr) is less than this maximum<br />&nbsp; natfix1&nbsp; &nbsp;3&nbsp; &nbsp; &nbsp; &nbsp;# Fix the position of two symmetry-equivalent atoms <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #&nbsp; in doing the structural optimization<br />&nbsp; iatfix1&nbsp; &nbsp;1 2 3&nbsp; &nbsp; &nbsp;# Choose atoms 1 and 2 as the fixed atoms (see discussion)<br />&nbsp; optcell1&nbsp; 0<br /><br /># Set 2 : Lattice parameter relaxation (including re-optimization of<br />#&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;internal coordinates)<br /><br />&nbsp;dilatmx2&nbsp; &nbsp;1.15&nbsp; &nbsp; # Maximum scaling allowed for lattice parameters<br />&nbsp;getxred2&nbsp; &nbsp;-1&nbsp; &nbsp; &nbsp; # Start with relaxed coordinates from dataset 1<br />&nbsp; getwfk2&nbsp; &nbsp;-1&nbsp; &nbsp; &nbsp; # Start with wave functions from dataset 1<br />&nbsp; ionmov2&nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp;# Use BFGS algorithm<br />&nbsp; &nbsp;ntime2&nbsp; &nbsp;10&nbsp; &nbsp; &nbsp; # Maximum number of optimization steps<br />&nbsp;optcell2&nbsp; &nbsp;3&nbsp; &nbsp; &nbsp; &nbsp;# Fully optimize unit cell geometry, keeping symmetry<br />&nbsp; tolmxf2&nbsp; &nbsp;1.0e-5&nbsp; # Convergence limit for forces as above<br />&nbsp;strfact2&nbsp; &nbsp;100&nbsp; &nbsp; &nbsp;# Test convergence of stresses (Hartree/bohr^3) by<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # multiplying by this factor and applying force<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # convergence test<br />&nbsp; natfix2&nbsp; &nbsp;3&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; iatfix2&nbsp; &nbsp;1 2 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /><br />#Common input data<br /><br />acell&nbsp; &nbsp;3.992&nbsp; 3.992&nbsp; 4.036&nbsp; angstrom&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#this is a guess, with the c/a<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #ratio based on ideal tetrahedral<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #bond angles<br /><br />&nbsp; rprim&nbsp; 1 0 0&nbsp; &nbsp;#&nbsp; primitive vectors must be<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 1 0&nbsp; &nbsp;#specified with high accuracy to be<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0 0 1&nbsp; &nbsp;#sure that the symmetry is recognized<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #and preserved in the optimization<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #process<br /><br />#Definition of the atom types and atoms<br />&nbsp;ntypat&nbsp; &nbsp;3<br />&nbsp; znucl&nbsp; &nbsp;56 22 08<br />&nbsp; natom&nbsp; &nbsp;5<br />&nbsp; typat&nbsp; &nbsp;1 2 3 3 3<br /><br />#Starting approximation for atomic positions in REDUCED coordinates<br />#based on ideal tetrahedral bond angles<br />&nbsp; &nbsp;xred&nbsp; &nbsp;0.0 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.5 0.5&nbsp; 0.5143<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.5 0.5 -0.03076<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.5 0.0&nbsp; 0.4814<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.0 0.5&nbsp; 0.4814 <br />#Gives the number of bands, explicitely (do not take the default)<br />&nbsp; nband&nbsp; &nbsp;15&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# For an insulator (if described correctly as an <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# insulator by DFT), conduction bands should not<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# be included in response-function calculations<br /><br />#Definition of the plane wave basis set<br />&nbsp; &nbsp;ecut&nbsp; &nbsp;50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximum kinetic energy cutoff (Hartree)<br />&nbsp;ecutsm&nbsp; &nbsp;0.5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Smoothing energy needed for lattice paramete<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# optimization.&nbsp; This will be retained for<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# consistency throughout.<br />ixc = 11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;!GGA, Perdew-Burke-Ernzerhof GGA functional<br />tphysel 300 K<br />#Definition of the k-point grid<br />&nbsp; ngkpt&nbsp; &nbsp;6 6 6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 6 6 6 grid<br />nshiftk&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Use one copy of grid only (default)<br />&nbsp;shiftk&nbsp; &nbsp;0.5 0.5 0.5&nbsp; &nbsp; # This choice of origin for the k point grid<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# preserves the hexagonal symmetry of the grid,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# which would be broken by the default choice.<br /><br />#Definition of the self-consistency procedure<br />&nbsp;diemac&nbsp; &nbsp;4000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Model dielectric preconditioner<br />&nbsp; &nbsp;iscf&nbsp; &nbsp;7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Pulay mixing of the potential<br />&nbsp; nstep&nbsp; &nbsp;40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Maxiumum number of SCF iterations<br />&nbsp;tolvrs&nbsp; &nbsp;1.0d-18&nbsp; &nbsp; &nbsp; &nbsp; # Strict tolerance on (squared) residual of the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# SCF potential needed for accurate forces and<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# stresses in the structural optimization, and<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# accurate wave functions in the RF calculations<br /><br /></code></pre></div><br /><br />The etotal and fcart are:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;etotal1&nbsp; -5.3094090418E+01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;etotal2&nbsp; -5.3094307091E+01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fcart1&nbsp; -0.0000000000E+00 -0.0000000000E+00 -6.9446291206E-03<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00 -2.4101663245E-02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 3.1042348651E-02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 1.9718573189E-06<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 1.9718573189E-06<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fcart2&nbsp; -0.0000000000E+00 -0.0000000000E+00 -6.7464332558E-03<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00 -1.9553866581E-02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 2.6297646773E-02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 1.3265321034E-06<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.0000000000E+00 -0.0000000000E+00&nbsp; 1.3265321034E-06<br /><br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Sep 19, 2011 12:27 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">It is possible to compute structural relaxation in the presence of a finite electric field. You can use ionmov 2 for example. I don't think you can use optcell different from zero though (that is, you can't allow the cell size to vary, only the ion positions).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Sep 19, 2011 2:34 pm</strong></div>
				<div class="author">by <strong>Anwar</strong></div>
				<div class="content">Thank you Professor. I shall append ionmov 2 to my input file. I hope allowing the structure to relax (by moving ions) will be reflected at the calculated wavefunction and subsequently, in the berry polarization.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Sep 19, 2011 2:40 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">I have successfully computed \epsilon_\infty (clamped ions) and \epsilon_0 (relaxed ions) using this method. Don't forget that with ionmov 2 you are doing a structural relaxation so you also have to set ntime, tolmxf, and ecutsm.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Sep 19, 2011 2:45 pm</strong></div>
				<div class="author">by <strong>Anwar</strong></div>
				<div class="content"><blockquote><div><cite>jzwanzig wrote:</cite>I have successfully computed \epsilon_\infty (clamped ions) and \epsilon_0 (relaxed ions) using this method. Don't forget that with ionmov 2 you are doing a structural relaxation so you also have to set ntime, tolmxf, and ecutsm.</div></blockquote><br /><br />Once again I'm at your debt. I'm actually trying to calculate the optical dielectric tensor (as a function of changing electric field) for ferroelectrics. I can breath easier knowing it is not impossible <img class="smilies" src="images/smilies/icon_e_smile.gif" alt=":)" title="Smile" /> . I'll add the appropriate commands to my input and let you know as soon as I get results. Since I'm not doing calculations in parallel, that may take a while.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Feb 26, 2018 2:09 pm</strong></div>
				<div class="author">by <strong>sevket simsek</strong></div>
				<div class="content">Dear Abinit user,<br /><br />Is there anyone who has calculated the hysteresis curve for a ferroelectric material?<br />I calculated, but I got a straight line, I could not get the hysteresis curve.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Feb 26, 2018 3:28 pm</strong></div>
				<div class="author">by <strong>ebousquet</strong></div>
				<div class="content">Dear Sevket,<br />What about Fig.5.c of:<br /><a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.84.115107" class="postlink">https://journals.aps.org/prb/abstract/10.1103/PhysRevB.84.115107</a><br />Done for PbTiO3?<br />Best wishes,<br />Eric</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Mon Feb 26, 2018 10:11 pm</strong></div>
				<div class="author">by <strong>sevket simsek</strong></div>
				<div class="content">Dear Eric,<br />Thank you very much for your reply before anything else.<br />I think you're talking about figure 5b.<br />I have calculated for tetragonal BaTiO3 and obtained a result as you indicated in Figure 5b.<br />but I want to get a curve like the one below.<br />if you share your advice and suggestion in this matter, I am delighted.<br />Best wishes</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Wed Feb 28, 2018 10:51 am</strong></div>
				<div class="author">by <strong>ebousquet</strong></div>
				<div class="content">Dear Sevket,<br />Humm, what you want is beyond static 0K DFT, the experimental hysteresis involves a much more complex dynamical process with domains, defects, leakage, etc, which give &quot;imperfect&quot; hysteresis (see for example the discussion in <a href="http://iopscience.iop.org/article/10.1088/0953-8984/20/02/021001/meta" class="postlink">http://iopscience.iop.org/article/10.1088/0953-8984/20/02/021001/meta</a> at the experimental side).<br />As it is now, you get somehow the &quot;hysteresis&quot; of a perfect monodomain crystal at 0K. Going a bit further requires to make an effective Hamiltonian or atomic potential model.<br />Best wishes,<br />Eric</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Finite electric field calculations without fixing ions</h3>
				<div class="date">Posted: <strong>Wed Feb 28, 2018 12:53 pm</strong></div>
				<div class="author">by <strong>sevket simsek</strong></div>
				<div class="content">Dear Eric,<br /><br />I thank you for useful discussions.<br /><br />Best wishes.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1324&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:55:22 GMT -->
</html>
