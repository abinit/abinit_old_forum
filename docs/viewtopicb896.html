<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1249&p=3920 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:34:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>error in tddft calculation - ABINIT Discussion Forums</title>


	<link rel="canonical" href="viewtopic3118.html?t=1249">

<!--
	phpBB style name: Flat Style
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      Ian Bradley
-->

<link href="assets/css/font-awesome.minaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/stylesheetaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/en/stylesheetaea1.css?assets_version=57" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/flat-style/theme/tweaks.css?assets_version=57" rel="stylesheet">
<![endif]-->

<meta name="google-site-verification" content="PLdTN48UENWHvJ5ViWhDTahZKzoMyw5e1QZgw1IECVw" />
<link rel="alternate" type="application/atom+xml" title="ATOM" href="app.php/smartfeed/feed.html" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="app.php/smartfeed/feed9830.html?y=2" />

<link href="ext/crizzo/aboutus/styles/prosilver/theme/aboutusaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/dmzx/topicageday/styles/prosilver/theme/topicagedayaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/clock/styles/all/theme/clockaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/googlesearch/styles/prosilver/theme/googlesearchaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/kinerity/bestanswer/styles/prosilver/theme/bestansweraea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbb/collapsiblecategories/styles/all/theme/collapsiblecategoriesaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbbservices/smartfeed/styles/prosilver/theme/customaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/senky/userstatistics/styles/prosilver/theme/userstatisticsaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/tierra/topicsolved/styles/prosilver/theme/buttonsaea1.css?assets_version=57" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description">
				<a id="logo" class="logo" href="index-2.html" title="Board index"><span class="site_logo"></span></a>
				<div  class="site-description">
					<h1>ABINIT Discussion Forums</h1>
					<p>The meeting place for ABINIT users and developers</p>
					<p class="skiplink"><a href="#start_here">Skip to content</a></p>
				</div>
			</div>

			</div>
					</div>
				<div class="navbar navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
										
										<li class="separator"></li>

									</ul>
			</div>
		</li>

			<li class="small-icon icon-smartfeed no-bulletin"><a href="app.php/smartfeed/ui.html">Smartfeed</a></li>		<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Main Site</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/packages" title="" role="menuitem" target="_blank">
				<i class="icon fa-download fa-fw" aria-hidden="true"></i><span>Download</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-book fa-fw" aria-hidden="true"></i><span>Documentations</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/tutorial/" title="" role="menuitem" target="_blank">
				<i class="icon fa-graduation-cap fa-fw" aria-hidden="true"></i><span>Tutorials</span>
				</a>
			</li>
							
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
						</ul>
    </div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">
	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
								<li class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
										<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope><a href="index-2.html" itemtype="https://schema.org/Thing" itemprop="item" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>
											<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="4"><a href="viewforum31e6.html?f=4" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Running Abinit</span></a><meta itemprop="position" content="2" /></span>
															<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="9"><a href="viewforumfdc5.html?f=9" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Ground state</span></a><meta itemprop="position" content="3" /></span>
												</li>
		<li class="rightside responsive-hide">
	<div id="show-clock">
		<div id="liveclock" class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
</li><!--[if !IE]><!-->
<li id="g-search-box" class="search-box rightside responsive-hide">
	<form action="https://forum.abinit.org/app.php/googlesearch">
	<fieldset>
		<input name="cx" type="hidden" value="017804512478788106347:tlftx8kncg4">
		<input name="q" type="search" maxlength="255" class="inputbox search tiny" value="" placeholder="Google Search ...">
		<button class="button button-search-google" type="submit" name="sitesearch" title="Google Search">
		<i class="icon fa-search fa-fw" aria-hidden="true"></i>
		</button>
	</fieldset>
</form>
</li>
<!--<![endif]-->

							<li id="search-box" class="rightside search-box responsive-hide" role="search">
				<form action="https://forum.abinit.org/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</li>

			<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
					</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		﻿
<h2 class="topic-title"><a href="viewtopic5156-2.html?f=9&amp;t=1249">error in tddft calculation</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Total energy, geometry optimization, DFT+U, spin....<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista146.html?mode=viewprofile&amp;u=2687" class="username">bguster</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting4f13.html?mode=reply&amp;f=9&amp;t=1249" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd6e0.html?f=9&amp;t=1249&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://forum.abinit.org/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1249" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p3913" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3913">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5bdf.html?author_id=709&amp;sr=posts">19</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri May 13, 2011 8:08 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3913">

						<h3 class="first"><a href="#p3913">error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting5d02.html?mode=quote&amp;f=9&amp;p=3913" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic9d3f-2.html?p=3913#p3913" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a></strong> &raquo; </span>Mon Aug 08, 2011 5:45 pm
			</p>
			
			
			
			<div class="content">Dear Abinit Users,<br />  <br />   According to the tddft tutorial I was able to run the test calculations, and by using the input information I did tried to calculate the excitation energies for my model system, which had metal atoms. In which I encountered problems. <br /><br />As in the example I used the input with slight changers, <span style="color: #FF8000">as my system is negativly charged (-1), and is a closed shell syste</span>m ;<br /><br /> ndtset    2<br /><br />#DATASET 1  SCF<br />   iscf1   5<br /> tolwfr1   1.0d-15<br /> nband1   5<br /> prtden1   1<br /> getwfk1   0<br /><br />#DATASET 2 TDDFT<br />   iscf2  -1<br /> tolwfr2   1.0d-9<br />  nband2   12<br /> getden2   1<br /> getwfk2   1<br /><br />#Common<br />acell 30  30  30  angstroms <br /> boxcenter 3*0.0d0<br /> diemac 1.0d0   diemix 0.5d0<br /> ecut 25<br /> ixc  7<br /><br />kptopt 0          # Enter the k points manually <br /><br />charge -1<br /><br /> natom  61<br /> nbdbuf 0<br /><br /> nstep 500<br /> ntypat  3<br /><br />---------------------<br />When trying to run the above I encounted the error:<br /> distrb2: WARNING -<br />  nproc_kpt=   6 &gt;= nkpt=   1* nsppol=   1<br />  The number of processors is larger than nkpt. This is a waste.<br /> invars1: mkmem  undefined in the input file. Use default mkmem  = nkpt<br /> invars1: With nkpt_me=    1 and mkmem  =     1, ground state wf handled in core.<br /><br /> invars1 : WARNING -<br />   your number of k-points (     1) will not distribute correctly:<br />   with the current number of processors (     6).<br />   you will leave some empty and this is forbidden.<br /><br /> ACTION: you can reduce number of processors to      1<br />   without losing speed<br /> invars1: mkqmem undefined in the input file. Use default mkqmem = nkpt<br /> invars1: With nkpt_me=    1 and mkqmem =     1, ground state wf handled in core.<br /><br /> invars1 : WARNING -<br />   your number of k-points (     1) will not distribute correctly:<br />   with the current number of processors (     6).<br />   you will leave some empty and this is forbidden.<br /><br /> ACTION: you can reduce number of processors to      1<br />   without losing speed<br /> invars1: mk1mem undefined in the input file. Use default mk1mem = nkpt<br /> invars1: With nkpt_me=    1 and mk1mem =     1, ground state wf handled in core.<br /><br /> invars1 : WARNING -<br />   your number of k-points (     1) will not distribute correctly:<br />   with the current number of processors (     6).<br />   you will leave some empty and this is forbidden.<br /><br /> ACTION: you can reduce number of processors to      1<br />   without losing speed<br /><br /> DATASET    1 : space group P-1 (#  2); Bravais aP (primitive triclinic)<br /> inkpts: Sum of    1 k point weights is    1.000000<br /><br /> chkneu : ERROR -<br />  Initialization of occ, with occopt=   1<br />  <strong class="text-strong"><span style="color: #FF0000">There are not enough bands to get charge balance right</span></strong><br /> Action : modify input file ... <br />  (check the pseudopotential charges, the variable charge,<br />  and the declared number of bands, nband)<br />-P-0000<br />-P-0000  leave_new : decision taken to exit ...<br /><br /><br />----<br /><br />the error talks about that &quot;There are not enough bands to get charge balance right&quot;   -- how can I select the correct number of bands?<br />As the system has  gold atoms,  S , and  H atoms .. <br />  Do I need to calculate the number of electrons and divide it by 2 to get the number of bands to be used? <br /><br />But when I commented out the  nband1   5 in the above input file the calculation started runing.. but I do not know whether it will run properly or not.. <br />Bellow is the changed input file; when I specified it to run on 6 procs it started runing...<br /><br /> ndtset    2<br /><br />#DATASET 1  SCF<br />   iscf1   5<br /> tolwfr1   1.0d-15<br /><span style="color: #FF0000">#  nband1   5</span><br /> prtden1   1<br /> getwfk1   0<br /><br />#DATASET 2 TDDFT<br />   iscf2  -1<br /> tolwfr2   1.0d-9<br /><span style="color: #FF0000">#  nband2   12</span><br /> getden2   1<br /> getwfk2   1<br /><br />#Common<br /># acell 6  2*5 Angstrom<br />acell 30  30  30  angstroms <br /> boxcenter 3*0.0d0<br /> diemac 1.0d0   diemix 0.5d0<br /> ecut 25<br /> ixc  7<br /><br />kptopt 0          # Enter the k points manually <br /><br />charge -1<br /><br /> natom  61<br /> nbdbuf 0<br /><br /> nstep 500<br /><br /><br />I would really appreciate if you can shed some light for my problem. Thank you very much</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p3919" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3919">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistd179.html?mode=viewprofile&amp;u=59" class="username">david.waroquiers</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search4b32.html?author_id=59&amp;sr=posts">138</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Aug 15, 2009 12:45 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3919">

						<h3 ><a href="#p3919">Re: error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2b3b.html?mode=quote&amp;f=9&amp;p=3919" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicf895.html?p=3919#p3919" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistd179.html?mode=viewprofile&amp;u=59" class="username">david.waroquiers</a></strong> &raquo; </span>Wed Aug 10, 2011 11:35 am
			</p>
			
			
			
			<div class="content">Hello,<br /><br />If you do not set nband, abinit will do it for you (doing exactly what you suggest and adding a few more).<br />In practice, for a metallic system, you should allways check that you have enough bands (the &quot;mandatory&quot; ones, given by the number of electrons in the system divided by 2 if your system is unpolarized, plus a few more, so that the occupation of the very last band is 0.000 for every k-point). For a metallic occupation (occopt &gt;= 3), the number of bands might change depending on the smearing factor you use for the occupation (tsmear) : if you increase tsmear, you might need to increase the number of bands (when you increase tsmear, you put more electrons to higher energy levels). Note that if you do not set it by yourself, the number of bands might not be enough (even if the calculation will continue), you have to check !<br /><br />I hope it answers your question.<br /><br />David</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p3920" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3920">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5bdf.html?author_id=709&amp;sr=posts">19</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri May 13, 2011 8:08 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3920">

						<h3 ><a href="#p3920">Re: error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting95f7.html?mode=quote&amp;f=9&amp;p=3920" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic13c7.html?p=3920#p3920" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a></strong> &raquo; </span>Wed Aug 10, 2011 2:58 pm
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>david.waroquiers wrote:</cite>David</div></blockquote><br /><br />Thank you very much David.</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p3921" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3921">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5bdf.html?author_id=709&amp;sr=posts">19</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri May 13, 2011 8:08 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3921">

						<h3 ><a href="#p3921">Re: error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting3a8d.html?mode=quote&amp;f=9&amp;p=3921" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicd35f.html?p=3921#p3921" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a></strong> &raquo; </span>Wed Aug 10, 2011 3:03 pm
			</p>
			
			
			
			<div class="content">I was running my calculation on 6 procs , <br /><br />when it ran it gave me an error in the previous, saying <br /><span style="color: #FF0040">distrb2: WARNING -<br />nproc_kpt= 6 &gt;= nkpt= 1* nsppol= 1<br />The number of processors is larger than nkpt. This is a waste.<br />invars1: mkmem undefined in the input file. Use default mkmem = nkpt<br />invars1: With nkpt_me= 1 and mkmem = 1, ground state wf handled in core</span><br /><br />As I am specifying my system as a molecule (which is one k point)<br /><br />Can't I run the calculation in parallel ?  will it run the same if i run it on serial as in parallel?  <br /><br />Thank you very much for the help given.</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p3924" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3924">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistd179.html?mode=viewprofile&amp;u=59" class="username">david.waroquiers</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search4b32.html?author_id=59&amp;sr=posts">138</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Aug 15, 2009 12:45 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3924">

						<h3 ><a href="#p3924">Re: error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7ae1.html?mode=quote&amp;f=9&amp;p=3924" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic366f-2.html?p=3924#p3924" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistd179.html?mode=viewprofile&amp;u=59" class="username">david.waroquiers</a></strong> &raquo; </span>Thu Aug 11, 2011 11:33 am
			</p>
			
			
			
			<div class="content">Hello,<br /><br />Yes, if you run it like that, it will run the same in sequential as in parallel because the default parallelization is over k-points. If you want to parallelize over bands and fft, you have to use the paral_kgb variable and the other related variables (npband .... etc) :<br /><a href="http://www.abinit.org/documentation/helpfiles/for-v6.8/input_variables/varpar.html#paral_kgb" class="postlink">http://www.abinit.org/documentation/helpfiles/for-v6.8/input_variables/varpar.html#paral_kgb</a><br /><br />Note that this parallelization is efficient only if your processors can communicate fast. For example, if the ethernet between nodes is slow and if you have 8 cores in one node, you should run with 8 processors maximum.<br /><br />David</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p3931" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile3931">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search5bdf.html?author_id=709&amp;sr=posts">19</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri May 13, 2011 8:08 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content3931">

						<h3 ><a href="#p3931">Re: error in tddft calculation</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingdea4-2.html?mode=quote&amp;f=9&amp;p=3931" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic1141-2.html?p=3931#p3931" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist5653.html?mode=viewprofile&amp;u=709" class="username">golden</a></strong> &raquo; </span>Fri Aug 12, 2011 9:06 pm
			</p>
			
			
			
			<div class="content">Hi, <br /><br />when I commented out nband1 nband2 in the input file calculation finished with giving the lowest 20 excitation energies.<br /><br />But When I used <br /><br /> ndtset    2<br /><br />#DATASET 1  SCF<br />#   iscf1   5<br /> iscf1     7<br /> tolwfr1   1.0d-12<br /><span style="color: #FF0000">  nband1   201</span><br /> prtden1   1<br /> getwfk1   0<br /><br />#DATASET 2 TDDFT<br />   iscf2  -1<br /> tolwfr2   1.0d-9<br /><span style="color: #FF0040">  nband2   402</span><br /> getden2   1<br /> getwfk2   1<br /><br /><br />after finishing dataset1 halfway through the calculation it stoped with giving an error;<br /><br /><blockquote class="uncited"><div> ==== FFT mesh ====<br />  FFT mesh divisions ........................   144  144  144<br />  Augmented FFT divisions ...................   145  145  144<br />  FFT algorithm .............................   102<br />  FFT cache size ............................    16<br /> getmpw: optimal value of mpw= 1320073<br /><br /> getcut: wavevector=  0.0000  0.0000  0.0000  ngfft= 144 144 144<br />         ecut(hartree)=     25.000   =&gt; boxcut(ratio)=   2.11597<br />  scfcv : before setvtr, energies%e_hartree=   0.0000000000000000     <br /><br /> ewald : nr and ng are    3 and   15<br />  mklocl_recipspace : will add potential with strength vprtrb(:)=   0.0000000000000000        0.0000000000000000     <br />  setvtr : istep,n1xccc,moved_rhor=           1        2501           0<br />  scfcv : after setvtr, energies%e_hartree=   0.0000000000000000     <br /> vtorho : nnsclo_now=500, note that nnsclo,dbl_nnsclo,istep=  0 0  1<br />[gold:19138] *** Process received signal ***<br />[gold:19138] Signal: Segmentation fault (11)<br />[gold:19138] Signal code: Address not mapped (1)<br />[gold:19138] Failing at address: 0x24a5fa1f8<br />[gold:19138] [ 0] /lib64/libpthread.so.0(+0xf2e0) [0x2b34d3e1d2e0]<br />[gold:19138] [ 1] /usr/lib64/mpi/gcc/openmpi/lib64/libopen-pal.so.0(_int_malloc+0x811) [0x2b34d3061021]<br />[gold:19138] [ 2] /usr/lib64/mpi/gcc/openmpi/lib64/libopen-pal.so.0(malloc+0x95) [0x2b34d3062395]<br />[gold:19138] [ 3] abinit(tddft_+0x3e1e) [0x593e3e]<br />[gold:19138] [ 4] abinit(vtorho_+0xab31) [0x5438d1]<br />[gold:19138] [ 5] abinit(scfcv_+0x335c) [0x513b5c]<br />[gold:19138] [ 6] abinit(scfcv_new_+0x5e7) [0x505217]<br />[gold:19138] [ 7] abinit(gstate_+0xa6a3) [0x4b4e63]<br />[gold:19138] [ 8] abinit(gstateimg_+0x1419) [0x45ffb9]<br />[gold:19138] [ 9] abinit(driver_+0x45b2) [0x457102]<br />[gold:19138] [10] abinit() [0x450df0]<br />[gold:19138] [11] abinit(main+0x1f) [0x452b3f]<br />[gold:19138] [12] /lib64/libc.so.6(__libc_start_main+0xfd) [0x2b34d425fb7d]<br />[gold:19138] [13] abinit() [0x44f1b9]<br />[gold:19138] *** End of error message ***<br /></div></blockquote><br /><br />Is the error something to do with the memory? <br />I ran the above using single proc. <br /><br />Q2; Is there any way to increase the printed excitation transitions from 20 to 100 ? (the program as a default prints out 20 lowest transitions)<br /><br />Thank you very much</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting4f13.html?mode=reply&amp;f=9&amp;t=1249" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopicd6e0.html?f=9&amp;t=1249&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://forum.abinit.org/viewtopic.php?f=9&amp;t=1249">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforumfdc5.html?f=9" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Ground state”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforumffeb.html?f=20" class="jumpbox-forum-link"> <span> News &amp; Announcements</span></a></li>
																<li><a href="viewforum8011.html?f=23" class="jumpbox-forum-link"> <span> Jobs and Other Announcements</span></a></li>
																<li><a href="viewforum58da.html?f=1" class="jumpbox-cat-link"> <span> Building ABINIT</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Configuring and compiling ABINIT</span></a></li>
																<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> Running Abinit</span></a></li>
																<li><a href="viewforumfdc5.html?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Ground state</span></a></li>
																<li><a href="viewforum15ca.html?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Response calculations</span></a></li>
																<li><a href="viewforum8a83.html?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Many-body perturbation theory</span></a></li>
																<li><a href="viewforum01c9.html?f=12" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Other tools and postprocessing in ABINIT</span></a></li>
																<li><a href="viewforum345c.html?f=24" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Python interfacing : Abipy ecosystem</span></a></li>
																<li><a href="viewforum9780.html?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Link to other codes</span></a></li>
																<li><a href="viewforume774.html?f=5" class="jumpbox-cat-link"> <span> Developing Abinit</span></a></li>
																<li><a href="viewforum218b.html?f=19" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Improving ABINIT</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar navbar-bottom" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
				
		<li class="rightside" data-last-responsive="true"><a href="app.php/aboutus.html" role="menuitem"><i class="icon fa-info-circle fa-fw" aria-hidden="true"></i><span>About us</span></a></li>			</ul>

	</div>
</div>

	<div class="copyright">
		<script type="text/javascript">
copyright=new Date();

update=copyright.getFullYear();

document.write("Copyright\u0020\u0026copy\u003B 2009 - "+ update +	" ABINIT Discussion Forums All\u0020rights\u0020reserved.");

</script>
<br /><br />		<p class="footer-row">
			<span class="footer-copyright">Flat Style by <a href="http://phpbbstyles.oo.gd/">Ian Bradley</a></span>
		</p>
        <p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row">
			<a class="footer-link" href="ucp4d86.html?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="ucp226b.html?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="assets/javascript/jquery.minaea1.js?assets_version=57"></script>
<script src="assets/javascript/coreaea1.js?assets_version=57"></script>



<script>
	(function() {
		var cx = '017804512478788106347\u003Atlftx8kncg4';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//cse.google.com/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	})();
</script>
<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="ext/hifikabin/clock/styles/all/template/js/js_clockaea1.js?assets_version=57"></script>
<script src="ext/phpbb/collapsiblecategories/styles/all/template/js/collapsiblecategoriesaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/forum_fnaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/ajaxaea1.js?assets_version=57"></script>



</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1249&p=3920 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:34:18 GMT -->
</html>
