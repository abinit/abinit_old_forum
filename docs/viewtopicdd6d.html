<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=12&t=4315&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 16:50:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; wavefunctions from _WFK file</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>wavefunctions from _WFK file</h2>
		<p><a href="viewtopicfbb4.html?f=12&amp;t=4315">https://forum.abinit.org/viewtopic.php?f=12&amp;t=4315</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>wavefunctions from _WFK file</h3>
				<div class="date">Posted: <strong>Mon Feb 03, 2020 3:32 am</strong></div>
				<div class="author">by <strong>wenfei</strong></div>
				<div class="content">Hi,<br>
<br>
I ran two test calculations on Be and Ne atoms, respectively, and used cut3d to export wavefunctions from the respective _WFK files into Gaussian Cube files.<br>
What I found was that the files only contain the absolute values of wavefunctions, but not the sign. When I visualize the 2p orbital of Ne with Vesta, both lobes are positive. I also plotted the wavefunction of Be 2s orbital against the distance to the atom, and instead of a node where the radial part cross the axis, I got a kink.<br>
The two pictures are:<br>
<a href="https://drive.google.com/file/d/14ghR_kHIXt87AqW02Wu21IqNAt-LCLCY/view?usp=sharing" class="postlink">https://drive.google.com/file/d/14ghR_k ... sp=sharing</a><br>
<a href="https://drive.google.com/file/d/1eZUOb9zbDoVygbkC7H5Ypk3ZUgb7ox60/view?usp=sharing" class="postlink">https://drive.google.com/file/d/1eZUOb9 ... sp=sharing</a><br>
<br>
Below I attach the output I got with cut3d for Be atom:<br>
<br>
.Version 8.10.2 of CUT3D <br>
.(sequential version, prepared for a x86_64_linux_gnu4.9 computer) <br>
<br>
.Copyright (C) 1998-2018 ABINIT group . <br>
 CUT3D comes with ABSOLUTELY NO WARRANTY.<br>
 It is free software, and you are welcome to redistribute it<br>
 under certain conditions (GNU General Public License,<br>
 see ~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt" class="postlink">http://www.gnu.org/copyleft/gpl.txt</a>).<br>
<br>
 ABINIT is a project of the Universite Catholique de Louvain,<br>
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .<br>
 Please read <a href="https://docs.abinit.org/theory/acknowledgments" class="postlink">https://docs.abinit.org/theory/acknowledgments</a> for suggested<br>
 acknowledgments of the ABINIT effort.<br>
 For more information, see <a href="https://www.abinit.org/" class="postlink">https://www.abinit.org</a> .<br>
<br>
.Starting date : Sun  2 Feb 2020.<br>
- ( at 20h21 )<br>
  <br>
<br>
  What is the name of the 3D function (density, potential or wavef) file ?<br>
  =&gt; Your 3D function file is: tpaw1_1o_WFK<br>
<br>
- Your file contains unformatted binary header + 3D data<br>
<br>
 ===============================================================================<br>
 ECHO of the ABINIT file header <br>
 <br>
 First record :<br>
.codvsn,headform,fform = 8.10.2   80    2<br>
 <br>
 Second record :<br>
 bantot,intxc,ixc,natom  =     4     0     9     1<br>
 ngfft(1:3),nkpt         =    48    48    48     1<br>
 nspden,nspinor          =     1     1<br>
 nsppol,nsym,npsp,ntypat =     1    48     1     1<br>
 occopt,pertcase,usepaw  =     1     0     1<br>
 ecut,ecutdg,ecutsm      =  4.0000000000E+01  4.0000000000E+01  5.0000000000E-01<br>
 ecut_eff                =  4.0000000000E+01<br>
 qptn(1:3)               =  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br>
 rprimd(1:3,1)           =  8.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br>
 rprimd(1:3,2)           =  0.0000000000E+00  8.0000000000E+00  0.0000000000E+00<br>
 rprimd(1:3,3)           =  0.0000000000E+00  0.0000000000E+00  8.0000000000E+00<br>
 stmbias,tphysel,tsmear  =  0.0000000000E+00  0.0000000000E+00  1.0000000000E-02<br>
<br>
 Third record :<br>
 istwfk=   2<br>
 nband =   4<br>
 npwarr= 3094<br>
 so_psp=   1<br>
 symafm=<br>
          1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1<br>
          1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1<br>
 symrel=<br>
           1   0   0   0   1   0   0   0   1    -1   0   0   0  -1   0   0   0  -1<br>
          -1   0   0   0   1   0   0   0  -1     1   0   0   0  -1   0   0   0   1<br>
          -1   0   0   0  -1   0   0   0   1     1   0   0   0   1   0   0   0  -1<br>
           1   0   0   0  -1   0   0   0  -1    -1   0   0   0   1   0   0   0   1<br>
           0   1   0   1   0   0   0   0   1     0  -1   0  -1   0   0   0   0  -1<br>
           0  -1   0   1   0   0   0   0  -1     0   1   0  -1   0   0   0   0   1<br>
           0  -1   0  -1   0   0   0   0   1     0   1   0   1   0   0   0   0  -1<br>
           0   1   0  -1   0   0   0   0  -1     0  -1   0   1   0   0   0   0   1<br>
           0   0   1   1   0   0   0   1   0     0   0  -1  -1   0   0   0  -1   0<br>
           0   0  -1   1   0   0   0  -1   0     0   0   1  -1   0   0   0   1   0<br>
           0   0  -1  -1   0   0   0   1   0     0   0   1   1   0   0   0  -1   0<br>
           0   0   1  -1   0   0   0  -1   0     0   0  -1   1   0   0   0   1   0<br>
           1   0   0   0   0   1   0   1   0    -1   0   0   0   0  -1   0  -1   0<br>
          -1   0   0   0   0   1   0  -1   0     1   0   0   0   0  -1   0   1   0<br>
          -1   0   0   0   0  -1   0   1   0     1   0   0   0   0   1   0  -1   0<br>
           1   0   0   0   0  -1   0  -1   0    -1   0   0   0   0   1   0   1   0<br>
           0   1   0   0   0   1   1   0   0     0  -1   0   0   0  -1  -1   0   0<br>
           0  -1   0   0   0   1  -1   0   0     0   1   0   0   0  -1   1   0   0<br>
           0  -1   0   0   0  -1   1   0   0     0   1   0   0   0   1  -1   0   0<br>
           0   1   0   0   0  -1  -1   0   0     0  -1   0   0   0   1   1   0   0<br>
           0   0   1   0   1   0   1   0   0     0   0  -1   0  -1   0  -1   0   0<br>
           0   0  -1   0   1   0  -1   0   0     0   0   1   0  -1   0   1   0   0<br>
           0   0  -1   0  -1   0   1   0   0     0   0   1   0   1   0  -1   0   0<br>
           0   0   1   0  -1   0  -1   0   0     0   0  -1   0   1   0   1   0   0<br>
 type  =   1<br>
 kptns =                 (max 50 k-points will be written)<br>
            0.000000E+00    0.000000E+00    0.000000E+00<br>
 wtk =<br>
          1.00<br>
   occ =<br>
          2.00  2.00  0.00  0.00<br>
 tnons =<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
          0.000000  0.000000  0.000000   -0.025000 -0.025000 -0.025000<br>
         -0.025000  0.000000 -0.025000    0.000000 -0.025000  0.000000<br>
          0.000000 -0.025000 -0.025000   -0.025000  0.000000  0.000000<br>
         -0.025000 -0.025000  0.000000    0.000000  0.000000 -0.025000<br>
  znucl=  4.00<br>
<br>
 Pseudopotential info :<br>
 title=Be<br>
  znuclpsp=  4.00, zionpsp=  4.00, pspso=  0, pspdat=******, pspcod= 17, pspxc=  7<br>
  lmn_size=  8<br>
 <br>
 Last record :<br>
 residm,etot,fermie=    9.278309E-14   -1.461514959254E+01   -2.270450E-01<br>
 xred =<br>
            4.875000E-01    4.875000E-01    4.875000E-01<br>
 rhoij(   1,1)=  (max 12 non-zero components will be written)<br>
   1.99898  -0.01214   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
  -0.01214   1.57156   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000<br>
 End the ECHO of the ABINIT file header <br>
 ===============================================================================<br>
<br>
 ===========================================================<br>
<br>
 ECHO important input variables ...<br>
<br>
  Dimensional primitive vectors (ABINIT equivalent: rprimd):<br>
    8.000000E+00    0.000000E+00    0.000000E+00<br>
    0.000000E+00    8.000000E+00    0.000000E+00<br>
    0.000000E+00    0.000000E+00    8.000000E+00<br>
  Grid density (ABINIT equivalent: ngfft):    48   48   48<br>
  Number of atoms       :           1<br>
  Number of atomic types:           1<br>
<br>
   #    Atomic positions (cartesian coordinates - Bohr)<br>
   1    3.900000E+00    3.900000E+00    3.900000E+00<br>
<br>
  This file is a WF file. <br>
  =&gt; Your k-point is :            1<br>
<br>
<br>
 For which band ? (1 to     4)<br>
  =&gt; Your band number is :            1<br>
<br>
  =&gt; Your spin polarisation number is :            1<br>
<br>
 Do you want to analyze a GW wavefunction? (1=yes,0=no)<br>
 =&gt; Your choice is :           0<br>
<br>
 Do you want the atomic analysis for this state : <br>
 (kpt,band)= (    1    1)? <br>
 If yes, enter the radius of the atomic spheres, in bohr <br>
 If no, enter 0 <br>
 You entered ratsph=      0.00000000 Bohr <br>
<br>
  3D wave function was read. Ready for further treatment.<br>
<br>
 ===========================================================<br>
<br>
  What is your choice ? Type:<br>
   0 =&gt; exit to k-point / band / spin-pol loop<br>
   1 =&gt; 3D formatted real and imaginary data<br>
        (output the bare 3D data - two column,R,I)<br>
   2 =&gt; 3D formatted real data<br>
        (output the bare 3D data - one column)<br>
   3 =&gt; 3D formatted imaginary data<br>
        (output the bare 3D data - one column)<br>
   4 =&gt; 3D indexed real and imaginary data<br>
        (3D data, preceeded by 3D index)<br>
   5 =&gt; 3D indexed real data<br>
        (bare 3D data, preceeded by 3D index)<br>
   6 =&gt; 3D indexed imaginary data<br>
        (bare 3D data, preceeded by 3D index)<br>
   7 =&gt; 3D Data Explorer formatted data <br>
        (Real file and Imaginary file)<br>
   8 =&gt; 3D Data Explorer formatted data <br>
        (Only the Real file)<br>
   9 =&gt; 3D Data Explorer formatted data <br>
        (Only the Imaginary file)<br>
  10 =&gt; 3D Data Explorer formatted data and position files<br>
  11 =&gt; XCrysden formatted data (norm of wf) and position files<br>
  12 =&gt; NetCDF data and position file<br>
  13 =&gt; XCrysden/VENUS wavefunction (real part of data)<br>
  14 =&gt; Gaussian/cube wavefunction module<br>
<br>
 Your choice is 14<br>
<br>
 <br>
  Enter the root of an output file:<br>
   The root of your file is : orb<br>
   The corresponding filename is : orb_k1_b1<br>
<br>
 Output a cube file of 3D volumetric data<br>
<br>
  Task           14  has been done !<br>
<br>
  Run interpolation again? (1=default=yes,0=no)<br>
  =&gt; Your k-point is :            1<br>
<br>
<br>
 For which band ? (1 to     4)<br>
  =&gt; Your band number is :            2<br>
<br>
  =&gt; Your spin polarisation number is :            1<br>
<br>
 Do you want to analyze a GW wavefunction? (1=yes,0=no)<br>
 =&gt; Your choice is :           0<br>
<br>
 Do you want the atomic analysis for this state : <br>
 (kpt,band)= (    1    2)? <br>
 If yes, enter the radius of the atomic spheres, in bohr <br>
 If no, enter 0 <br>
 You entered ratsph=      0.00000000 Bohr <br>
<br>
  3D wave function was read. Ready for further treatment.<br>
<br>
 ===========================================================<br>
<br>
  What is your choice ? Type:<br>
   0 =&gt; exit to k-point / band / spin-pol loop<br>
   1 =&gt; 3D formatted real and imaginary data<br>
        (output the bare 3D data - two column,R,I)<br>
   2 =&gt; 3D formatted real data<br>
        (output the bare 3D data - one column)<br>
   3 =&gt; 3D formatted imaginary data<br>
        (output the bare 3D data - one column)<br>
   4 =&gt; 3D indexed real and imaginary data<br>
        (3D data, preceeded by 3D index)<br>
   5 =&gt; 3D indexed real data<br>
        (bare 3D data, preceeded by 3D index)<br>
   6 =&gt; 3D indexed imaginary data<br>
        (bare 3D data, preceeded by 3D index)<br>
   7 =&gt; 3D Data Explorer formatted data <br>
        (Real file and Imaginary file)<br>
   8 =&gt; 3D Data Explorer formatted data <br>
        (Only the Real file)<br>
   9 =&gt; 3D Data Explorer formatted data <br>
        (Only the Imaginary file)<br>
  10 =&gt; 3D Data Explorer formatted data and position files<br>
  11 =&gt; XCrysden formatted data (norm of wf) and position files<br>
  12 =&gt; NetCDF data and position file<br>
  13 =&gt; XCrysden/VENUS wavefunction (real part of data)<br>
  14 =&gt; Gaussian/cube wavefunction module<br>
<br>
 Your choice is 14<br>
<br>
 <br>
  Enter the root of an output file:<br>
   The root of your file is : orb<br>
   The corresponding filename is : orb_k1_b2<br>
<br>
 Output a cube file of 3D volumetric data<br>
<br>
  Task           14  has been done !<br>
<br>
  Run interpolation again? (1=default=yes,0=no)<br>
  =&gt; Your k-point is :            1<br>
<br>
<br>
 For which band ? (1 to     4)<br>
  =&gt; Your band number is :            3<br>
<br>
  =&gt; Your spin polarisation number is :            1<br>
<br>
 Do you want to analyze a GW wavefunction? (1=yes,0=no)<br>
 =&gt; Your choice is :           0<br>
<br>
 Do you want the atomic analysis for this state : <br>
 (kpt,band)= (    1    3)? <br>
 If yes, enter the radius of the atomic spheres, in bohr <br>
 If no, enter 0 <br>
 You entered ratsph=      0.00000000 Bohr <br>
<br>
  3D wave function was read. Ready for further treatment.<br>
<br>
 ===========================================================<br>
<br>
  What is your choice ? Type:<br>
   0 =&gt; exit to k-point / band / spin-pol loop<br>
   1 =&gt; 3D formatted real and imaginary data<br>
        (output the bare 3D data - two column,R,I)<br>
   2 =&gt; 3D formatted real data<br>
        (output the bare 3D data - one column)<br>
   3 =&gt; 3D formatted imaginary data<br>
        (output the bare 3D data - one column)<br>
   4 =&gt; 3D indexed real and imaginary data<br>
        (3D data, preceeded by 3D index)<br>
   5 =&gt; 3D indexed real data<br>
        (bare 3D data, preceeded by 3D index)<br>
   6 =&gt; 3D indexed imaginary data<br>
        (bare 3D data, preceeded by 3D index)<br>
   7 =&gt; 3D Data Explorer formatted data <br>
        (Real file and Imaginary file)<br>
   8 =&gt; 3D Data Explorer formatted data <br>
        (Only the Real file)<br>
   9 =&gt; 3D Data Explorer formatted data <br>
        (Only the Imaginary file)<br>
  10 =&gt; 3D Data Explorer formatted data and position files<br>
  11 =&gt; XCrysden formatted data (norm of wf) and position files<br>
  12 =&gt; NetCDF data and position file<br>
  13 =&gt; XCrysden/VENUS wavefunction (real part of data)<br>
  14 =&gt; Gaussian/cube wavefunction module<br>
<br>
 Your choice is 14<br>
<br>
 <br>
  Enter the root of an output file:<br>
   The root of your file is : orb<br>
   The corresponding filename is : orb_k1_b3<br>
<br>
 Output a cube file of 3D volumetric data<br>
<br>
  Task           14  has been done !<br>
<br>
  Run interpolation again? (1=default=yes,0=no)<br>
  =&gt; Your k-point is :            1<br>
<br>
<br>
 For which band ? (1 to     4)<br>
  =&gt; Your band number is :            4<br>
<br>
  =&gt; Your spin polarisation number is :            1<br>
<br>
 Do you want to analyze a GW wavefunction? (1=yes,0=no)<br>
 =&gt; Your choice is :           0<br>
<br>
 Do you want the atomic analysis for this state : <br>
 (kpt,band)= (    1    4)? <br>
 If yes, enter the radius of the atomic spheres, in bohr <br>
 If no, enter 0 <br>
 You entered ratsph=      0.00000000 Bohr <br>
<br>
  3D wave function was read. Ready for further treatment.<br>
<br>
 ===========================================================<br>
<br>
  What is your choice ? Type:<br>
   0 =&gt; exit to k-point / band / spin-pol loop<br>
   1 =&gt; 3D formatted real and imaginary data<br>
        (output the bare 3D data - two column,R,I)<br>
   2 =&gt; 3D formatted real data<br>
        (output the bare 3D data - one column)<br>
   3 =&gt; 3D formatted imaginary data<br>
        (output the bare 3D data - one column)<br>
   4 =&gt; 3D indexed real and imaginary data<br>
        (3D data, preceeded by 3D index)<br>
   5 =&gt; 3D indexed real data<br>
        (bare 3D data, preceeded by 3D index)<br>
   6 =&gt; 3D indexed imaginary data<br>
        (bare 3D data, preceeded by 3D index)<br>
   7 =&gt; 3D Data Explorer formatted data <br>
        (Real file and Imaginary file)<br>
   8 =&gt; 3D Data Explorer formatted data <br>
        (Only the Real file)<br>
   9 =&gt; 3D Data Explorer formatted data <br>
        (Only the Imaginary file)<br>
  10 =&gt; 3D Data Explorer formatted data and position files<br>
  11 =&gt; XCrysden formatted data (norm of wf) and position files<br>
  12 =&gt; NetCDF data and position file<br>
  13 =&gt; XCrysden/VENUS wavefunction (real part of data)<br>
  14 =&gt; Gaussian/cube wavefunction module<br>
<br>
 Your choice is 14<br>
<br>
 <br>
  Enter the root of an output file:<br>
   The root of your file is : orb<br>
   The corresponding filename is : orb_k1_b4<br>
<br>
 Output a cube file of 3D volumetric data<br>
<br>
  Task           14  has been done !<br>
<br>
  Run interpolation again? (1=default=yes,0=no)<br>
-<br>
- Proc.   0 individual time (sec): cpu=          0.8  wall=          0.8<br>
<br>
  Thank you for using me<br>
<br>
Best,<br>
Wenfei</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=12&t=4315&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 16:50:55 GMT -->
</html>
