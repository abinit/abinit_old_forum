<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=2765&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:34:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Erroneous phonon band structure of SrTiO3 using PAWs</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Erroneous phonon band structure of SrTiO3 using PAWs</h2>
		<p><a href="viewtopic5c33.html?f=10&amp;t=2765">https://forum.abinit.org/viewtopic.php?f=10&amp;t=2765</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Erroneous phonon band structure of SrTiO3 using PAWs</h3>
				<div class="date">Posted: <strong>Tue Aug 19, 2014 3:10 pm</strong></div>
				<div class="author">by <strong>JBekaert</strong></div>
				<div class="content">Hi,<br /><br />I am attempting to calculate the phonon band structure of cubic SrTiO<span style="font-size: 85%; line-height: 116%;">3</span> with DFPT. Using the PAW potentials generated by AtomPAW2Abinit and the Perdew-Wang functional I obtain the erroneous result show in the attached figure     phonon_band_structure_PAW.png. Although I have carried out the correction for the TO-LO splitting, the dispersion is still not smooth at Gamma. Moreover, the phonon band structure calculated using the PAW potentials do not show the negative frequencies in the Gamma and M points due to the cubic phase not being the ground state, for instance reported in <em class="text-italics">Ph. Ghosez et al., AIP Conf. Proc. 535 (1), 102 (2000)</em>. Since the latter work was carried out using norm-conserving PSP I've redone the calculation using OPIUM generated PSP and the PBE functional. The result is shown in phonon_band_struct_PSP.png. In this case the LO-TO splitting is correctly accounted for, and the band structure is generally in good agreement with that reported in Ghosez et al. Yet, there is an extra instability around X in my calculation, which the reference shows for BaTiO<span style="font-size: 85%; line-height: 116%;">3</span> and Ba<span style="font-size: 85%; line-height: 116%;">0.5</span>Sr<span style="font-size: 85%; line-height: 116%;">0.5</span>TiO<span style="font-size: 85%; line-height: 116%;">3</span>, but not for SrTiO<span style="font-size: 85%; line-height: 116%;">3</span>. I'm guessing this is due to the use of PBE functional in my calculation which introduces a relative error of +1% on the lattice parameter compared with the use of the LDA in the reference, which I found produces an error of -1% on the lattice parameters in case of SrTiO<span style="font-size: 85%; line-height: 116%;">3</span>.<br /><br />Does the implementation of DFPT with PAWs still have some issues in the current version Abinit 7.8.2, in particular with regard to the TO-LO splitting? I hope someone can clarify these findings. <br /><br />My script for the generation of the derivative database using PAWs (based on the input file from the second tutorial on response calculations) and the input file for the analysis of the ddb, to obtain the phonon band structure are displayed below.<br /><br />Best wishes,<br />Jonas<br /><br /><br /><span style="color: #FF0000">******************************************************************<br />******************************************************************</span><br /><br /># Crystalline SrTiO3 : computation of the phonon spectrum<br /><br />   ndtset   22<br />#Set 1 : ground state self-consistency<br /><br />  getwfk1   0            # Cancel default<br />  kptopt1   1            # Automatic generation of k points, taking<br />                         # into account the symmetry<br />    nqpt1   0            # Cancel default<br />  tolwfr1  1.0d-22       # SCF stopping criterion (modify default)<br />  rfphon1   0            # Cancel default<br />  iscf1  17<br />  nstep1  1600<br />  prtwf1  1<br /> <br />#Q vectors for all datasets<br /><br />#Complete set of symmetry-inequivalent qpt chosen to be commensurate<br /># with kpt mesh so that only one set of GS wave functions is needed.<br />#Generated automatically by running GS calculation with kptopt=1,<br /># nshift=0, shiftk=0 0 0 (to include gamma) and taking output kpt set<br /># file as qpt set. Set nstep=1 so only one iteration runs.<br /><br />     nqpt   1            # One qpt for each dataset (only 0 or 1 allowed)<br />                         # This is the default for all datasets and must<br />                         #  be explicitly turned off for dataset 1.<br /><br />               qpt2    0.00000000E+00  0.00000000E+00  0.00000000E+00<br />               qpt3    0.00000000E+00  0.00000000E+00  0.00000000E+00<br />               qpt4    1.66666667E-01  0.00000000E+00  0.00000000E+00<br />               qpt5    3.33333333E-01  0.00000000E+00  0.00000000E+00<br />               qpt6    5.00000000E-01  0.00000000E+00  0.00000000E+00<br />               qpt7    1.66666667E-01  1.66666667E-01  0.00000000E+00<br />               qpt8    3.33333333E-01  1.66666667E-01  0.00000000E+00<br />               qpt9    5.00000000E-01  1.66666667E-01  0.00000000E+00<br />               qpt10   3.33333333E-01  3.33333333E-01  0.00000000E+00<br />               qpt11   5.00000000E-01  3.33333333E-01  0.00000000E+00<br />               qpt12   5.00000000E-01  5.00000000E-01  0.00000000E+00<br />               qpt13   1.66666667E-01  1.66666667E-01  1.66666667E-01<br />               qpt14   3.33333333E-01  1.66666667E-01  1.66666667E-01<br />               qpt15   5.00000000E-01  1.66666667E-01  1.66666667E-01<br />               qpt16   3.33333333E-01  3.33333333E-01  1.66666667E-01<br />               qpt17   5.00000000E-01  3.33333333E-01  1.66666667E-01<br />               qpt18   5.00000000E-01  5.00000000E-01  1.66666667E-01<br />               qpt19   3.33333333E-01  3.33333333E-01  3.33333333E-01<br />               qpt20   5.00000000E-01  3.33333333E-01  3.33333333E-01<br />               qpt21   5.00000000E-01  5.00000000E-01  3.33333333E-01<br />               qpt22   5.00000000E-01  5.00000000E-01  5.00000000E-01<br /><br /><br />#Set 2 : Response function calculation of d/dk wave function <br /><br />    iscf2   -3         # Need this non-self-consistent option for d/dk<br />  kptopt2   2          # Modify default to use time-reversal symmetry<br />  rfphon2   0          # Cancel default<br />  rfelfd2   2          # Calculate d/dk wave function only<br />  tolwfr2   1.0d-22    # Use wave function residual criterion instead<br />  nstep2  1600<br />  prtwf2  1<br />  <br /><br />#Set 3 : Response function calculation of Q=0 phonons and electric field pert.<br /><br />  getddk3   2          # d/dk wave functions from last dataset<br />  kptopt3   2          # Modify default to use time-reversal symmetry<br />  rfelfd3   3          # Electric-field perturbation response only<br /><br />#Sets 4-22 : Finite-wave-vector phonon calculations (defaults for all datasets)<br /><br />   getwfk   1          # Use GS wave functions from dataset1<br />   kptopt   3          # Need full k-point set for finite-Q response<br />   rfphon   1          # Do phonon response<br />  rfatpol   1 5        # Treat displacements of all atoms<br />    rfdir   1 1 1      # Do all directions (symmetry will be used)<br />   tolvrs   1.0d-8     # This default is active for sets 3-22<br />   prtwf   0<br /><br />#######################################################################<br />#Common input variables<br /><br /># Definition of the unit cell<br />#acell 3*7.27888848134371  <br />acell 3*7.27898250385070<br />rprim                           # a cubic unit cell<br />  1 0 0<br />  0 1 0<br />  0 0 1<br /><br /># Definition of the atom types<br />ntypat 3<br />znucl 38 22 8                   # strontium (38), titanium (22), oxygen (8)<br /><br /># Definition of the atoms<br />natom 5<br />typat 1 2 3 3 3<br />xred<br />  0.0 0.0 0.0                   # Sr sits at cubic site<br />  0.5 0.5 0.5                   # Ti sits at body-center site<br />  0.0 0.5 0.5                   # O sits at face-centered sites<br />  0.5 0.0 0.5<br />  0.5 0.5 0.0<br /><br />#Gives the number of band, explicitely (do not take the default)<br />    nband   20      <br /><br />#Exchange-correlation functional<br /><br />      ixc   7             # LDA-Perdew-Wang<br /><br />#Definition of the planewave basis set<br /><br />     ecut   60           # Maximal kinetic energy cut-off, in Hartree<br />    pawecutdg  80<br /><br />#Definition of the k-point grid<br />    ngkpt   6  6  6          <br />  nshiftk   1              # Use one copy of grid only (default)<br />   shiftk   0.5  0.5  0.5<br />   paral_kgb  0<br /><br />#Definition of the SCF procedure<br />     iscf   7          # Self-consistent calculation, using algorithm 5<br />    nstep   400         # Maximal number of SCF cycles<br />   diemac   6.0        # Although this is not mandatory, it is worth to<br />                       # precondition the SCF cycle. The model dielectric<br />                       # function used as the standard preconditioner<br />                       # is described in the &quot;dielng&quot; input variable section.<br />                       # The dielectric constant of AlAs is smaller that the one of Si (=12).<br /># add to conserve old &lt; 6.7.2 behavior for calculating forces at each SCF step<br /> optforces 1<br /><br /><span style="color: #FF0000">******************************************************************<br />******************************************************************</span><br /><br />!Input file for the anaddb code. Analysis of the SrTiO3 DDB                       <br /><br />!Flags<br /> ifcflag   1     ! Interatomic force constant flag<br /><br />!Wavevector grid number 1 (coarse grid, from DDB)<br />  brav    1      ! Bravais Lattice : 1-S.C., 2-F.C., 3-B.C., 4-Hex.)<br />  ngqpt   6  6  6   ! Monkhorst-Pack indices<br />  nqshft  1         ! number of q-points in repeated basic q-cell<br />  q1shft  3*0.0<br /><br />!Effective charges<br />     asr   1     ! Acoustic Sum Rule. 1 =&gt; imposed asymetrically<br />  chneut   1     ! Charge neutrality requirement for effective charges.<br /><br />!Interatomic force constant info<br />  dipdip  1      ! Dipole-dipole interaction treatment<br /><br />!Phonon band structure output for band2eps - See note near end for<br />! dealing with gamma LO-TO splitting issue.<br />   eivec  4<br /><br />!Wavevector list number 1 (Reduced coordinates and normalization factor)         <br />  nph1l    101      ! number of phonons in list 1                             <br /><br />  qph1l   0 0 0 1.0<br />0 0.025 0 1.0<br />0 0.05 0 1.0<br />0 0.075 0 1.0<br />0 0.1 0 1.0<br />0 0.125 0 1.0<br />0 0.15 0 1.0<br />0 0.175 0 1.0<br />0 0.2 0 1.0<br />0 0.225 0 1.0<br />0 0.25 0 1.0<br />0 0.275 0 1.0<br />0 0.3 0 1.0<br />0 0.325 0 1.0<br />0 0.35 0 1.0<br />0 0.375 0 1.0<br />0 0.4 0 1.0<br />0 0.425 0 1.0<br />0 0.45 0 1.0<br />0 0.475 0 1.0<br />0 0.5 0 1.0<br />0.025 0.5 0 1.0<br />0.05 0.5 0 1.0<br />0.075 0.5 0 1.0<br />0.1 0.5 0 1.0<br />0.125 0.5 0 1.0<br />0.15 0.5 0 1.0<br />0.175 0.5 0 1.0<br />0.2 0.5 0 1.0<br />0.225 0.5 0 1.0<br />0.25 0.5 0 1.0<br />0.275 0.5 0 1.0<br />0.3 0.5 0 1.0<br />0.325 0.5 0 1.0<br />0.35 0.5 0 1.0<br />0.375 0.5 0 1.0<br />0.4 0.5 0 1.0<br />0.425 0.5 0 1.0<br />0.45 0.5 0 1.0<br />0.475 0.5 0 1.0<br />0.5 0.5 0 1.0<br />.475 .475 0 1.0<br />.45 .45 0 1.0<br />.425 .425 0 1.0<br />.4 .4 0 1.0<br />.375 .375 0 1.0<br />.35 .35 0 1.0<br />.325 .325 0 1.0<br />.3 .3 0 1.0<br />.275 .275 0 1.0<br />.25 .25 0 1.0<br />.225 .225 0 1.0<br />.2 .2 0 1.0<br />.175 .175 0 1.0<br />.15 .15 0 1.0<br />.125 .125 0 1.0<br />.1 .1 0 1.0<br />.075 .075 0 1.0<br />.05 .05 0 1.0<br />.025 .025 0 1.0<br />0 0 0 1.0<br />0.025 0.025 0.025 1.0<br />0.05 0.05 0.05 1.0<br />0.075 0.075 0.075 1.0<br />0.1 0.1 0.1 1.0<br />0.125 0.125 0.125 1.0<br />0.15 0.15 0.15 1.0<br />0.175 0.175 0.175 1.0<br />0.2 0.2 0.2 1.0<br />0.225 0.225 0.225 1.0<br />0.25 0.25 0.25 1.0<br />0.275 0.275 0.275 1.0<br />0.3 0.3 0.3 1.0<br />0.325 0.325 0.325 1.0<br />0.35 0.35 0.35 1.0<br />0.375 0.375 0.375 1.0<br />0.4 0.4 0.4 1.0<br />0.425 0.425 0.425 1.0<br />0.45 0.45 0.45 1.0<br />0.475 0.475 0.475 1.0<br />0.5 0.5 0.5 1.0<br />.475 0.5 .475 1.0<br />.45 0.5 .45 1.0<br />.425 0.5 .425 1.0<br />.4 0.5 .4 1.0<br />.375 0.5 .375 1.0<br />.35 0.5 .35 1.0<br />.325 0.5 .325 1.0<br />.3 0.5 .3 1.0<br />.275 0.5 .275 1.0<br />.25 0.5 .25 1.0<br />.225 0.5 .225 1.0<br />.2 0.5 .2 1.0<br />.175 0.5 .175 1.0<br />.15 0.5 .15 1.0<br />.125 0.5 .125 1.0<br />.1 0.5 .1 1.0<br />.075 0.5 .075 1.0<br />.05 0.5 .05 1.0<br />.025 0.5 .025 1.0<br />0 0.5 0 1.0<br /><br />!Wavevector list number 2 (Cartesian directions for non-analytic gamma phonons)<br /><br />!The output for this calculation must be cut-and-pasted into the<br />! t59_out.freq file to be used as band2eps input to get proper LO-TO <br />! splitting at gamma.  Note that gamma occurrs twice.<br /><br />  nph2l    1       ! number of directions in list 2<br /><br />  qph2l   1.0  0.0  0.0    0.0<br /># This line added when defaults were changed (v5.3) to keep the previous, old behaviour<br />  symdynmat 0<br /><br />prtdos 1<br />ng2qpt 40 40 40</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Erroneous phonon band structure of SrTiO3 using PAWs</h3>
				<div class="date">Posted: <strong>Tue Aug 19, 2014 5:29 pm</strong></div>
				<div class="author">by <strong>Jordan</strong></div>
				<div class="content">Hi,<br /><br />Currently (7.8.2) the DFPT in PAW is usable. However, you have to correct the LO-TO splitting by yourself. <br />The electric field is not yet taken into account in the linear response calculations within PAW but someone is working on it.<br /><br />Note that you can use qptop=1, ngqpt= 8 8 8 , nshitq=1 and shiftq= 0 0 0 to generate your q pt grid. If you only want to calculate one qpt per dtset, you can use iqpt to specify the qpt you want.<br /><br />Hope that helps<br /><br />Jordan</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Erroneous phonon band structure of SrTiO3 using PAWs</h3>
				<div class="date">Posted: <strong>Wed Aug 20, 2014 4:40 pm</strong></div>
				<div class="author">by <strong>JBekaert</strong></div>
				<div class="content">Hi,<br /><br />Thanks for the tip on the generation of the q-point grid.<br /><br />In the phonon band structure obtained with PAW potentials, which I had attached, the correction for the TO-LO splitting was included. Yet, the values obtained from the anaddb run are clearly not feasible. This is also related to the strange Born effective charges I find in the case of the PAW potentials. Normally, for SrTiO3 the effective charge matrices of each ion should be diagonal and all elements should be equal for Sr and Ti and contain 2 perpendicular and one parallel value in case of O. However, I have obtained the following in my run using the PAW potentials:<br /><br /><span style="color: #00BF40">Effective charge tensors after imposition of the charge neutrality, and eventual restriction to some part :<br />   atom    displacement<br />         1         1    3.520500E-01    0.000000E+00    0.000000E+00<br />         1         2    1.681585E-15    1.366685E+00    0.000000E+00<br />         1         3   -1.620922E-15    0.000000E+00    3.520500E-01<br />         2         1    3.761360E+00    0.000000E+00    0.000000E+00<br />         2         2    3.303179E-15    4.775996E+00    0.000000E+00<br />         2         3    2.875521E-15    0.000000E+00    3.761360E+00<br />         3         1   -2.197406E+00    0.000000E+00    0.000000E+00<br />         3         2   -1.028082E-15   -5.016544E+00    0.000000E+00<br />         3         3    2.229918E-15    0.000000E+00   -9.580020E-01<br />         4         1   -9.580020E-01    0.000000E+00    0.000000E+00<br />         4         2   -1.284910E-15   -1.182771E+00    0.000000E+00<br />         4         3    5.880706E-16    0.000000E+00   -9.580020E-01<br />         5         1   -9.580020E-01    0.000000E+00    0.000000E+00<br />         5         2   -2.671772E-15    5.663347E-02    0.000000E+00<br />         5         3   -4.072588E-15    0.000000E+00   -2.197406E+00</span><br /><br />On the other hand, using the norm-conserving pseudopotentials, the Born effective charges I obtain comply with the symmetry of SrTiO3 and also agree well with the values reported in Ref. <em class="text-italics">Ph. Ghosez et al., AIP Conf. Proc. 535 (1), 102 (2000)</em>:<br /><br /><span style="color: #00BF40"> Effective charge tensors after imposition of the charge neutrality, and eventual restriction to some part :<br />   atom    displacement<br />         1         1    2.555890E+00    0.000000E+00    0.000000E+00<br />         1         2    2.328253E-15    2.555890E+00    0.000000E+00<br />         1         3   -2.774769E-15    0.000000E+00    2.555890E+00<br />         2         1    7.438634E+00    0.000000E+00    0.000000E+00<br />         2         2    3.342776E-15    7.438634E+00    0.000000E+00<br />         2         3   -4.941754E-16    0.000000E+00    7.438633E+00<br />         3         1   -5.927441E+00    0.000000E+00    0.000000E+00<br />         3         2   -3.301131E-15   -2.033541E+00    0.000000E+00<br />         3         3    4.264049E-16    0.000000E+00   -2.033541E+00<br />         4         1   -2.033541E+00    0.000000E+00    0.000000E+00<br />         4         2   -8.584682E-16   -5.927441E+00    0.000000E+00<br />         4         3    8.022460E-16    0.000000E+00   -2.033541E+00<br />         5         1   -2.033541E+00    0.000000E+00    0.000000E+00<br />         5         2   -1.511430E-15   -2.033541E+00    0.000000E+00<br />         5         3    2.040293E-15    0.000000E+00   -5.927441E+00</span><br /><br />The input scripts for both runs are almost identical, apart from using PAW or PSP, this is why I would think some error occurs for the former within the calculation of the Born effective charges, resulting in a wrong TO-LO splitting. I don't think the strange Born effective charges are directly related to the missing instabilities around Gamma and M, but I'm not sure.<br /><br />Is the calculation of the Born effective charges generally problematic using PAW potentials or is something not optimal in my input?<br /><br />Cheers,<br />Jonas</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=2765&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:34:24 GMT -->
</html>
