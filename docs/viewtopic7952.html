<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1816&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:30:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; MPI Berry Phase Tutorial Crash</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>MPI Berry Phase Tutorial Crash</h2>
		<p><a href="viewtopic7e4f.html?f=10&amp;t=1816">https://forum.abinit.org/viewtopic.php?f=10&amp;t=1816</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>MPI Berry Phase Tutorial Crash</h3>
				<div class="date">Posted: <strong>Thu Aug 30, 2012 7:49 am</strong></div>
				<div class="author">by <strong>paulfons</strong></div>
				<div class="content">I first ran the Berry phase tutorial file tffield_1.in though my version of abinit (12.6.3) without incident. When I introduced the following three lines to parallelize over the k-points using mpi, the program crashed in a manner similar to my earlier posting.  The parallelization conditions were determined by running paral_kgb -32 and running with 32 processors.  I do not see what I am doing wrong.  Is there a crashing bug in the Berry phase routine?  Does anyone have any insight as to what I could do to get it to work?<br /><br /><br />#Parallization<br />#***********************<br />paral_kgb 1<br />npkpt 16<br />npspinor 2<br /><br /><br />The code crashed in a manner to my earlier posting.<br /><br /><br /><br /><br />       Simple Lattice Grid<br />  initberry: for direction 1, nkstr =   6, nstr = 144<br />  initberry: for direction 2, nkstr =   6, nstr = 144<br />  initberry: for direction 3, nkstr =   6, nstr = 144<br />*** glibc detected *** /opt/abinit/bin/abinit: free(): invalid pointer: 0x0000000005487240 ***<br />======= Backtrace: =========<br />/lib64/libc.so.6(+0x733b6)[0x2b4825c013b6]<br />/lib64/libc.so.6(cfree+0x6c)[0x2b4825c062dc]<br />/opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifcore.so.5(for_deallocate+0xb9)[0x2b4824463879]<br />/opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifcore.so.5(for_dealloc_allocatable+0x70)[0x2b4824463780]<br />/opt/abinit/bin/abinit[0x1403220]<br />/opt/abinit/bin/abinit[0xd01f30]<br />/opt/abinit/bin/abinit[0x4e7c5e]<br />/opt/abinit/bin/abinit[0x41ecee]<br />/opt/abinit/bin/abinit[0x4101f8]<br />/opt/abinit/bin/abinit[0x40853a]<br />/opt/abinit/bin/abinit[0x4070dc]<br />/lib64/libc.so.6(__libc_start_main+0xfd)[0x2b4825bacbfd]<br />/opt/abinit/bin/abinit[0x406fd9]<br />======= Memory map: ========<br />forrtl: severe (174): SIGSEGV, segmentation fault occurred<br />Image              PC                Routine            Line        Source             <br />abinit             000000000140301E  Unknown               Unknown  Unknown<br />abinit             0000000000D01F30  Unknown               Unknown  Unknown<br />abinit             00000000004E7C5E  Unknown               Unknown  Unknown<br />abinit             000000000041ECEE  Unknown               Unknown  Unknown<br />abinit             00000000004101F8  Unknown               Unknown  Unknown<br />abinit             000000000040853A  Unknown               Unknown  Unknown<br />abinit             00000000004070DC  Unknown               Unknown  Unknown<br />libc.so.6          00002ACF0A881BFD  Unknown               Unknown  Unknown<br />abinit             0000000000406FD9  Unknown               Unknown  Unknown<br />00400000-022a5000 r-xp 00000000 08:01 1580141                            /opt/abinit/bin/abinit<br />024a4000-024a5000 r--p 01ea4000 08:01 1580141                            /opt/abinit/bin/abinit<br />024a5000-02620000 rw-p 01ea5000 08:01 1580141                            /opt/abinit/bin/abinit<br />02620000-05602000 rw-p 00000000 00:00 0                                  [heap]<br />2b4821533000-2b4821551000 r-xp 00000000 08:01 653270                     /lib64/ld-2.11.3.so<br />2b4821551000-2b4821552000 rw-p 00000000 00:00 0 <br />2b4821568000-2b4821569000 rw-p 00000000 00:00 0 <br />2b4821750000-2b4821751000 r--p 0001d000 08:01 653270                     /lib64/ld-2.11.3.so<br />2b4821751000-2b4821752000 rw-p 0001e000 08:01 653270                     /lib64/ld-2.11.3.so<br />2b4821752000-2b4821753000 rw-p 00000000 00:00 0 <br />2b4821753000-2b4821755000 r-xp 00000000 08:01 659377                     /lib64/libdl-2.11.3.so<br />2b4821755000-2b4821955000 ---p 00002000 08:01 659377                     /lib64/libdl-2.11.3.so<br />2b4821955000-2b4821956000 r--p 00002000 08:01 659377                     /lib64/libdl-2.11.3.so<br />2b4821956000-2b4821957000 rw-p 00003000 08:01 659377                     /lib64/libdl-2.11.3.so<br />2b4821957000-2b4821f29000 r-xp 00000000 08:01 1594785                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_intel_lp64.so<br />2b4821f29000-2b4822129000 ---p 005d2000 08:01 1594785                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_intel_lp64.so<br />2b4822129000-2b4822138000 rw-p 005d2000 08:01 1594785                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_intel_lp64.so<br />2b4822138000-2b482213d000 rw-p 00000000 00:00 0 <br />2b482213d000-2b4822610000 r-xp 00000000 08:01 1594795                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_sequential.so<br />2b4822610000-2b482280f000 ---p 004d3000 08:01 1594795                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_sequential.so<br />2b482280f000-2b482281b000 rw-p 004d2000 08:01 1594795                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_sequential.so<br />2b482281b000-2b482281c000 rw-p 00000000 00:00 0 <br />2b482281c000-2b4823664000 r-xp 00000000 08:01 1594779                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_core.so<br />2b4823664000-2b4823863000 ---p 00e48000 08:01 1594779                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_core.so<br />2b4823863000-2b4823877000 rw-p 00e47000 08:01 1594779                    /opt/intel/composer_xe_2011_sp1.11.339/mkl/lib/intel64/libmkl_core.so<br />2b4823877000-2b4823887000 rw-p 00000000 00:00 0 <br />2b4823887000-2b482388f000 r-xp 00000000 08:01 659403                     /lib64/librt-2.11.3.so<br />2b482388f000-2b4823a8e000 ---p 00008000 08:01 659403                     /lib64/librt-2.11.3.so<br />2b4823a8e000-2b4823a8f000 r--p 00007000 08:01 659403                     /lib64/librt-2.11.3.so<br />2b4823a8f000-2b4823a90000 rw-p 00008000 08:01 659403                     /lib64/librt-2.11.3.so<br />2b4823a90000-2b4823df4000 r-xp 00000000 08:01 1579710                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpi.so.4.0<br />2b4823df4000-2b4823ef3000 ---p 00364000 08:01 1579710                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpi.so.4.0<br />2b4823ef3000-2b4823f10000 rw-p 00363000 08:01 1579710                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpi.so.4.0<br />2b4823f10000-2b4823f5b000 rw-p 00000000 00:00 0 <br />2b4823f5b000-2b4823f88000 r-xp 00000000 08:01 1579745                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpigf.so.4.0<br />2b4823f88000-2b4824088000 ---p 0002d000 08:01 1579745                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpigf.so.4.0<br />2b4824088000-2b4824089000 rw-p 0002d000 08:01 1579745                    /opt/intel/impi/4.0.3.008/intel64/lib/libmpigf.so.4.0<br />2b4824089000-2b48240a0000 r-xp 00000000 08:01 652925                     /lib64/libpthread-2.11.3.so<br />2b48240a0000-2b48242a0000 ---p 00017000 08:01 652925                     /lib64/libpthread-2.11.3.so<br />2b48242a0000-2b48242a1000 r--p 00017000 08:01 652925                     /lib64/libpthread-2.11.3.so<br />2b48242a1000-2b48242a2000 rw-p 00018000 08:01 652925                     /lib64/libpthread-2.11.3.so<br />2b48242a2000-2b48242a6000 rw-p 00000000 00:00 0 <br />2b48242a6000-2b48242d3000 r-xp 00000000 08:01 1576766                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifport.so.5<br />2b48242d3000-2b48243d2000 ---p 0002d000 08:01 1576766                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifport.so.5<br />2b48243d2000-2b48243d5000 rw-p 0002c000 08:01 1576766                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifport.so.5<br />2b48243d5000-2b48243dc000 rw-p 00000000 00:00 0 <br />2b48243dc000-2b4824508000 r-xp 00000000 08:01 1576758                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifcore.so.5<br />2b4824508000-2b4824608000 ---p 0012c000 08:01 1576758                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifcore.so.5<br />2b4824608000-2b4824619000 rw-p 0012c000 08:01 1576758                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libifcore.so.5<br />2b4824619000-2b4824620000 rw-p 00000000 00:00 0 <br />2b4824620000-2b48248a8000 r-xp 00000000 08:01 1566862                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libimf.so<br />2b48248a8000-2b48249a8000 ---p 00288000 08:01 1566862                    /opt/intel/composer_xe_2011_sp1.11.339/compiler/lib/intel64/libimf.soforrtl: severe (174): SIGSEGV, segmentation fault occurred<br />Image              PC                Routine            Line        Source             <br />abinit             000000000140301E  Unknown               Unknown  Unknown<br />abinit             0000000000D01F30  Unknown               Unknown  Unknown<br />abinit             00000000004E7C5E  Unknown               Unknown  Unknown<br />abinit             000000000041ECEE  Unknown               Unknown  Unknown<br />abinit             00000000004101F8  Unknown               Unknown  Unknown<br />abinit             000000000040853A  Unknown               Unknown  Unknown<br />abinit             00000000004070DC  Unknown               Unknown  Unknown<br />libc.so.6          00002B8F99733BFD  Unknown               Unknown  Unknown<br />abinit             0000000000406FD9  Unknown               Unknown  Unknown<br />APPLICATION TERMINATED WITH THE EXIT STRING: Hangup (signal 1)<br />paulfons@asccmp177:~/AbinitJobs/AlAs&gt;</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: MPI Berry Phase Tutorial Crash</h3>
				<div class="date">Posted: <strong>Mon Sep 10, 2012 7:05 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">Hi again, as noted in my response to another of your posts, nspinor 2 doesn't really work in 6.12.3 for berry's phase, it works in 7.0.1. Furthermore, I am not sure that paral_kgb parallelization has been fully tested for the berry's phase code (this is parallelization over k points, bands, fft planes, spinors). Simpler parallelization over only k points has been tested; it is invoked automatically when you run on more than one processor, but you do not use paral_kgb to get it.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1816&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:30:33 GMT -->
</html>
