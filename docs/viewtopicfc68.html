<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=19&t=3676&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 17:39:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Symmetrization in the nlinopt subroutine</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Symmetrization in the nlinopt subroutine</h2>
		<p><a href="viewtopic11a7.html?f=19&amp;t=3676">https://forum.abinit.org/viewtopic.php?f=19&amp;t=3676</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Symmetrization in the nlinopt subroutine</h3>
				<div class="date">Posted: <strong>Wed Sep 13, 2017 5:02 pm</strong></div>
				<div class="author">by <strong>kurtg</strong></div>
				<div class="content">Dear developers, <br /><br />I am confused with the following lines in the nlinopt subroutine. <br /><br />!            symmetrize the momentum matrix elements<br />             do lx=1,3<br />               do ly=1,3<br />                 do lz=1,3<br />                   i1=sym(lx,ly,lz)+sym(lx,lz,ly)<br />                   i2=sym(ly,lx,lz)+sym(ly,lz,lx)<br />                   i3=sym(lz,lx,ly)+sym(lz,ly,lx)<br />                   px(ist1,ist2,lx,ly,lz)=i1*pmat(ist1,ist2,ik,lx,isp)<br />                   py(ist2,ist1,lx,ly,lz)=i2*pmat(ist2,ist1,ik,lx,isp)   ! TODO: check if this should not be ly, lz on these lines<br />                   pz(ist2,ist1,lx,ly,lz)=i3*pmat(ist2,ist1,ik,lx,isp)<br />                 end do<br />               end do<br />             end do<br /><br />Why do ly and lz not appear on the last two lines (red). Am I missing a trick in the symmetrization?<br /><br />                   px(ist1,ist2,lx,ly,lz)=i1*pmat(ist1,ist2,ik,lx,isp)<br />                   py(ist2,ist1,lx,ly,lz)=i2*pmat(ist2,ist1,ik,<span style="color: #FF0000">ly</span>,isp)<br />                   pz(ist2,ist1,lx,ly,lz)=i3*pmat(ist2,ist1,ik,<span style="color: #FF0000">lz</span>,isp)<br /> <br /> <br />And If ist1 and ist2 correspond to valence and conduction band states why are the following lines for py and pz not consistent with px?<br /> <br />                   px(ist1,ist2,lx,ly,lz)=i1*pmat(ist1,ist2,ik,lx,isp)<br />                   py(<span style="color: #FF0000">ist2</span>,<span style="color: #FF0000">ist1</span>,lx,ly,lz)=i2*pmat(ist2,ist1,ik,lx,isp)<br />                   pz(<span style="color: #FF0000">ist2</span>,<span style="color: #FF0000">ist1</span>,lx,ly,lz)=i3*pmat(ist2,ist1,ik,lx,isp)<br /> <br />If you can shed some light on this implementation, I would appreciate it.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=19&t=3676&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 17:39:00 GMT -->
</html>
