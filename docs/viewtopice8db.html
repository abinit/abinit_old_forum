<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1584 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:20:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Abinit 6.12.2 hanging on WFK write with MPI-IO - ABINIT Discussion Forums</title>


	<link rel="canonical" href="viewtopic04b5.html?t=1584">

<!--
	phpBB style name: Flat Style
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      Ian Bradley
-->

<link href="assets/css/font-awesome.minaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/stylesheetaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/en/stylesheetaea1.css?assets_version=57" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/flat-style/theme/tweaks.css?assets_version=57" rel="stylesheet">
<![endif]-->

<meta name="google-site-verification" content="PLdTN48UENWHvJ5ViWhDTahZKzoMyw5e1QZgw1IECVw" />
<link rel="alternate" type="application/atom+xml" title="ATOM" href="app.php/smartfeed/feed.html" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="app.php/smartfeed/feed9830.html?y=2" />

<link href="ext/crizzo/aboutus/styles/prosilver/theme/aboutusaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/dmzx/topicageday/styles/prosilver/theme/topicagedayaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/clock/styles/all/theme/clockaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/googlesearch/styles/prosilver/theme/googlesearchaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/kinerity/bestanswer/styles/prosilver/theme/bestansweraea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbb/collapsiblecategories/styles/all/theme/collapsiblecategoriesaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbbservices/smartfeed/styles/prosilver/theme/customaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/senky/userstatistics/styles/prosilver/theme/userstatisticsaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/tierra/topicsolved/styles/prosilver/theme/buttonsaea1.css?assets_version=57" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description">
				<a id="logo" class="logo" href="index-2.html" title="Board index"><span class="site_logo"></span></a>
				<div  class="site-description">
					<h1>ABINIT Discussion Forums</h1>
					<p>The meeting place for ABINIT users and developers</p>
					<p class="skiplink"><a href="#start_here">Skip to content</a></p>
				</div>
			</div>

			</div>
					</div>
				<div class="navbar navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
										
										<li class="separator"></li>

									</ul>
			</div>
		</li>

			<li class="small-icon icon-smartfeed no-bulletin"><a href="app.php/smartfeed/ui.html">Smartfeed</a></li>		<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Main Site</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/packages" title="" role="menuitem" target="_blank">
				<i class="icon fa-download fa-fw" aria-hidden="true"></i><span>Download</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-book fa-fw" aria-hidden="true"></i><span>Documentations</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/tutorial/" title="" role="menuitem" target="_blank">
				<i class="icon fa-graduation-cap fa-fw" aria-hidden="true"></i><span>Tutorials</span>
				</a>
			</li>
							
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
						</ul>
    </div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">
	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
								<li class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
										<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope><a href="index-2.html" itemtype="https://schema.org/Thing" itemprop="item" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>
											<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="4"><a href="viewforum31e6.html?f=4" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Running Abinit</span></a><meta itemprop="position" content="2" /></span>
															<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="9"><a href="viewforumfdc5.html?f=9" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Ground state</span></a><meta itemprop="position" content="3" /></span>
												</li>
		<li class="rightside responsive-hide">
	<div id="show-clock">
		<div id="liveclock" class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
</li><!--[if !IE]><!-->
<li id="g-search-box" class="search-box rightside responsive-hide">
	<form action="https://forum.abinit.org/app.php/googlesearch">
	<fieldset>
		<input name="cx" type="hidden" value="017804512478788106347:tlftx8kncg4">
		<input name="q" type="search" maxlength="255" class="inputbox search tiny" value="" placeholder="Google Search ...">
		<button class="button button-search-google" type="submit" name="sitesearch" title="Google Search">
		<i class="icon fa-search fa-fw" aria-hidden="true"></i>
		</button>
	</fieldset>
</form>
</li>
<!--<![endif]-->

							<li id="search-box" class="rightside search-box responsive-hide" role="search">
				<form action="https://forum.abinit.org/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</li>

			<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
					</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		﻿
<h2 class="topic-title"><a href="viewtopice8db.html?f=9&amp;t=1584">Abinit 6.12.2 hanging on WFK write with MPI-IO</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Total energy, geometry optimization, DFT+U, spin....<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista146.html?mode=viewprofile&amp;u=2687" class="username">bguster</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting5514.html?mode=reply&amp;f=9&amp;t=1584" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic7b1b.html?f=9&amp;t=1584&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://forum.abinit.org/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1584" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			2 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p4947" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4947">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaf78.html?mode=viewprofile&amp;u=209" class="username">kaneod</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search66ac.html?author_id=209&amp;sr=posts">42</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 10, 2010 11:47 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4947">

						<h3 class="first"><a href="#p4947">Abinit 6.12.2 hanging on WFK write with MPI-IO</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting78a1.html?mode=quote&amp;f=9&amp;p=4947" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic5d75.html?p=4947#p4947" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaf78.html?mode=viewprofile&amp;u=209" class="username">kaneod</a></strong> &raquo; </span>Tue Mar 27, 2012 4:43 am
			</p>
			
			
			
			<div class="content">I'm in a bit of a bind. I need the WFK files for a series of rather large molecules (38-173 atoms) so I can visualize the HOMO/LUMO for each. Since I'm only running a gamma point calculation, I'm using KGB parallelization over up to 640 bands and over up to 48 processors, 8 processors per node. Temporary files are being written to each node's tmp area but the collective files (outputs) are written to a fast GPFS filesystem.<br /><br />If I compile MPI-IO support into Abinit, the jobs hang at the stage of writing the WFK files. The last log output is (for any sized molecule):<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;----iterations are completed or convergence reached----<br /><br />&nbsp;outwf&nbsp; : write wavefunction to file poro_WFK<br />-P-0000&nbsp; leave_test : synchronization done...<br /><br />&nbsp;m_wffile.F90:279:COMMENT<br />&nbsp; &nbsp;MPI/IO accessing FORTRAN file header: detected record mark length=4</code></pre></div><br /><br />The code does not proceed any further although the processor utilization appears to stay at near 100% of normal (typically at least 95% over all the processors/nodes). The WFK file as written is about 800-850K in size, I suppose it just contains a header.<br /><br />Technical details: the code is compiled using gfortran 4.6.2, fftw3, openblas, against either OpenMPI 1.4.5 or mvapich2 (1.8 and HEAD). Same error regardless of MPI implementation. This is odd, as mvapich2 has the type error problem still when compiling with respect to mpi level 2, so it is necessary to use mpi level 1 to get abinit compiled. Since the MPI-IO routines aren't actually in mpi.h as far as I'm aware, you'd think something would break catastrophically for mvapich2 and MPI-IO.<br /><br />If I disable MPI-IO, the jobs complete but the WFK files are incomplete. They are larger (at least several MB) but not large enough to contain all the cgs, especially for the larger molecules.<br /><br />Note that the DEN files never have any trouble writing, but it doesn't appear to be a filesize problem (as has been hinted in previous threads) because the hang occurs regardless of the molecule (for example, the 38-atom porphine core attached as an example input fails).<br /><br />Another thing is that I <strong class="text-strong">don't have this problem on my workstation</strong> with MPI-IO enabled and using MPICH2. My molecules are too big for my workstation to deal with in a reasonable amount of time. Possibly mpi-io is a bit broken on our cluster, but what steps should I take to try and isolate this further for the developers?<br /><br />I've pasted in an input file, build ac file and jobscript for our cluster that will reproduce the problem. Still can't add attachments (even with txt extensions...).<br /><br />Thanks,<br /><br />Kane<br /><br />Input file:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># porphin molecule<br /><br /><br />#iscf&nbsp; &nbsp; &nbsp; &nbsp; -3<br />#occopt&nbsp; &nbsp; &nbsp; 1<br />nband&nbsp; &nbsp; &nbsp; &nbsp;320<br />#nbdbuf&nbsp; &nbsp; &nbsp; 160<br /><br /># DOS stuff<br /><br />#prtdos&nbsp; &nbsp; &nbsp; 3<br />#natsph&nbsp; &nbsp; &nbsp; 20<br />#iatsph&nbsp; &nbsp; &nbsp; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20<br />#pawprtdos&nbsp; &nbsp;2<br /><br /># SCF parameters<br /><br />ecut&nbsp; &nbsp; &nbsp; &nbsp; 14.0<br />pawecutdg&nbsp; &nbsp;35.0<br />#toldff&nbsp; &nbsp; &nbsp; 5.0d-6<br />#toldfe&nbsp; &nbsp; &nbsp; 4.0d-8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Tighten up convergence slightly<br />tolvrs&nbsp; &nbsp; &nbsp; 1.0d-10<br />nstep&nbsp; &nbsp; &nbsp; &nbsp;200<br />#istwfk&nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Gamma-point only means real wfs.<br />#occopt&nbsp; &nbsp; &nbsp; 7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Gaussian smearing<br />#tsmear&nbsp; &nbsp; &nbsp; 0.02<br />diemix&nbsp; &nbsp; &nbsp; 0.33<br />diemac&nbsp; &nbsp; &nbsp; 2.0<br />#timopt&nbsp; &nbsp; &nbsp;2<br /><br /># Geometry Optimization<br /><br />#optcell&nbsp; &nbsp; &nbsp;0<br />#ionmov&nbsp; &nbsp; &nbsp;2<br />#tolmxf&nbsp; &nbsp; &nbsp;5.0d-5<br />#ntime&nbsp; &nbsp; &nbsp; 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br /># Kpoints<br /><br /># Note: for DOS, need more than gamma point.<br /><br />kptopt&nbsp; &nbsp; &nbsp; 1<br />ngkpt&nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp;1&nbsp; &nbsp;1<br />#ngkpt&nbsp; &nbsp; &nbsp; &nbsp;2 2 2&nbsp; &nbsp; &nbsp;# For DOS<br />nshiftk&nbsp; &nbsp; &nbsp;1<br />shiftk<br />&nbsp; &nbsp; 0.0 0.0 0.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Need to use the true gamma point.<br />#nband&nbsp; &nbsp; &nbsp; &nbsp;80&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Done to fix an input bug.<br /><br /># Parallelization<br /><br />paral_kgb&nbsp; &nbsp; &nbsp; &nbsp;1<br />npkpt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br />npspinor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br />npband&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8<br />npfft&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2<br />bandpp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4<br /><br /># Geometry<br /><br />acell&nbsp; &nbsp; &nbsp; &nbsp;24.0&nbsp; &nbsp; 24.0&nbsp; &nbsp; 14.0&nbsp; &nbsp; &nbsp;angstrom<br />natom&nbsp; &nbsp; &nbsp; &nbsp;38<br />ntypat&nbsp; &nbsp; &nbsp; 3<br />znucl&nbsp; &nbsp; &nbsp; &nbsp;6 7 1<br />typat&nbsp; &nbsp; &nbsp; &nbsp;1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1 1 1 1 2 2 2 2 3 3 3 3 3 3 3 3 <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3 3 3 3 3 3<br />xangst<br />14.43267826697125&nbsp; &nbsp; &nbsp;9.54719469654066&nbsp; &nbsp; &nbsp;6.98679555192892<br />9.56971890234498&nbsp; &nbsp; &nbsp;9.55740143113795&nbsp; &nbsp; &nbsp;6.98136687410452<br />9.57830669996704&nbsp; &nbsp; 14.45323690496433&nbsp; &nbsp; &nbsp;6.99729471155192<br />14.44063286032851&nbsp; &nbsp; 14.44280830865907&nbsp; &nbsp; &nbsp;7.00065218638275<br />13.09053535559251&nbsp; &nbsp; &nbsp;9.13328020797658&nbsp; &nbsp; &nbsp;6.98306316607677<br />12.67923156052460&nbsp; &nbsp; &nbsp;7.73168327773270&nbsp; &nbsp; &nbsp;6.97936199186946<br />11.31569250083367&nbsp; &nbsp; &nbsp;7.73433869282024&nbsp; &nbsp; &nbsp;6.97757649970769<br />10.90999275359248&nbsp; &nbsp; &nbsp;9.13761393307977&nbsp; &nbsp; &nbsp;6.98028668551213<br />9.09554011542721&nbsp; &nbsp; 10.87314035126708&nbsp; &nbsp; &nbsp;6.98561843864410<br />7.72903461616869&nbsp; &nbsp; 11.31936915287400&nbsp; &nbsp; &nbsp;6.98735375088374<br />7.73139760192924&nbsp; &nbsp; 12.69760130406586&nbsp; &nbsp; &nbsp;6.99113573510774<br />9.09938031597771&nbsp; &nbsp; 13.13925447483067&nbsp; &nbsp; &nbsp;6.99243851467787<br />10.92010300631924&nbsp; &nbsp; 14.86758534532777&nbsp; &nbsp; &nbsp;7.00085421660784<br />11.33151776548370&nbsp; &nbsp; 16.26917592327966&nbsp; &nbsp; &nbsp;7.00566526340061<br />12.69511949460426&nbsp; &nbsp; 16.26616429625911&nbsp; &nbsp; &nbsp;7.00672787336548<br />13.10041479027480&nbsp; &nbsp; 14.86264378806152&nbsp; &nbsp; &nbsp;7.00242954254950<br />14.91526145037882&nbsp; &nbsp; 13.12729369433697&nbsp; &nbsp; &nbsp;6.99679680639886<br />16.28188688560975&nbsp; &nbsp; 12.68157456405687&nbsp; &nbsp; &nbsp;6.99612434170756<br />16.28001488882063&nbsp; &nbsp; 11.30329858626045&nbsp; &nbsp; &nbsp;6.99265482691192<br />14.91210592507385&nbsp; &nbsp; 10.86110781146765&nbsp; &nbsp; &nbsp;6.99071674837176<br />14.13078870987637&nbsp; &nbsp; 11.99535250594183&nbsp; &nbsp; &nbsp;6.99326588288911<br />9.88047357875540&nbsp; &nbsp; 12.00482853795923&nbsp; &nbsp; &nbsp;6.98882891763749<br />12.00192233673013&nbsp; &nbsp; &nbsp;9.96929220396100&nbsp; &nbsp; &nbsp;6.98329443280378<br />12.00837527590531&nbsp; &nbsp; 14.03130874233860&nbsp; &nbsp; &nbsp;6.99948340730862<br />15.20432290532285&nbsp; &nbsp; 15.22540747831387&nbsp; &nbsp; &nbsp;7.00200372856651<br />15.19313884171311&nbsp; &nbsp; &nbsp;8.76129846997055&nbsp; &nbsp; &nbsp;6.98744336798576<br />8.80561700326767&nbsp; &nbsp; &nbsp;8.77507783974137&nbsp; &nbsp; &nbsp;6.97949471039301<br />8.81771718378007&nbsp; &nbsp; 15.23885330665432&nbsp; &nbsp; &nbsp;6.99845713352080<br />13.37257765050554&nbsp; &nbsp; 17.11992092452597&nbsp; &nbsp; &nbsp;7.01033475042726<br />10.65751847151932&nbsp; &nbsp; 17.12561065649051&nbsp; &nbsp; &nbsp;7.00718932911153<br />17.14387397433472&nbsp; &nbsp; 13.34609132569375&nbsp; &nbsp; &nbsp;6.99830189384125<br />17.14042276570114&nbsp; &nbsp; 10.63682513020204&nbsp; &nbsp; &nbsp;6.99118969243677<br />13.35278112781582&nbsp; &nbsp; &nbsp;6.87498761980712&nbsp; &nbsp; &nbsp;6.97878434452385<br />10.63876867003055&nbsp; &nbsp; &nbsp;6.88026233515408&nbsp; &nbsp; &nbsp;6.97553810680641<br />6.87131218204644&nbsp; &nbsp; 13.36438702790796&nbsp; &nbsp; &nbsp;6.99316119368211<br />6.86695286671293&nbsp; &nbsp; 10.65501172582219&nbsp; &nbsp; &nbsp;6.98633580459881<br />10.90483155436783&nbsp; &nbsp; 12.00301405431957&nbsp; &nbsp; &nbsp;6.99005188546697<br />13.10645914541739&nbsp; &nbsp; 11.99653337020754&nbsp; &nbsp; &nbsp;6.99332769226049</code></pre></div><br /><br />Build ac file:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>enable_64bit_flags=&quot;yes&quot;<br />#enable_optim=&quot;yes&quot;<br />enable_debug=&quot;no&quot;<br />prefix=&quot;${HOME}/local&quot;<br /><br />CPP=&quot;$HOME/local/bin/cpp-4.6&quot;<br />CC=&quot;$HOME/local/bin/mpicc&quot;<br />#CFLAGS_OPTIM=&quot;-O3 -march=native&quot;<br />#C_LDFLAGS=&quot;-static-libgcc&quot;<br />CXX=&quot;$HOME/local/bin/mpicxx&quot;<br />#CXXFLAGS_OPTIM=&quot;-O3 -march=native&quot;<br />FC=&quot;$HOME/local/bin/mpif90&quot;<br />F77=&quot;$HOME/local/bin/mpif77&quot;<br />#FCFLAGS_DEBUG=&quot;-g -fopenmp&quot;<br />#FCFLAGS_OPTIM=&quot;-O3 -march=native -mtune=native -funroll-loops -floop-block -flto&quot;<br />#FC_LDFLAGS=&quot;-flto -static-libgfortran -static-libgcc&quot;<br />FC_LIBS_EXTRA=&quot;-lgomp&quot;<br /><br />#enable_stdin=&quot;no&quot;<br />#fcflags_opt_59_io_mpi=&quot;-O2&quot;<br />#fcflags_opt_51_manage_mpi=&quot;-O2&quot;<br /><br />enable_mpi=&quot;yes&quot;<br />enable_mpi_io=&quot;yes&quot;<br />with_mpi_level=&quot;1&quot;<br />MPI_RUNNER=&quot;$HOME/local/bin/mpirun&quot;<br /><br />with_trio_flavor=&quot;netcdf+etsf_io&quot;<br />#with_etsf_io_incs=&quot;-I/opt/etsf/include&quot;<br />#with_etsf_io_libs=&quot;-L/opt/etsf/lib -letsf_io&quot;<br />#with_netcdf_incs=&quot;-I/usr/local/include/netcdf&quot;<br />#with_netcdf_libs=&quot;-L/usr/local/lib/netcdf -lnetcdff -lnetcdf&quot;<br /><br />with_fft_flavor=&quot;fftw3&quot;<br />with_fft_incs=&quot;-I$HOME/local/include&quot;<br />with_fft_libs=&quot;-L$HOME/local/lib -lfftw3&quot;<br /><br />with_linalg_flavor=&quot;custom&quot;<br />with_linalg_incs=&quot;-I$HOME/local/include&quot;<br />with_linalg_libs=&quot;-L$HOME/local/lib -lopenblas&quot;<br /><br />with_dft_flavor=&quot;atompaw+libxc+wannier90&quot;<br /><br />with_libxc_incs=&quot;-I$HOME/local/include&quot;<br />with_libxc_libs=&quot;-L$HOME/local/lib -lxc&quot;<br /><br />#enable_fallbacks=&quot;no&quot;<br /><br />#enable_gw_cutoff=&quot;yes&quot;<br />enable_gw_dpc=&quot;yes&quot;<br />enable_gw_openmp=&quot;yes&quot;<br />#enable_gw_optimal=&quot;yes&quot;<br />#enable_gw_wrapper=&quot;yes&quot;<br />enable_smp=&quot;yes&quot;<br /><br />enable_fast_check=&quot;yes&quot;</code></pre></div><br /><br />Jobscript&#058;<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>#!/bin/bash<br /><br />#PBS -S /bin/bash<br />#PBS -N porphin-ORB1<br />#PBS -l nodes=2:ppn=8,walltime=04:00:00,pmem=4000MB<br />#PBS -joe<br />#PBS -V<br /><br />EXTRA_FILES=<br />ABINIT=$HOME/test/bin/abinit<br />MPIEXEC=&quot;$HOME/local/bin/mpiexec-osc&quot;<br />#export LD_LIBRARY_PATH=$HOME/test/lib64:$HOME/test/lib:$LD_LIBRARY_PATH<br /><br />cd $PBS_O_WORKDIR<br /><br /><br /># Temporary directory<br />export TMPDIR=&quot;$HOME/ASync002_scratch&quot;<br /># Work directory<br />export WORKDIR=&quot;$HOME/ASync002_scratch/${PBS_JOBID}-abinit-${PBS_JOBNAME}&quot;<br />mkdir $WORKDIR<br /><br /># Copy ab.files and the input file into the work directory and go there.<br />cp ab.files *.in $EXTRA_FILES $WORKDIR<br />cd $WORKDIR<br /><br /># Modify ab.files so that the tmp files are always local - PBS<br /># or mpiexec creates a directory /tmp/$PBS_JOBID on each node.<br />sed -i &quot;s_&gt;REPLACE&lt;_/tmp/${PBS_JOBID}/tmp_&quot; ab.files<br /><br /># Make sure we explicitly set OMP_NUM_THREADS or who knows<br /># what OpenMP nightmares will happen.<br />export OMP_NUM_THREADS=1<br /><br /># Get our nodefile and write it to this directory for reference.<br />cp $PBS_NODEFILE .<br /><br /># Now run (hopefully PBS gives us the right nodes!)<br />$MPIEXEC $ABINIT &lt; ab.files &gt;&amp; log<br /><br /># Move the job folder to the original submission dir.<br />cd ..<br />mv $WORKDIR $PBS_O_WORKDIR</code></pre></div></div>
			
			
			
									
									<div id="sig4947" class="signature">Dr Kane O'Donnell<br />Postdoctoral Research Fellow<br />Australian Synchrotron</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p4964" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4964">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlistaf78.html?mode=viewprofile&amp;u=209" class="username">kaneod</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search66ac.html?author_id=209&amp;sr=posts">42</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 10, 2010 11:47 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4964">

						<h3 ><a href="#p4964">Re: Abinit 6.12.2 hanging on WFK write with MPI-IO</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting1204.html?mode=quote&amp;f=9&amp;p=4964" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic4539.html?p=4964#p4964" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistaf78.html?mode=viewprofile&amp;u=209" class="username">kaneod</a></strong> &raquo; </span>Thu Mar 29, 2012 2:52 am
			</p>
			
			
			
			<div class="content">Well, I'll do a self-response on this: it seems that even with paral_kgb=1, where the code complains that I shouldn't be able to do input/output, I get proper WFK files by compiling abinit without MPI-IO. So for now, I'm just running without it. Performance isn't too bad.<br /><br />...<br /><br />I'm sorry I can't shed more light on this as there do seem to be some problems writing WFK files in a variety of circumstances (do a WFK search on the forums) and they don't seem to be solved in 6.12.2 for some people. Is there anything the developers would like me to do to help check this in more detail?<br /><br />Kane</div>
			
			
			
									
									<div id="sig4964" class="signature">Dr Kane O'Donnell<br />Postdoctoral Research Fellow<br />Australian Synchrotron</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting5514.html?mode=reply&amp;f=9&amp;t=1584" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic7b1b.html?f=9&amp;t=1584&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://forum.abinit.org/viewtopic.php?f=9&amp;t=1584">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			2 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforumfdc5.html?f=9" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Ground state”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforumffeb.html?f=20" class="jumpbox-forum-link"> <span> News &amp; Announcements</span></a></li>
																<li><a href="viewforum8011.html?f=23" class="jumpbox-forum-link"> <span> Jobs and Other Announcements</span></a></li>
																<li><a href="viewforum58da.html?f=1" class="jumpbox-cat-link"> <span> Building ABINIT</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Configuring and compiling ABINIT</span></a></li>
																<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> Running Abinit</span></a></li>
																<li><a href="viewforumfdc5.html?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Ground state</span></a></li>
																<li><a href="viewforum15ca.html?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Response calculations</span></a></li>
																<li><a href="viewforum8a83.html?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Many-body perturbation theory</span></a></li>
																<li><a href="viewforum01c9.html?f=12" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Other tools and postprocessing in ABINIT</span></a></li>
																<li><a href="viewforum345c.html?f=24" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Python interfacing : Abipy ecosystem</span></a></li>
																<li><a href="viewforum9780.html?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Link to other codes</span></a></li>
																<li><a href="viewforume774.html?f=5" class="jumpbox-cat-link"> <span> Developing Abinit</span></a></li>
																<li><a href="viewforum218b.html?f=19" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Improving ABINIT</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar navbar-bottom" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
				
		<li class="rightside" data-last-responsive="true"><a href="app.php/aboutus.html" role="menuitem"><i class="icon fa-info-circle fa-fw" aria-hidden="true"></i><span>About us</span></a></li>			</ul>

	</div>
</div>

	<div class="copyright">
		<script type="text/javascript">
copyright=new Date();

update=copyright.getFullYear();

document.write("Copyright\u0020\u0026copy\u003B 2009 - "+ update +	" ABINIT Discussion Forums All\u0020rights\u0020reserved.");

</script>
<br /><br />		<p class="footer-row">
			<span class="footer-copyright">Flat Style by <a href="http://phpbbstyles.oo.gd/">Ian Bradley</a></span>
		</p>
        <p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row">
			<a class="footer-link" href="ucp4d86.html?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="ucp226b.html?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="assets/javascript/jquery.minaea1.js?assets_version=57"></script>
<script src="assets/javascript/coreaea1.js?assets_version=57"></script>



<script>
	(function() {
		var cx = '017804512478788106347\u003Atlftx8kncg4';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//cse.google.com/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	})();
</script>
<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="ext/hifikabin/clock/styles/all/template/js/js_clockaea1.js?assets_version=57"></script>
<script src="ext/phpbb/collapsiblecategories/styles/all/template/js/collapsiblecategoriesaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/forum_fnaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/ajaxaea1.js?assets_version=57"></script>



</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1584 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:20:07 GMT -->
</html>
