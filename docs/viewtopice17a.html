<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1413&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:17:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; [solved] The result not converge</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>[solved] The result not converge</h2>
		<p><a href="viewtopic9b6b.html?f=9&amp;t=1413">https://forum.abinit.org/viewtopic.php?f=9&amp;t=1413</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>[solved] The result not converge</h3>
				<div class="date">Posted: <strong>Mon Nov 14, 2011 2:45 pm</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Hiï¼Œ<br />I want to optimizae the supercell of  BaTiO3, but it does not converge and I set the  nstep 200. Can someone help me ?<br />And this is the .in file:<br /><br />occopt 4<br />tsmear 0.04<br />acell 7.7833429999E+00  7.7833429999E+00  7.7833429999E+00 <br />rprim 4.5  0  0<br />      0  sqrt(2)  0<br />      0  0  sqrt(2)<br />ntypat  3<br />znucl   56 22 8<br />natom  14<br />typat  1 1 1 1 2 2 3 3 3 3 3 3 3 3 <br /> xangst   0.000000000    0.000000000    0.000000000 <br />         0.000000000    2.821858368    2.834698466 <br />         3.999800000    0.000000000    0.000000000 <br />         3.999800000    2.821858368    2.834698466 <br />         1.999900000    2.834727678    0.000000000 <br />         1.999900000   -0.012869310    2.834698466 <br />         1.999900000    1.410929184    1.417349233 <br />         1.999900000    4.232787552    4.252047698 <br />         1.999900000    4.245656862    1.417349233 <br />         1.999900000    1.398059874    4.252047698 <br />         0.000000000    2.834727678    0.000000000 <br />         0.000000000   -0.012869310    2.834698466 <br />         3.999800000    2.834727678    0.000000000 <br />         3.999800000   -0.012869310    2.834698466 <br />ecut 52   <br />ixc  -101130<br />ionmov  3<br />dilatmx  1.1<br />ntime  200<br />ecutsm  0.5<br />ngkpt  1 8 8<br />nshiftk 1<br />shiftk  0.5 0.5 0.5<br />nstep 200<br />toldfe 1.0d-5<br /><br />Do I need to modify some parameters?  or if some parameter I set  is error ? <br />thank you .</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Thu Nov 24, 2011 6:55 pm</strong></div>
				<div class="author">by <strong>jolafc</strong></div>
				<div class="content">Hi Paul,<br /><br />There could be several things at fault in the parameters. To properly diagnose the problem, it would be very useful if you posted your .log file. Then, I could suggest relevant solutions.<br /><br />Jonathan</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Sat Nov 26, 2011 4:10 pm</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear Jonathan,<br />I want to upload the log file, but it notices <span style="color: #FF0000">The extension is not allowed</span><br />why is it ?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Sun Nov 27, 2011 5:44 pm</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello,<br /><br />This is because the log file might be several Mbytes therefore it is forbidden to upload it. In any case, you can put post important parts of your log and out files so that we can help you.<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Mon Nov 28, 2011 2:30 am</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear David,<br />The log file is just about 100 Kb, and it is forbidden to upload it either. Can I have your email to ask for your advice in private? <br />My email is <!-- e --><a href="mailto:gechaoyi@tju.edu.cn">gechaoyi@tju.edu.cn</a><!-- e -->, also you can give me a mail, then I pass the files to you. Thanks ~</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Mon Nov 28, 2011 10:18 am</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello again,<br /><br />If the file is small then just change it's name to something.out or something.in, so that you can upload it.<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Mon Nov 28, 2011 3:44 pm</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear David,<br />I upload the .out and the log files , it has run for 2 days and doesnot complete still, I hope for your help deeply.<br />In addition, because it needs too long time and it doesnot converge, I want to use the PAW pseudopotentials instead of <br />the Norm-conserving pseudopotentials, but it aslo has some errors. Can you help me for this ? <br />Please see the topic <span style="color: #FF0040">Ultra-soft pseudopotentials and atom relaxation </span>in the module of Input file.<br />Thanks~</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Mon Nov 28, 2011 6:16 pm</strong></div>
				<div class="author">by <strong>jolafc</strong></div>
				<div class="content">Hi Paul,<br /><br />I see you use <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>dilatmx 1.1<br />ecutsm 0.5</code></pre></div><br />in your input file while you don't do any optimization of the primitive cell (optcell not present). I commented those, but they shouldn't be the source of the problem. <br /><br />I successfully made a few steps that converged fast:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>bouboule:2011_11 jonathan$ grep ETOT BaTiO3.log<br />&nbsp;ETOT&nbsp; 1&nbsp; -112.60374535991&nbsp; &nbsp; -1.126E+02 2.078E-02 2.006E+04<br />&nbsp;ETOT&nbsp; 2&nbsp; -123.63343433268&nbsp; &nbsp; -1.103E+01 5.391E-03 2.068E+03<br />&nbsp;ETOT&nbsp; 3&nbsp; -125.14748656741&nbsp; &nbsp; -1.514E+00 5.247E-03 1.027E+03<br />&nbsp;ETOT&nbsp; 4&nbsp; -125.29445939553&nbsp; &nbsp; -1.470E-01 1.330E-03 6.844E+02<br />&nbsp;ETOT&nbsp; 5&nbsp; -125.36533525844&nbsp; &nbsp; -7.088E-02 4.740E-04 4.760E+02<br />&nbsp;ETOT&nbsp; 6&nbsp; -125.42525980409&nbsp; &nbsp; -5.992E-02 8.805E-04 2.661E+02<br />&nbsp;ETOT&nbsp; 7&nbsp; -125.43849883981&nbsp; &nbsp; -1.324E-02 9.290E-04 2.038E+02<br />&nbsp;ETOT&nbsp; 8&nbsp; -125.45006167018&nbsp; &nbsp; -1.156E-02 6.069E-04 1.376E+02<br />&nbsp;ETOT&nbsp; 9&nbsp; -125.45438270799&nbsp; &nbsp; -4.321E-03 5.971E-04 1.068E+02<br />&nbsp;ETOT 10&nbsp; -125.45954981144&nbsp; &nbsp; -5.167E-03 1.731E-04 6.220E+01<br />&nbsp;ETOT 11&nbsp; -125.45953006497&nbsp; &nbsp; &nbsp;1.975E-05 1.014E-04 6.189E+01<br />&nbsp;ETOT 12&nbsp; -125.46004301979&nbsp; &nbsp; -5.130E-04 1.508E-04 4.731E+01<br />&nbsp;ETOT 13&nbsp; -125.46040431126&nbsp; &nbsp; -3.613E-04 1.851E-04 4.161E+01<br />&nbsp;ETOT 14&nbsp; -125.46060120620&nbsp; &nbsp; -1.969E-04 2.211E-04 3.737E+01<br />&nbsp;ETOT 15&nbsp; -125.46152462528&nbsp; &nbsp; -9.234E-04 1.734E-03 9.689E+00<br />&nbsp;ETOT 16&nbsp; -125.46146205522&nbsp; &nbsp; &nbsp;6.257E-05 2.383E-04 1.277E+01<br />&nbsp;ETOT 17&nbsp; -125.46145079391&nbsp; &nbsp; &nbsp;1.126E-05 2.293E-04 1.355E+01<br />&nbsp;ETOT 18&nbsp; -125.46145281115&nbsp; &nbsp; -2.017E-06 3.603E-05 1.352E+01<br />&nbsp;ETOT 19&nbsp; -125.46150207767&nbsp; &nbsp; -4.927E-05 6.104E-05 1.179E+01<br />&nbsp;ETOT 20&nbsp; -125.46119776583&nbsp; &nbsp; &nbsp;3.043E-04 8.262E-06 1.946E+01<br />&nbsp;ETOT 21&nbsp; -125.46122475197&nbsp; &nbsp; -2.699E-05 8.762E-06 1.779E+01<br />&nbsp;ETOT 22&nbsp; -125.46148875422&nbsp; &nbsp; -2.640E-04 6.893E-06 6.763E+00<br />&nbsp;ETOT 23&nbsp; -125.46142775084&nbsp; &nbsp; &nbsp;6.100E-05 1.953E-06 8.949E+00<br />&nbsp;ETOT 24&nbsp; -125.46164592060&nbsp; &nbsp; -2.182E-04 1.152E-05 4.948E-01<br />&nbsp;ETOT 25&nbsp; -125.46165329231&nbsp; &nbsp; -7.372E-06 9.214E-05 2.994E-01<br />&nbsp;ETOT 26&nbsp; -125.46164998431&nbsp; &nbsp; &nbsp;3.308E-06 6.238E-05 3.672E-01<br />&nbsp;ETOT&nbsp; 1&nbsp; -123.91411546787&nbsp; &nbsp; -1.239E+02 6.416E-03 6.581E+03<br />&nbsp;ETOT&nbsp; 2&nbsp; -125.54475962425&nbsp; &nbsp; -1.631E+00 2.064E-03 8.114E+01<br />&nbsp;ETOT&nbsp; 3&nbsp; -125.56275333421&nbsp; &nbsp; -1.799E-02 3.241E-04 1.460E+02<br />&nbsp;ETOT&nbsp; 4&nbsp; -125.56941224975&nbsp; &nbsp; -6.659E-03 1.010E-04 1.038E+02<br />&nbsp;ETOT&nbsp; 5&nbsp; -125.57574593925&nbsp; &nbsp; -6.334E-03 1.781E-05 6.633E+01<br />&nbsp;ETOT&nbsp; 6&nbsp; -125.57645246190&nbsp; &nbsp; -7.065E-04 1.201E-05 5.915E+01<br />&nbsp;ETOT&nbsp; 7&nbsp; -125.57708651923&nbsp; &nbsp; -6.341E-04 2.311E-06 5.227E+01<br />&nbsp;ETOT&nbsp; 8&nbsp; -125.57875529243&nbsp; &nbsp; -1.669E-03 5.074E-06 3.303E+01<br />&nbsp;ETOT&nbsp; 9&nbsp; -125.57895039385&nbsp; &nbsp; -1.951E-04 1.460E-05 3.057E+01<br />&nbsp;ETOT 10&nbsp; -125.57958988972&nbsp; &nbsp; -6.395E-04 2.900E-06 2.087E+01<br />&nbsp;ETOT 11&nbsp; -125.57973054685&nbsp; &nbsp; -1.407E-04 1.013E-05 1.872E+01<br />&nbsp;ETOT 12&nbsp; -125.57983348795&nbsp; &nbsp; -1.029E-04 3.255E-06 1.637E+01<br />&nbsp;ETOT 13&nbsp; -125.58023185132&nbsp; &nbsp; -3.984E-04 1.872E-05 7.234E+00<br />&nbsp;ETOT 14&nbsp; -125.58026532067&nbsp; &nbsp; -3.347E-05 6.613E-05 6.544E+00<br />&nbsp;ETOT 15&nbsp; -125.58021194799&nbsp; &nbsp; &nbsp;5.337E-05 1.253E-05 7.491E+00<br />&nbsp;ETOT 16&nbsp; -125.58023907334&nbsp; &nbsp; -2.713E-05 4.108E-05 5.928E+00<br />&nbsp;ETOT 17&nbsp; -125.58030026297&nbsp; &nbsp; -6.119E-05 1.405E-05 4.095E+00<br />&nbsp;ETOT 18&nbsp; -125.58024874653&nbsp; &nbsp; &nbsp;5.152E-05 5.184E-06 5.199E+00<br />&nbsp;ETOT 19&nbsp; -125.58032180929&nbsp; &nbsp; -7.306E-05 2.084E-05 2.495E+00<br />&nbsp;ETOT 20&nbsp; -125.58035693574&nbsp; &nbsp; -3.513E-05 4.463E-05 1.262E+00<br />&nbsp;ETOT 21&nbsp; -125.58036563921&nbsp; &nbsp; -8.703E-06 1.462E-05 8.788E-01<br />&nbsp;ETOT 22&nbsp; -125.58037870730&nbsp; &nbsp; -1.307E-05 8.238E-05 1.787E-01<br />&nbsp;ETOT 23&nbsp; -125.58037809589&nbsp; &nbsp; &nbsp;6.114E-07 4.511E-06 2.065E-01<br />&nbsp;ETOT 24&nbsp; -125.58038070184&nbsp; &nbsp; -2.606E-06 2.099E-05 5.149E-02</code></pre></div><br /><br />With the following input file:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>occopt 4<br />tsmear 0.04<br />acell 7.7833429999E+00 7.7833429999E+00 7.7833429999E+00<br />rprim 4.5 0 0<br />0 sqrt(2) 0<br />0 0 sqrt(2)<br />ntypat 3<br />znucl 56 22 8<br />natom 14<br />typat 1 1 1 1 2 2 3 3 3 3 3 3 3 3<br />xangst 0.000000000 0.000000000 0.000000000<br />0.000000000 2.821858368 2.834698466<br />3.999800000 0.000000000 0.000000000<br />3.999800000 2.821858368 2.834698466<br />1.999900000 2.834727678 0.000000000<br />1.999900000 -0.012869310 2.834698466<br />1.999900000 1.410929184 1.417349233<br />1.999900000 4.232787552 4.252047698<br />1.999900000 4.245656862 1.417349233<br />1.999900000 1.398059874 4.252047698<br />0.000000000 2.834727678 0.000000000<br />0.000000000 -0.012869310 2.834698466<br />3.999800000 2.834727678 0.000000000<br />3.999800000 -0.012869310 2.834698466<br />ecut 5&nbsp; #52<br />ixc 11 #-101130<br />ionmov 3<br />#dilatmx 1.1<br />ntime 200<br />#ecutsm 0.5<br />ngkpt 1 2 2 #1 8 8<br />nshiftk 1<br />shiftk 0.5 0.5 0.5&nbsp; <br />nstep 200<br />toldfe 1.0d-5</code></pre></div><br /><br />Which basically differs from yours by a (too much) reduced ecut and ngkpt and a different functional (in my case, PBE). The reducing ecut and ngkpt, if anything, usually make the convergence poorer, so your values for these shouldn't be the problem. Therefore, it seems your problem rests in the choice of functional and/or the choice of pseudopotentials. For my test run, I used the GGA FHI pseudo potentials provided on the Abinit site :<br /><a href="http://www.abinit.org/downloads/psp-links/gga_fhi" class="postlink">http://www.abinit.org/downloads/psp-links/gga_fhi</a><br />I invite you to check the impact of the choice of alternates pseudos and functionals on the convergence of your calculation. By elimination, they must be the problem. I would personally begin by checking the pseudos, they appear to often be the source of the problem.<br /><br />Good luck,<br /><br />Jonathan</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Tue Nov 29, 2011 9:03 am</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear Jonathan,<br />Thanks a lot for your advice, and I am testing it using the GGA-PBE functional. <br />I am waiting the result and it looks like well until now. Thanks again, and your<br />advice solves the problem  bothering me several days.<br /><br /><br />Paul</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Thu Dec 01, 2011 9:57 am</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear Jonathan,<br /> I am so sorry that I have to touble you again. I take your advice to set the ixc 11, adopt  the GGA-PBE functional and the GGA FHI pseudo potentials,<br />but in the every step of TIM_DEN calculation it can converge well, however, the whole TIM_DEN  doesnot converge until it reaches 200 steps the ntime <br />sets 200. I really don't know what this is caused by, can you tell me?<br />In addition, there is another problem: the slab has 5 layers, and I fix the bulk atoms and relax the surfaces, however, the surface atoms are moving<br />so far that they are 10,000 times farther than the initial state in the result which it run 200 ntimes. This is my initial  atomic positions and final ones.<br />And the red ones are the relaxing atoms. What  makes it so?  <br /> inital<br />xangst   0.000000000    0.000000000   -0.000000000                              <br />         0.000000000    0.000000000    4.034483750 <br />         0.000000000    0.000000000    8.068967500 <br />         2.017241875    2.017256270    2.017241875 <br />         2.017241875    2.017256270    6.051725625 <br />         2.017241875    0.000000000    2.017241875 <br />         2.017241875    0.000000000    6.051725625 <br />         0.000000000    2.017256270    2.017241875 <br />         0.000000000    2.017256270    6.051725625 <br />         2.017241875    2.017256270   -0.000000000 <br />         2.017241875    2.017256270    4.034483750 <br />         2.017241875    2.017256270    8.068967500 <br />final    <br />  <span style="color: #FF0000">56     -4.0622193542E+01    1.6162404718E+02    1.6975396187E+03</span>    <br />      56     -1.0859882939E-11    1.5307361795E-12    4.0344837500E+00<br />     <span style="color: #FF0000"> 56     -4.0622193542E+01    1.6162404718E+02   -1.6894706512E+03</span>     <br />      22      2.0172418750E+00    2.0172562700E+00    2.0172418750E+00<br />      22      2.0172418750E+00    2.0172562700E+00    6.0517256250E+00<br />       8      2.0172418750E+00    1.5306126591E-12    2.0172418750E+00<br />       8      2.0172418750E+00    1.5308596999E-12    6.0517256250E+00<br />       8     -1.0860006459E-11    2.0172562700E+00    2.0172418750E+00<br />       8     -1.0859759418E-11    2.0172562700E+00    6.0517256250E+00<br />    <span style="color: #FF0000">   8     -6.0041420693E+01   -1.6075092406E+01    4.3391788423E+03</span>      <br />      8      2.0172418750E+00    2.0172562700E+00    4.0344837500E+00<br />      <span style="color: #FF0000"> 8     -6.0041420693E+01   -1.6075092406E+01   -4.3311098748E+03</span><br /><br /><br /><br /><br />Paul</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Thu Dec 01, 2011 7:12 pm</strong></div>
				<div class="author">by <strong>jolafc</strong></div>
				<div class="content">Yes, I've seen that kind of behavior before. To begin with, I notice you don't define explicitely the tolerance you want on the forces at the end of the relaxation (tolmxf). That's not the source of your current problem, since the default value of 5.0d-5 is reasonable, but you should write it down in your input just to remember it can be adjusted (loosened for tests, for instance). <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>tolmxf 5.0d-5</code></pre></div><br /><br />Now, I think the problem comes from that you set a tolerance on the total energy for the SCF cycles: <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>toldfe 1.0d-5</code></pre></div><br />which can correspond to a tolerance on the calculation of forces (toldff) much worse than the default valut for tolmxf. What this means is that the uncertainty on the calculated forces (toldff) is orders of magnitude worse than the maximum residual forces you want at the end of your relaxation (tolmxf). In that context, your atomic displacement in the relaxation will essentially be random. When Abinit sees this, it will eventually try to explore configurations far from the ones it has already tried, e.g. your system explodes, hence the absurd final coordinates you've obtained.  <br /><br />So, choose a tolmxf (default is fine) and replace your toldfe by a toldff about 50 times smaller than your tolmxf:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>tolmxf 5.0d-5<br />toldff 1.0d-6</code></pre></div><br /><br />Good luck,<br /><br />Jonathan</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Mon Dec 05, 2011 2:04 pm</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear Jonathan,<br />I modify the .in file as what you say, and the result is much better now, however the surface atoms is also 14 angstrom far away from the second layer.<br />I think it is unreasonable either. What's your opinion on this? <br /><br /><br /><br /><br />Paul</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Tue Dec 06, 2011 3:41 am</strong></div>
				<div class="author">by <strong>Paul</strong></div>
				<div class="content">Dear Jonathan,<br />I have known the reason because of the periodic boundary condition. And the atoms which is far away from the others are the next supercell surface.<br />Thank you for your recent help~<br /><br /><br />Paul</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: The result not converge</h3>
				<div class="date">Posted: <strong>Tue Dec 06, 2011 5:20 pm</strong></div>
				<div class="author">by <strong>jolafc</strong></div>
				<div class="content">Good luck with your calculations, then!<br /><br />Jonathan</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1413&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:17:20 GMT -->
</html>
