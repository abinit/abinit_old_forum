<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=96&hilit=prtkpt+1+kptrlen&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:51:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; problem with acell optimization</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>problem with acell optimization</h2>
		<p><a href="viewtopic5133.html?f=9&amp;t=96">https://forum.abinit.org/viewtopic.php?f=9&amp;t=96</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>problem with acell optimization</h3>
				<div class="date">Posted: <strong>Mon Mar 01, 2010 8:53 am</strong></div>
				<div class="author">by <strong>bmalvandi</strong></div>
				<div class="content">hello<br />I want to optimize the acell for LaCoO3 and my input variables are:<br /><br />Crystalline LaCoO3(cubic) : optimization of the lattice parameter<br /># at fixed number of k points and broadening.<br /><br />#Definition of occupation numbers<br />occopt 4<br />tsmear 0.05<br /><br />#Definition of the unit cell<br />acell 3*7.22           <br />rprim  <span class="posthilit">1</span>.0  0.0  0.0  <br />       0.0  <span class="posthilit">1</span>.0  0.0   <br />       0.0  0.0  <span class="posthilit">1</span>.0<br /><br />#Optimization of the lattice parameters<br /><br />optcell 2<br /><br />ionmov  3<br />ntime  10<br />dilatmx <span class="posthilit">1</span>.67<br />ecutsm  0.<span class="posthilit">1</span><br /><br />#Definition of the atom types<br />ntypat 3         <br />znucl 57 27 8     <br />                         <br /><br />#Definition of the atoms<br />natom 5          <br />typat <span class="posthilit">1</span> 2 3 3 3   <br />xred              <br />   0.0  0.0  0.0  <br />   0.5  0.5  0.5  <br />   0.5  0.5  0.0 <br />   0.5  0.0  0.5 <br />   0.0  0.5  0.5 <br />#Definition of the planewave basis set<br />ecut  80.0        <br /><br />#Exchange-correlation functional<br />ixc <span class="posthilit">1</span>            <br /><br />#Definition of the k-point grid<br />kptopt <span class="posthilit">1</span>         <br />ngkpt 2 2 2       <br />nshiftk 4        <br />shiftk 0.5 0.5 0.5<br />       0.5 0.0 0.0<br />       0.0 0.5 0.0<br />       0.0 0.0 0.5<br /><br />#Definition of the SCF procedure<br />nstep 65         <br />toldfe <span class="posthilit">1</span>.0d-6    <br /><br /><br />and the output is:<br /><br />*****************************************************************************************<br />   acell    7.9796344683E+00  7.9796344683E+00  7.9796344683E+00 Bohr<br />******************************************************************************************<br />       amu    <span class="posthilit">1</span>.38905500E+02  5.89332000E+01  <span class="posthilit">1</span>.59994000E+01<br />   dilatmx    <span class="posthilit">1</span>.67000000E+00<br />      ecut    8.00000000E+01 Hartree<br />    ecutsm    <span class="posthilit">1</span>.00000000E-01 Hartree<br />    etotal   -8.5460495699E+01<br />     fcart    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />    ionmov         3<br />       kpt   -2.50000000E-01  5.00000000E-01  0.00000000E+00<br />             -2.50000000E-01 -2.50000000E-01  2.50000000E-01<br />             -2.50000000E-01  0.00000000E+00  0.00000000E+00<br />              5.00000000E-01  5.00000000E-01  2.50000000E-01<br />   <span class="posthilit">kptrlen</span>    2.50108137E+01<br />    kptopt         <span class="posthilit">1</span><br />  kptrlatt    2 -2  2  -2  2  2  -2 -2  2<br />P    mkmem         4<br />     natom         5<br />     nband        18<br />     ngfft       100     100     100<br />      nkpt         4<br />     nstep        65<br />      nsym        48<br />     ntime        10<br />    ntypat         3<br />       occ    2.000000  2.000000  2.000000  2.000020  2.000823  2.001087<br />              2.003521  2.022750  2.078934  2.085045  2.119327  2.102803<br />              <span class="posthilit">1</span>.691270  <span class="posthilit">1</span>.445309  <span class="posthilit">1</span>.343083  <span class="posthilit">1</span>.276361  0.014275  0.000262<br />              2.000000  2.000000  2.000000  2.000026  2.001194  2.001194<br />              2.006711  2.011883  2.011883  2.140209  2.140209  2.058666<br />              <span class="posthilit">1</span>.676373  <span class="posthilit">1</span>.567475  <span class="posthilit">1</span>.567475  0.147884  0.147884  0.001153<br />              2.000000  2.000000  2.000000  2.000324  2.001960  2.001960<br />              2.076777  2.076777  2.093798  2.110762  2.117024  2.113831<br />              2.113831  <span class="posthilit">1</span>.901386  <span class="posthilit">1</span>.575779  <span class="posthilit">1</span>.575779  0.816844  0.000445<br />              2.000000  2.000000  2.000000  2.000001  2.000441  2.000661<br />              2.001520  2.004844  2.004844  2.098822  2.098822  <span class="posthilit">1</span>.784954<br />              <span class="posthilit">1</span>.237877  <span class="posthilit">1</span>.214865  <span class="posthilit">1</span>.214865  0.078236  0.001528  0.003746<br />    occopt         4<br />   optcell         2<br />    shiftk    5.00000000E-01  5.00000000E-01  5.00000000E-01<br />   spgroup       221<br />    strten    8.9648558286E-06  8.9648558892E-06  8.9648558684E-06<br />              0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />    symrel    <span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>      -<span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span><br />             -<span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>       <span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span><br />             -<span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>       <span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span><br />              <span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>      -<span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span><br />              0  <span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>       0 -<span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span><br />              0 -<span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>       0  <span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span><br />              0 -<span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>       0  <span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span><br />              0  <span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>       0 -<span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span><br />              0  0  <span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0       0  0 -<span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0<br />              0  0 -<span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0       0  0  <span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0<br />              0  0 -<span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0       0  0  <span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0<br />              0  0  <span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0   0 -<span class="posthilit">1</span>  0       0  0 -<span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0   0  <span class="posthilit">1</span>  0<br />              <span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0      -<span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0<br />             -<span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0       <span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0<br />             -<span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0       <span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0<br />              <span class="posthilit">1</span>  0  0   0  0 -<span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0      -<span class="posthilit">1</span>  0  0   0  0  <span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0<br />              0  <span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0       0 -<span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0<br />              0 -<span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0       0  <span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0<br />              0 -<span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0       0  <span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0<br />              0  <span class="posthilit">1</span>  0   0  0 -<span class="posthilit">1</span>  -<span class="posthilit">1</span>  0  0       0 -<span class="posthilit">1</span>  0   0  0  <span class="posthilit">1</span>   <span class="posthilit">1</span>  0  0<br />              0  0  <span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0       0  0 -<span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0<br />              0  0 -<span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0       0  0  <span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0<br />              0  0 -<span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0       0  0  <span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0<br />              0  0  <span class="posthilit">1</span>   0 -<span class="posthilit">1</span>  0  -<span class="posthilit">1</span>  0  0       0  0 -<span class="posthilit">1</span>   0  <span class="posthilit">1</span>  0   <span class="posthilit">1</span>  0  0<br />    toldfe    <span class="posthilit">1</span>.00000000E-06 Hartree<br />    tsmear    5.00000000E-02 Hartree<br />     typat    <span class="posthilit">1</span>  2  3  3  3<br />       wtk      0.37500    0.25000    0.18750    0.18750<br />    xangst    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              2.1113203556E+00  2.1113203556E+00  2.1113203556E+00<br />              2.1113203556E+00  2.1113203556E+00  0.0000000000E+00<br />              2.1113203556E+00  0.0000000000E+00  2.1113203556E+00<br />              0.0000000000E+00  2.1113203556E+00  2.1113203556E+00<br />     xcart    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              3.9898172341E+00  3.9898172341E+00  3.9898172341E+00<br />              3.9898172341E+00  3.9898172341E+00  0.0000000000E+00<br />              3.9898172341E+00  0.0000000000E+00  3.9898172341E+00<br />              0.0000000000E+00  3.9898172341E+00  3.9898172341E+00<br />      xred    0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />              5.0000000000E-01  5.0000000000E-01  5.0000000000E-01<br />              5.0000000000E-01  5.0000000000E-01  0.0000000000E+00<br />              5.0000000000E-01  0.0000000000E+00  5.0000000000E-01<br />              0.0000000000E+00  5.0000000000E-01  5.0000000000E-01<br />     znucl     57.00000   27.00000    8.00000<br /><br /><br /><br />I think acell differs a lot !!!!!! <br />what must I do?<br /><br />thanks</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: problem with acell optimization</h3>
				<div class="date">Posted: <strong>Mon Mar 01, 2010 5:01 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">Some suggestions:<br /><br /><span class="posthilit">1</span>) your ecut is really high, what pseudopotentials are you using? You could do this with PAW with an ecut of 15 or maybe less.<br /><br />2) Your kpt set is very small, what is <span class="posthilit">kptrlen</span> in the output file? To get stresses accurately is not easy, you probably need a bigger kpt set (bigger ngkpt).<br /><br />3) Your nshiftk and shiftk are appropriate for an FCC structure but I don't think are a good choice for a primitive cubic structure like this.<br /><br />To solve <span class="posthilit">1</span>, switch to PAW.<br /><br />To solve 2 and 3, remove nshiftk and shiftk from your input, set <span class="posthilit">prtkpt</span> <span class="posthilit">1</span>, and set <span class="posthilit">kptrlen</span> to 40. It will give you suggested kptrlatt that are suitable for your structure and that have <span class="posthilit">kptrlen</span> of 40, a good starting point for convergence studies. Then re-run with <span class="posthilit">prtkpt</span> 0 and kptrlatt at your new value. Do all this before you start optimizing anything.<br /><br />Once you can compute the pressure (stress) of the input structure accurately, then start optimizing acell.<br /><br />Also, what is the magnetic behavior of your sample? I bet it's not trivial but you are forcing it to be  diamagnetic (nsppol <span class="posthilit">1</span> is the default and you haven't changed it in your input). If you haven't already done so, do the tutorials on spin.<br /><br />Good luck!<br /><br />Joe</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: problem with acell optimization</h3>
				<div class="date">Posted: <strong>Mon Mar 01, 2010 5:02 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">One more think I forgot: when you run with <span class="posthilit">prtkpt</span> <span class="posthilit">1</span> and <span class="posthilit">kptrlen</span> 40, also remove ngkpt. Later when you add the kpt mesh back in, add it as kptrlatt only using the output from <span class="posthilit">prtkpt</span> <span class="posthilit">1</span>.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=96&hilit=prtkpt+1+kptrlen&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:51:34 GMT -->
</html>
