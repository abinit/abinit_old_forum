<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=3649&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 20:28:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; BSE Tutorial + LDA+U</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>BSE Tutorial + LDA+U</h2>
		<p><a href="viewtopice57a.html?f=11&amp;t=3649">https://forum.abinit.org/viewtopic.php?f=11&amp;t=3649</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>BSE Tutorial + LDA+U</h3>
				<div class="date">Posted: <strong>Fri Jul 21, 2017 4:04 am</strong></div>
				<div class="author">by <strong>cennanaradipa</strong></div>
				<div class="content">Dear All,<br /><br />I'm currently doing BSE calculation with bs_coulom_term = 0 (RPA), so I've set up the gamma_WFK and shifted_WFK file as recommended by the tutorial and changed just that input variable.<br /><br />My calculation stopped by an error<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>--- !ERROR<br />src_file: bethe_salpeter.F90<br />src_line: 386<br />mpi_rank: 3<br />message: |<br />&nbsp; &nbsp; BS equation with LDA+U not completely coded<br />...</code></pre></div>  <br /><br />I am using LDA+U, but if I turn off the LDA+U in the BSE equation, will that affect my result or will it be (as expected) showing the dielectric function of my material with LDA+U?<br /><br />Here's my full input file (the commented ones are previous runs):<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># ---------------------------------------- <br /># INPUTS COMMON TO ALL DATASETS<br /># ---------------------------------------- <br /><br />#ndtset 3<br />autoparal 0<br />paral_kgb 0<br /><br /># Structural&nbsp; Parameters<br />ntypat&nbsp; &nbsp; &nbsp;3<br />znucl&nbsp; &nbsp; &nbsp; 57 29 8<br />natom&nbsp; &nbsp; &nbsp; 14<br />typat&nbsp; &nbsp; &nbsp; 1 1 1 1 2 2 3 3 3 3 3 3 3 3<br />acell&nbsp; &nbsp; &nbsp; 3*3.808 Angstrom<br />chkprim&nbsp; &nbsp; 0<br />rprim<br />&nbsp; 1.0&nbsp; 0.000&nbsp; 0.000<br />&nbsp; 0.000&nbsp; 1.0&nbsp; 0.000<br />&nbsp; 0.000&nbsp; 0.000&nbsp; 3.45851<br />xred 0.500000 0.500000 0.138998<br />&nbsp; &nbsp; &nbsp;0.000000 0.000000 0.361002<br />&nbsp; &nbsp; &nbsp;0.000000 0.000000 0.638998<br />&nbsp; &nbsp; &nbsp;0.500000 0.500000 0.861002<br />&nbsp; &nbsp; &nbsp;0.000000 0.000000 0.000000<br />&nbsp; &nbsp; &nbsp;0.500000 0.500000 0.500000<br />&nbsp; &nbsp; &nbsp;0.500000 0.500000 0.313883<br />&nbsp; &nbsp; &nbsp;0.000000 0.000000 0.186117<br />&nbsp; &nbsp; &nbsp;0.000000 0.500000 0.000000<br />&nbsp; &nbsp; &nbsp;0.500000 0.000000 0.000000<br />&nbsp; &nbsp; &nbsp;0.000000 0.000000 0.813883<br />&nbsp; &nbsp; &nbsp;0.500000 0.500000 0.686117<br />&nbsp; &nbsp; &nbsp;0.500000 0.000000 0.500000<br />&nbsp; &nbsp; &nbsp;0.000000 0.500000 0.500000<br /><br /># Spins on atoms<br />spinat 0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0 -1.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 1.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 0.0<br />nspinor 1<br />nsppol&nbsp; 1<br />nspden&nbsp; 2<br /><br /># Convergence parameters<br />nstep&nbsp; &nbsp; &nbsp; 125<br />ecut&nbsp; &nbsp; &nbsp; &nbsp;40<br />ecutsm&nbsp; &nbsp; &nbsp;0.5<br />pawecutdg&nbsp; 90<br />pawovlp&nbsp; &nbsp; 10<br /><br /># GGA-PBE + U (1=FLL, 2=AMF)<br />usepawu&nbsp; &nbsp; 1<br />lpawu&nbsp; &nbsp; &nbsp; -1 2 -1<br />upawu&nbsp; &nbsp; &nbsp; 0.0 8.8 0.0 eV<br />jpawu&nbsp; &nbsp; &nbsp; 0.0 0.8 0.0 eV<br /><br /># K-points<br />ngkpt&nbsp; &nbsp; &nbsp; 8 8 8<br />nshiftk&nbsp; &nbsp; 1<br />#shiftk&nbsp; &nbsp; &nbsp;0.0 0.0 0.0<br /><br />kptopt&nbsp; &nbsp; &nbsp;1<br />istwfk&nbsp; &nbsp; *1<br />ixc&nbsp; &nbsp; &nbsp; &nbsp;-101130<br />occopt&nbsp; &nbsp; &nbsp;4<br />diemac&nbsp; &nbsp; &nbsp;2<br />tsmear&nbsp; &nbsp; &nbsp;0.005<br /><br /># ---------------------------------------- <br /># DATASETS<br /># ---------------------------------------- <br /><br />## Dataset 1: Ground State (SCF calculation)<br />#<br />#&nbsp; iscf1&nbsp; &nbsp; 17 <br />#tolvrs1&nbsp; &nbsp; 1.d-8<br /># nband1&nbsp; &nbsp; 96<br />#prtden1&nbsp; &nbsp; 1<br />#<br />## Dataset 2: Creation of WFK file on the symmetric k-mesh<br />#&nbsp; iscf2&nbsp; &nbsp;-2<br />#getden2&nbsp; &nbsp; 1<br /># nband2&nbsp; &nbsp; 197<br />#nbdbuf2&nbsp; &nbsp; 5<br />#tolwfr2&nbsp; &nbsp; 1.0d-8<br />#<br />## Dataset 3: Creation of WFK file on shifted k-mesh to break symmetry<br />#&nbsp; &nbsp; &nbsp; &nbsp;iscf3&nbsp; &nbsp; -2<br />#&nbsp; &nbsp; &nbsp;getden3&nbsp; &nbsp; &nbsp;1<br />#&nbsp; &nbsp; &nbsp; nband3&nbsp; &nbsp; &nbsp;101&nbsp; &nbsp; &nbsp; &nbsp;# reduced nband because this WFK is for transition<br />#&nbsp; &nbsp; &nbsp;tolwfr3&nbsp; &nbsp; &nbsp;1.0d-8<br />#&nbsp; &nbsp; &nbsp;nbdbuf3&nbsp; &nbsp; &nbsp;5<br />#chksymbreak3&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # skip check here<br />#&nbsp; &nbsp; &nbsp;shiftk3&nbsp; &nbsp; &nbsp;0.11&nbsp; 0.21&nbsp; 0.31&nbsp; &nbsp; &nbsp; &nbsp;# breaks symmetry for k-mesh <br /><br />## Dataset 4: Creation of the screening (eps^{-1}) matrix (WFK not shifted file) <br />#optdriver&nbsp; &nbsp; 3<br />#&nbsp; &nbsp;gwpara&nbsp; &nbsp; 2<br />#&nbsp; inclvkb&nbsp; &nbsp; 2<br />#&nbsp; &nbsp; &nbsp;awtr&nbsp; &nbsp; 1<br />#&nbsp; &nbsp;irdwfk&nbsp; &nbsp; 1<br />#&nbsp; ecuteps&nbsp; &nbsp; 8<br />#&nbsp; ecutwfn&nbsp; &nbsp; 20<br />#&nbsp; &nbsp; nband&nbsp; &nbsp; 250&nbsp; &nbsp; &nbsp; &nbsp;# check gw tutorial 1<br />#&nbsp; nfreqre&nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# only static limit needed for BSE<br />#&nbsp; nfreqim&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# idem, <br />##&nbsp; &nbsp; &nbsp;zcut4&nbsp; &nbsp; 0.005<br />##freqremax4&nbsp; &nbsp; 0.45<br />##gwcalctyp4&nbsp; &nbsp; 2<br />##&nbsp; &nbsp; gwmem4&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# for memory shortage set 0<br /><br /># Dataset 5: BSE run with Haydock<br />&nbsp; &nbsp; &nbsp; &nbsp;optdriver&nbsp; &nbsp; 99<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; irdwfk&nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; irdscr&nbsp; &nbsp; 1<br /><br />&nbsp; &nbsp; &nbsp;bs_calctype&nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# KS orbitals<br />&nbsp; &nbsp; &nbsp; mbpt_sciss&nbsp; &nbsp; 0.8 eV&nbsp; &nbsp; # Scissors operator<br />bs_exchange_term&nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# With Local Fields<br />&nbsp;bs_coulomb_term&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# RPA<br />&nbsp; &nbsp; &nbsp;bs_coupling&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Faster, but not good with EELS<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;bs_loband&nbsp; &nbsp; 100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nband&nbsp; &nbsp; 250<br /><br />&nbsp; &nbsp; bs_freq_mesh&nbsp; &nbsp; 0 40 0.1&nbsp; # Freq mesh<br /><br />&nbsp; &nbsp; bs_algorithm&nbsp; &nbsp; 2<br />bs_haydock_niter&nbsp; &nbsp; 200<br />&nbsp; bs_haydock_tol&nbsp; &nbsp; 0.05 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; zcut&nbsp; &nbsp; 0.15 eV<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shiftk&nbsp; &nbsp; 0.11 0.21 0.31<br />&nbsp; &nbsp; &nbsp;chksymbreak&nbsp; &nbsp; 0<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecutwfn&nbsp; &nbsp; 20.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ecuteps&nbsp; &nbsp; 8.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inclvkb&nbsp; &nbsp; 2<br /></code></pre></div><br /><br />Any comments would be appreciated. Thanks a lot<br /><br />Best,<br />M. Avicenna Naradipa<br />National University of Singapore</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=3649&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 20:28:15 GMT -->
</html>
