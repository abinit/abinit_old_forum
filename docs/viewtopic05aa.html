<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=845&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:19:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; can GW compute indirect band gap  ?</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>can GW compute indirect band gap  ?</h2>
		<p><a href="viewtopicf116.html?f=11&amp;t=845">https://forum.abinit.org/viewtopic.php?f=11&amp;t=845</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>2</strong></div>
					<div class="post">
				<h3>can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Jan 17, 2011 9:55 am</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear all<br />I have a question <br />Is there GW can be computed in indirect band gap for GAMMA-X or GAMMA-R<br /><br />Best.<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Thu Jan 20, 2011 7:00 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Hi<br />Similar question has been around for sometimes and useful suggestions from experts have been posted in this forum or at least in the former Abinit's mailing list. However, I hope it is OK and may be helpful to repeat those answers again. <br /><br />The answer is &quot;yes&quot; but not directly. Within Abinit, the GW band structure, with either direct or indirect band gap, can be calculated using the quasiparticle self-consistent GW (QSGW) and the maximally localized Wannier functions (MLWF) regimes. The procedure can be divided into three steps.<br /><br />1. Perform normal ground state calculation to get the density (DEN) and the Khon-Sham structure (KSS) files.<br />2. Perform the QSGW calculation, using the KSS file in step 1 as input, to get the converged quasiparticle structure (QPS) file.<br />3. Perform the MLWF calculation and band interpolation using the QPS file in step 3 and the DEN and WFK files in step-1, as inputs. <br /><br />Step 1&amp;2 can be carried out with usual runs of Abinit, preferably in parallel because the GW calculations are very time consuming. To complete step 3 we need Abinit with Wannier90 interface and this can be run only in serial.<br /><br />The places to start learning all these are the Abinit tutorials: GW1, GW2 and Wanier90. Good example for performing QSGW+MLWF is tutorial t03's located in ../tests/wannier90/Input/t03.*<br /><br />Recently, with version 6.4.1 of Abinit or later, the QSGW part can be safely performed using optdriver=8. This provides a very convenient way of performing the QSGW.<br /><br />Hope this help.<br /><br />Kind Regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Sat Jan 22, 2011 4:33 am</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />Thank you for your kindness <br />Are you stayed Thailand ?<br />Nowaday, for step 1 and 2 used in parallel , how can I going to step 3 in serial ?<br /><br /><br />Best.<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Sat Jan 22, 2011 10:38 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Mutta<br /><br />You need to perform at least two separate runs. One is the parallel run (step 1&amp;2) to get the DEN, WFK, and QPS files needed in the next step.  Another is the serial run to perform Wannier function calculation and band interpolation with Wannier90 interface (step2). It may be also a good idea to perform three separate runs for each step, especially if the computing power of your system is not great.<br /><br />Hope this help,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Sun Jan 23, 2011 7:14 am</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />I have one more question , recently I used abinit 6.2.3, it is parallel version<br />How can I ran for step 3, ones is serial <br />Please comment my input file, see below<br />for input variable, it does not converge <br />How about to set 3 step but we have 5 dataset <br />ndtset   5<br /><br /># Self-consistent run to get the density<br />iscf1     5<br />toldfe1     1.00d-6<br />prtden1  1<br /><br /># Non-self-consistent run to get all cg wavefunctions<br />getden2     1<br />getwfk2     1<br />iscf2      -2<br />tolwfr2     1.0d-8<br />nband2      35<br />kssform2     3   # This option MUST be set to 3 so that conjugate-gradient<br />                 #  wavefunctions are used as basis functions in the<br />                 #  GW calculation. Otherwise, the wannier90 interface<br />                 #  will produce inconsistent, probably random results.<br />nbandkss2 -1<br /><br /># Calculation of the the screening (epsilon^-1 matrix)<br />optdriver3     3<br />gwcalctyp3    28<br />getkss3       2<br />nband3        60<br />npweps3       27 <br />npwwfn3       27<br />awtr3         0    <br /><br /># Calculation of the model GW corrections<br />optdriver4     4<br />gwcalctyp4    28<br />getkss4        2<br />getscr4        3<br />getqps4        3<br />nband4        60<br />npwsigx4      27 <br />npwwfn4       27 <br /><br /># Calculation of the quasiparticle Wannier functions<br />getden5     1<br />getwfk5     2   # Must point to lda wavefunction file completely<br />                #  consistent with _KSS file generated for GW<br />getqps5     6<br />kptopt5     3   # Must use full-zone k mesh for wannier90<br />istwfk5     216*1<br />iscf5     -2<br />nstep5     0        # Irreducible-zone wavefunctions will be transformed<br />                    #  using symmetry operations to fill the full zone,<br />                    #  and must not be modified (for consistency with GW)<br /><br />tolwfr5     1.0d-10   # Dummy, but necessary<br />nband5       60  # Must be consistent with nband in quasiparticle GW above<br /><br />prtwant5     3   # Flag for wannier90 interface with quaisparticles<br /><br />w90iniprj5     2   # Flag to use hydrogenic or gaussian orbital initial<br />                    #  projectors (to be specified in *.win file)<br />w90prtunk5     0   # Flag for producing UNK files necessary for plotting<br />                    #  (suppressed here by 0 value)<br /><br /><br />#Common to all model GW calculations<br />   rhoqpmix     0.5<br />     nkptgw     2<br />      kptgw     <br />             0.0  0.0  0.0   #GAMMA<br />             0.5  0.0  0.0   # X<br />       bdgw   <br />              1 23   <br />              1 23<br />Best.<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Jan 24, 2011 9:59 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Muta<br /><br />My three steps means to perform the ground state DEN and KSS calculations as step-1 (this should include dataset 1 and 2 of your input file). Then, you run the qpscgw (this will contain multiple iterations of dataset4 and 5) as step-2. Please see Wannier90 tutorial t03 for setting multiple iterations QPSCGW. Finally, as step-3, you need to run the Wannier90 part (dataset5) separately, by serial execution. This last step can be done provided that your Abinit has the Wannier90 interface enable (select during installation). What you need as input for the Wannier90 serial run are DEN file from dataset1, WFK file from dataset2, QPS file from dataset 4, and, of course, the Wannier90 *.win file. <br /><br />To save running time, in KSS calculation, you may set the nbandkss to a minimum value of 60, which is that specified in the gw calculations.<br /><br />Please note that, from your input file, you perform only 1 iteration of the QPSCGW. Therefore, the output QPS file in dataset 4 may not yet be the one with good physical meaning. Thus the interpolated band may not be a correct one.<br /><br />In the last few lines, I think the only two kptgw is too few. You should set all kpt in dataset1 as kptgw. (I may be wrong at this point.)<br /><br />Hope this helps.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Jan 24, 2011 12:33 pm</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />Thank you for your kindness<br />This can be help me everything <br />I used abinit 6.2.3 version , it is parallel<br />How can I set for serial version<br />I am so sorry because the program, it not good for me<br /><br /><br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Jan 25, 2011 8:07 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Mutta<br /><br />As far as I know, you can execute either in serial or parallel an installed package of Abinit 6.2.x or later versions.<br />For a serial run, a command line like &quot;../..../...$ abinit &lt;*.files&gt;&amp; log&quot;  will do the job.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Jan 25, 2011 2:29 pm</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />Thank you again<br />I have another question, sorry, you do not bother me<br />If I only want to band gap value, I do not have to calculate Wannier90: true or false ?<br />because just band gap value, for constructed band structure I MUST be computed Wannier90: true or false ?<br />exactly, input variables such as npweps, npwwfn, npwsigx the values must be the same, all or not ?<br />and the last, a correct self-consistent calculation should consist of the following run multiple iteration 1, 2, 3...  dataset<br />until now we have accuracy band gap value: right ?<br /><br /><br /><br />Many thank<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Wed Jan 26, 2011 5:01 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Mutta<br />&gt;&gt; &quot;If I only want to band gap value, I do not have to calculate Wannier90: true or false ?:<br />I would say it's true for a direct band gap and false for indirect band gap. This is because the GW calculation can only be carried out on a uniform k-point grid, which normally does not contain the k-points defining your band gap. This happens for most indirect band gap crystals. In principle, the Wannier interpolation is brought in to help us finding the eigen energies at these missing k-points, and therefore the band gap. In case of a direct band gap at Gamma, you get the GW band gap straight away without successive Wannier calculation because the Gamma point is generally included in k-point grid for the GW calculation.<br /><br />&gt;&gt; &quot;input variables such as npweps, npwwfn, npwsigx the values must be the same, all or not ?&quot;<br />I believe using the same values for all is just the way to avoid a lot of labour work, especially when you are just doing tutorials. In practice, the good input parameters should be found from convergence studies of the GW corrections with respected to each of them.<br /><br />&gt;&gt; a correct self-consistent calculation should consist of the following run multiple iteration 1, 2, 3... dataset<br />until now we have accuracy band gap value: right ?<br />I hope I understand your point correctly. I think you've got a right idea. The QPSCGW is said to converge if the energy difference at each k-point between the consecutive runs is smaller than some tolerance, such as 0.1 eV. <br /><br />Hope this help.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Wed Jan 26, 2011 4:43 pm</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />Many many thank, this help <br />When I following in wannier90 tutorial as t03, I have get everything<br />but where can I found the indirect band gap value ?<br />such as G-X = ? or G-M = ? , you know, right<br />please again<br /><br /><br /><br />Student<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Thu Jan 27, 2011 4:22 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Mutta<br /><br />You can examine the output file &quot;t03o_DS7_w90_band.dat&quot; in which the E-k data are grouped orderly by band index. Each group, separated by a line break, belongs to an energy band, with the first column is the k-value and the second column is the corresponding eigen energy. The k-value for L, gamma, K, and X,  points are assigned in the output file &quot;t03o_DS7_w90_band.gnu&quot;. Basically, to find an energy band gap, you need to look for the maximum energy of the highest occupied band and the minimum energy of the lowest unoccupied band. For silicon (with 8 electrons per unit cell), these are the 4th  and the 5th band, respectively, and the corresponding k-points giving the two energies are the Gamma and somewhere close to the X point, respectively,<br /><br />Hope this helps.<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Sat Jan 29, 2011 9:13 am</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit <br />I used GW calculation of PbTiO3,  it is a complex problem. So when I ran my system<br />it is so far for me in Step 1&amp;2,  may be 3-5 days for PC intel i7 4 core ram 8 GB  . And then please comment my input files see below<br /><br />ndtset  6 <br /><br /># Self-consistent run to get the density<br />iscf1     5<br />toldfe1   1.00d-6<br />prtden1  1<br /><br /># Non-self-consistent run to get all cg wavefunctions<br />getden2     1<br />getwfk2     1<br />iscf2      -2<br />tolwfr2     1.0d-8<br />nband2      35<br />kssform2     1   <br />nbandkss2   400<br /><br /># Calculation of the the screening (epsilon^-1 matrix)-iteration 1<br />optdriver3     3<br />gwcalctyp3    28<br />getkss3       2<br />nband3        400<br />npweps3       450<br />npwwfn3       450<br />awtr3         0    <br /><br /># Calculation of the model GW corrections-iteration 1<br />optdriver4     4<br />gwcalctyp4     28<br />getkss4        2<br />getscr4        3<br />nband4         400<br />npwsigx4       450<br />npwwfn4        450<br /><br /># Calculation of the dielectric matrix - iteration 2<br />optdriver5     3<br />gwcalctyp5    28<br />getkss5        2<br />getqps5        4<br />nband5        400<br />npweps5       450<br />npwwfn5       450<br />awtr5          0       <br /><br /># Calculation of the model GW corrections - iteration 2<br />optdriver6     4<br />gwcalctyp6     28<br />getkss6        2<br />getqps6        4<br />getscr6        5<br />nband6         400<br />npwsigx6       450<br />npwwfn6        450<br /><br />#Common to all model GW calculations<br />#gwmem   10<br />rhoqpmix   1.0<br />nkptgw     40<br />kptgw     <br />     0.00000000E+00  0.00000000E+00  0.00000000E+00<br />     1.66666667E-01  0.00000000E+00  0.00000000E+00<br />     3.33333333E-01  0.00000000E+00  0.00000000E+00<br />     5.00000000E-01  0.00000000E+00  0.00000000E+00<br />     1.66666667E-01  1.66666667E-01  0.00000000E+00<br />     3.33333333E-01  1.66666667E-01  0.00000000E+00<br />     5.00000000E-01  1.66666667E-01  0.00000000E+00<br />     3.33333333E-01  3.33333333E-01  0.00000000E+00<br />     5.00000000E-01  3.33333333E-01  0.00000000E+00<br />     5.00000000E-01  5.00000000E-01  0.00000000E+00<br />     0.00000000E+00  0.00000000E+00  1.66666667E-01<br />     1.66666667E-01  0.00000000E+00  1.66666667E-01<br />     3.33333333E-01  0.00000000E+00  1.66666667E-01<br />     5.00000000E-01  0.00000000E+00  1.66666667E-01<br />     1.66666667E-01  1.66666667E-01  1.66666667E-01<br />     3.33333333E-01  1.66666667E-01  1.66666667E-01<br />     5.00000000E-01  1.66666667E-01  1.66666667E-01<br />     3.33333333E-01  3.33333333E-01  1.66666667E-01<br />     5.00000000E-01  3.33333333E-01  1.66666667E-01<br />     5.00000000E-01  5.00000000E-01  1.66666667E-01<br />     0.00000000E+00  0.00000000E+00  3.33333333E-01<br />     1.66666667E-01  0.00000000E+00  3.33333333E-01<br />     3.33333333E-01  0.00000000E+00  3.33333333E-01<br />     5.00000000E-01  0.00000000E+00  3.33333333E-01<br />     1.66666667E-01  1.66666667E-01  3.33333333E-01<br />     3.33333333E-01  1.66666667E-01  3.33333333E-01<br />     5.00000000E-01  1.66666667E-01  3.33333333E-01<br />     3.33333333E-01  3.33333333E-01  3.33333333E-01<br />     5.00000000E-01  3.33333333E-01  3.33333333E-01<br />     5.00000000E-01  5.00000000E-01  3.33333333E-01<br />     0.00000000E+00  0.00000000E+00  5.00000000E-01<br />     1.66666667E-01  0.00000000E+00  5.00000000E-01<br />     3.33333333E-01  0.00000000E+00  5.00000000E-01<br />     5.00000000E-01  0.00000000E+00  5.00000000E-01<br />     1.66666667E-01  1.66666667E-01  5.00000000E-01<br />     3.33333333E-01  1.66666667E-01  5.00000000E-01<br />     5.00000000E-01  1.66666667E-01  5.00000000E-01<br />     3.33333333E-01  3.33333333E-01  5.00000000E-01<br />     5.00000000E-01  3.33333333E-01  5.00000000E-01<br />     5.00000000E-01  5.00000000E-01  5.00000000E-01<br />bdgw   <br />       1 23   <br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br />       1 23<br /><br />For my input file such as npweps, npwwfn, npwsigx. I guess !<br />everything I have got _DEN file as dataset 1, _WFK files as dataset 2 and _QPS files as dataset 6<br />and then I used as any files to calculated in STEP3.<br />In step3 I got files name was bando_DS1_DEN, bando_DS2_WFK and bando_DS6_QPS files<br />when i separates step3, How can I set files name was bando_DS1_DEN, bando_DS2_WFK and bando_DS6_QPS files<br />see below for input step 3<br /># Calculation of the quasiparticle Wannier functions<br />getden     1<br />getwfk     2         # Must point to lda wavefunction file completely<br />                     #  consistent with _KSS file generated for GW<br />getqps     6<br />kptopt     3         # Must use full-zone k mesh for wannier90<br />istwfk     216*1<br />iscf      -2<br />nstep      0         # Irreducible-zone wavefunctions will be transformed<br />                     #  using symmetry operations to fill the full zone,<br />                     #  and must not be modified (for consistency with GW)<br />tolwfr     1.0d-8    # Dummy, but necessary<br />nband      400       # Must be consistent with nband in quasiparticle GW above<br />prtwant     2        # Flag for wannier90 interface with quaisparticles<br />w90iniprj   2        # Flag to use hydrogenic or gaussian orbital initial<br />                     #  projectors (to be specified in *.win file)<br />w90prtunk   1        # Flag for producing UNK files necessary for plotting<br />                     #  (suppressed here by 0 value)<br /><br />this is true or false ?<br /><br />and the last question for input files is istwfk 216*1<br /> I should give k-point in the full brillouin zone <br /> in wanneir90.win see below<br /><br />! PbTiO3 - drh<br /><br />!comment out for second run<br /> postproc_setup = .true.<br /> num_iter = 100<br /><br />!comment out for first run<br />!restart = plot<br />!restart = wannierise<br /><br />!optional for first run<br />!wannier_plot = .true.<br />!wannier_plot_supercell = 3<br /> bands_plot = .true.<br /><br />begin kpoint_path<br />G 0.00000  0.00000 0.0000 X 0.50000  0.00000 0.0000<br />X 0.50000  0.00000 0.0000 M 0.50000  0.50000 0.0000<br />M 0.50000  0.50000 0.0000 R 0.50000  0.50000 0.0000 <br />R 0.50000  0.50000 0.5000 G 0.00000  0.00000 0.0000<br />end kpoint_path<br /><br />wvfn_formatted = .false.<br /><br />num_wann = 20<br />num_bands = 40<br />exclude_bands = 5-10<br /><br />begin projections<br />!site:ang_mtm:zaxis:xaxis:radial:zona:box-size<br /><br /> f=0.125,0.125,0.125 : l=0, mr=1 : r=4, zona= 0.5<br /> f=0.625,0.125,0.125 : l=0, mr=1 : r=4, zona= 0.5<br /> f=0.125,0.625,0.125 : l=0, mr=1 : r=4, zona= 0.5<br /> f=0.125,0.125,0.625 : l=0, mr=1 : r=4, zona= 0.5<br /><br />end projections<br /><br />mp_grid = 6  6  6<br /><br />begin unit_cell_cart<br />   0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />   3.6590150000E+00  3.6590150000E+00  4.3454665559E+00<br />   3.6590150000E+00  3.6590150000E+00  1.0008831463E+00<br />   0.0000000000E+00  3.6590150000E+00  5.0590278769E+00<br />   3.6590150000E+00  0.0000000000E+00  5.0590278769E+00<br />end unit_cell_cart<br /><br />begin atoms_frac<br />Pb  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br />Ti  5.0000000000E-01  5.0000000000E-01  5.3930972737E-01<br />O   5.0000000000E-01  5.0000000000E-01  1.2421819610E-01<br />O   0.0000000000E+00  5.0000000000E-01  6.2786881684E-01<br />O   5.0000000000E-01  0.0000000000E+00  6.2786881684E-01<br />end atoms_frac<br /><br />begin kpoints<br />                     0.00000000E+00  0.00000000E+00  0.00000000E+00<br />                     1.66666667E-01  0.00000000E+00  0.00000000E+00<br />                     3.33333333E-01  0.00000000E+00  0.00000000E+00<br />                     5.00000000E-01  0.00000000E+00  0.00000000E+00<br />                     1.66666667E-01  1.66666667E-01  0.00000000E+00<br />                     3.33333333E-01  1.66666667E-01  0.00000000E+00<br />                     5.00000000E-01  1.66666667E-01  0.00000000E+00<br />                     3.33333333E-01  3.33333333E-01  0.00000000E+00<br />                     5.00000000E-01  3.33333333E-01  0.00000000E+00<br />                     5.00000000E-01  5.00000000E-01  0.00000000E+00<br />                     0.00000000E+00  0.00000000E+00  1.66666667E-01<br />                     1.66666667E-01  0.00000000E+00  1.66666667E-01<br />                     3.33333333E-01  0.00000000E+00  1.66666667E-01<br />                     5.00000000E-01  0.00000000E+00  1.66666667E-01<br />                     1.66666667E-01  1.66666667E-01  1.66666667E-01<br />                     3.33333333E-01  1.66666667E-01  1.66666667E-01<br />                     5.00000000E-01  1.66666667E-01  1.66666667E-01<br />                     3.33333333E-01  3.33333333E-01  1.66666667E-01<br />                     5.00000000E-01  3.33333333E-01  1.66666667E-01<br />                     5.00000000E-01  5.00000000E-01  1.66666667E-01<br />                     0.00000000E+00  0.00000000E+00  3.33333333E-01<br />                     1.66666667E-01  0.00000000E+00  3.33333333E-01<br />                     3.33333333E-01  0.00000000E+00  3.33333333E-01<br />                     5.00000000E-01  0.00000000E+00  3.33333333E-01<br />                     1.66666667E-01  1.66666667E-01  3.33333333E-01<br />                     3.33333333E-01  1.66666667E-01  3.33333333E-01<br />                     5.00000000E-01  1.66666667E-01  3.33333333E-01<br />                     3.33333333E-01  3.33333333E-01  3.33333333E-01<br />                     5.00000000E-01  3.33333333E-01  3.33333333E-01<br />                     5.00000000E-01  5.00000000E-01  3.33333333E-01<br />                     0.00000000E+00  0.00000000E+00  5.00000000E-01<br />                     1.66666667E-01  0.00000000E+00  5.00000000E-01<br />                     3.33333333E-01  0.00000000E+00  5.00000000E-01<br />                     5.00000000E-01  0.00000000E+00  5.00000000E-01<br />                     1.66666667E-01  1.66666667E-01  5.00000000E-01<br />                     3.33333333E-01  1.66666667E-01  5.00000000E-01<br />                     5.00000000E-01  1.66666667E-01  5.00000000E-01<br />                     3.33333333E-01  3.33333333E-01  5.00000000E-01<br />                     5.00000000E-01  3.33333333E-01  5.00000000E-01<br />                     5.00000000E-01  5.00000000E-01  5.00000000E-01<br />end kpoints<br /><br /><br />please comment<br />student<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Jan 31, 2011 10:33 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear Mutta<br /><br />To read the DEN, WFK, and QPS files from the earlier runs you may use<br /><br />getden    1     # Point to the gs density<br />irdwfk     1      # Must point to lda wavefunction file completely<br />                     # consistent with _KSS file generated for GW<br />irdqps     1      # point to the converged QPS file from the QPSCGW run, <br /><br />and rename the output files &quot;bando_DS1_DEN, bando_DS2_WFK and bando_DS6_QPS&quot; to &quot;bandi_DEN, bandi_WFK and bandi_QPS&quot;, respectively to make them recognized as the inputs of the separated step-3 (the Wannier calculation).  <br /><br />Yes, there should be 216 k-points within the block <br /><br />begin kpoints<br />(list all 216 kpts) <br />end kpoints.<br /><br />So far, I see a couple of mistakes in your .win file:<br />(1) &quot;exclude_bands = 5-10&quot; should be &quot;exclude_bands = 24-400&quot; to use only the calculated GW bands.<br />(2) There must be 20 projections because you have num_wann =20.<br /><br />One more thing, because you have only 2 iterations in the qpscgw, it is not certain that you will get the converged QPS. Try the QPSCGW with optdriver=8 is a better way to do the task. With this option driver, the qpscgw is automatically performed and you have a free choice of specifying the number of iterations using &quot;gw_nstep&quot;.<br /><br />Hope this help.<br />  <br />Kind regards, <br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Jan 31, 2011 6:12 pm</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br /><br />Thank you this help<br />After I try as your suggestion with optdriver=8 in abinit 6.2.3 version<br />I have got warning word was see below<br />gw_driver.F90:104:WARNING<br />  One of the three variables ecuteps, npweps, or nsheps must be non-null.<br /><br /> gw_driver.F90:116:ERROR<br />  Cannot continue, check input file <br />and when I new install abinit 6.4.3 version, I have also warning files gw_driver.F90:104:WARNING<br />  One of the three variables ecuteps, npweps, or nsheps must be non-null.<br /><br />please again comment my input file below<br />#Definition of the GW correction<br />gw_nstep  30<br />gw_sctype 4<br />gw_toldfeig 0.1<br /><br /><br />###############################################################################<br />ndtset   4<br /><br /># Self-consistent run to get the density<br />iscf1     5<br />toldfe1   1.00d-6<br />prtden1   1<br /><br /># Non-self-consistent run to get wavefunctions<br />getden2     1<br />getwfk2     1<br />iscf2      -2<br />tolwfr2     1.0d-8<br />nband2      35<br />kssform2     1   <br />nbandkss2  400<br /><br /># Calculation of the dielectric matrix <br />optdriver3     3<br />gwcalctyp3    28<br />getkss3        2<br />nband3       400<br />npwwfn3       27<br />npweps3       27<br />awtr3          0    <br /><br /># Calculation of the model GW corrections <br />optdriver4     8<br />gwcalctyp4    28<br />getkss4        2<br />getscr4        3<br />nband4       400<br />npwwfn4       27<br />npwsigx4      27<br /><br />and one more question : When I set npwwfn, npweps and npwsigx each input file equal 2000<br />my system does not have enough memory, what do thing about my input files ?<br /><br />Best regards <br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Wed Feb 02, 2011 7:41 pm</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Dear Thanusit<br />When I try in step-3 , I have an error below<br /><br />hdr_check: WARNING -<br />  Restart of self-consistent calculation need translated wavefunctions.<br />  Indeed, critical differences between current calculation and<br />  restart file have been detected in:<br />        * the number, position, or weight of k-points<br />        * the format of wavefunctions (istwfk)<br /><br />mlwfovlp_qp: WARNING<br />  The input *_WFK file of LDA wavefunctions to be  converted<br />  to GW quasiparticle wavefunctions MUST have been written in<br />  the run that produced the GW *_KSS file using kssform 3,<br />  the ONLY value of kssform permitted for GW Wannier functions.<br />  Otherwise, the *_QPS file needed here will be inconsistent,<br />  and the output quasiparticle wavefunctions will be garbage.<br />  No internal check that can verify this is presently possible.<br /><br /><br /> listkk : BUG -<br />  The minimum square of dk has negative norm: dksqmn=   -1.000000E+00<br />  Action : contact ABINIT group.<br /><br />.Delivered    3 WARNINGs and   1 COMMENTs to log file.<br /><br /> leave_new : decision taken to exit ...<br /><br /><br />As my input files<br /># Calculation of the quasiparticle Wannier functions<br />getden     1         # Point to the gs density<br />irdwfk     1         # Must point to lda wavefunction file completely<br />irdqps     1         # point to the converged QPS file from the QPSCGW run,<br />kptopt     3         # Must use full-zone k mesh for wannier90<br />istwfk     216*1<br />iscf      -2<br />nstep      0         # Irreducible-zone wavefunctions will be transformed<br />                     #  using symmetry operations to fill the full zone,<br />                     #  and must not be modified (for consistency with GW)<br />tolwfr     1.0d-8    # Dummy, but necessary<br />nband      400       # Must be consistent with nband in quasiparticle GW above<br />prtwant     3        # Flag for wannier90 interface with quaisparticles<br />w90iniprj   2        # Flag to use hydrogenic or gaussian orbital initial<br />                     #  projectors (to be specified in *.win file)<br />w90prtunk   0        # Flag for producing UNK files necessary for plotting<br />                     #  (suppressed here by 0 value)<br /><br />Please introducing to me<br />Abdulmutta</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Mar 29, 2011 4:42 pm</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Dear Thanusitï¼Œ<br /><br /> I am also doing the calculations of the indirect band gap.  When I did the tutorial of wannier90 with t03*. It is right if I just use the  tutorial input files, but I always got a error if I calculate the band gap in three separate steps. as follows:<br /><br />         - hdr_check: checking restart file header for consistency -<br /><br /><br />         current calculation                         restart file<br />         -------------------                         ------------<br /><br />   calculation expects a wf_planewave    |  input file contains a wf_planewave<br />  . ABINIT  code version 5.8.4            |  ABINIT  code version o^U336^A377^?<br /><br />  hdr_check: BUG -<br />   input fform=         2 differs from disk file fform=         0.<br /><br />I do not know where I did wrong. Could you kindly show me how to correct it? Thank you very much.<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Apr 05, 2011 12:57 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear WG<br /><br />I've never encountered this error before. Anyway, yes,  just use the t03 input files(t03.in and t03o_DS7_w90.win), and make sure you have the t03.file and the psp files in place, then the run should be fine. Also, make sure to execute in serial because the wannier90 does not work in parallel run. If this does not fix the error, it may be easier to find out what goes wrong if you post your input files.<br /><br />Hope this help.<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Apr 05, 2011 1:52 pm</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Dear Thanusit,<br /><br />Many thanks. <br /><br />Right now, I just do the calculations of Si in the tutorial. If I do it in one step as  the tutorial, it is fine. But if I do it in the separate steps including the GW calculation and the Wannier90 calculation as you suggested above. There is always a error during the Wannier90 calculation as follows:<br /><br />-P-0000  listkk : BUG -<br />-P-0000   The minimum square of dk has negative norm: dksqmn=   -1.000000E+00<br />-P-0000<br />-P-0000  leave_new : decision taken to exit ...<br />-P-0000  leave_new : synchronization done...<br />-P-0000  leave_new : exiting...<br /><br /><br />The attachment is the input files. Thank you very much!<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Tue Apr 05, 2011 3:38 pm</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hi WG,<br /><br />You should set the same nkptgw kptgw and bdgw variables in the wannier90 run (your t03-1.in) as the one you used in the QSGW run (your t03-2.in).<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Thu Apr 07, 2011 1:33 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Hi WG<br />As David's suggestion, you need to copy the following part of your t03-1.in to t03-2.in for the Wannier90 run. These input parameters are still needed, even the SCGW calculation is no more running. <br /><br />--------------------------------------------------------------------------------------------------<br />#common to all model GW calculations<br />   rhoqpmix     0.5<br />     nkptgw     8<br />      kptgw     <br />              0.00000000E+00  0.00000000E+00  0.00000000E+00<br />              2.50000000E-01  0.00000000E+00  0.00000000E+00<br />              5.00000000E-01  0.00000000E+00  0.00000000E+00<br />              2.50000000E-01  2.50000000E-01  0.00000000E+00<br />              5.00000000E-01  2.50000000E-01  0.00000000E+00<br />             -2.50000000E-01  2.50000000E-01  0.00000000E+00<br />              5.00000000E-01  5.00000000E-01  0.00000000E+00<br />             -2.50000000E-01  5.00000000E-01  2.50000000E-01<br />       bdgw   <br />              1 8   # Only bands 1-8 are quasiparticle.  LDA will be used for<br />                    #  bands 9 and 10 in the wannier90 calculation.<br />              1 8<br />              1 8<br />              1 8<br />              1 8<br />              1 8<br />              1 8<br />              1 8<br />---------------------------------------------------------------------------------------------------------------------------<br /><br />Hope this help,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Sun Apr 10, 2011 10:55 am</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi Thanusit, David,<br /><br />Thank you for your nice suggestions!<br /><br />I will recalculate it. Sorry that I reply late because our compute nodes do not work and I can not do the test. <br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Thu Apr 14, 2011 10:44 am</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi Thanusit, David,<br /><br /><br />I did the test following your suggestions. Unfortunately, I got this error again:<br /><br />- hdr_check: checking restart file header for consistency -<br /><br /><br />current calculation restart file<br />------------------- ------------<br /><br />calculation expects a wf_planewave | input file contains a wf_planewave<br />. ABINIT code version 5.8.4 | ABINIT code version o^U336^A377^?<br /><br />hdr_check: BUG -<br />input fform= 2 differs from disk file fform= 0.<br /><br />Could you kindly give me some more suggestions? Thank you very much!<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Mon Apr 18, 2011 9:47 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear WG<br /><br />I tried running your input files with few changes and the test was completed. Apart from the missing gw input parameters discussed above, the only additional mistake I spotted in your t03-2.in was the value of &quot;w90iniprj&quot;. It should be &quot;2&quot; not &quot;4&quot;. You must have seen the error message asking to correct it.  With w90iniprj set to 2 and the following files were in place, together with the t03-2.in and t03-2.files files, the job went through nicely. Note that the abinit version I used was 6.4.3. Both parts were executed in serial.<br /><br />file list:<br /><br />14si.pspnc (psp)<br />t03-2i_DEN (copied and renamed the file &quot;t03-1o_DS1_DEN&quot; obtained from running t03-1.in)<br />t03-2i_WFK (copied and renamed the file &quot;t03-1o_DS2_WFK&quot; obtained from running t03-1.in)<br />t03-2i_QPS (copied and renamed the file &quot;t03-1o_DS6_QPS&quot; obtained from running t03-1.in)<br />t03-2o_w90.win (copied and renamed the file &quot;t03o_DS7_w90.win&quot; obtained originally from the t03 tutorial)<br /><br />One more thing, on running the first part(t03-1.in), the input file was slightly modified. I had to comment out the followings input parameters in dataset 3-6 because it doesn't seem to work in abinit 6.4.3 if they remain unchanged.<br />---------------------------------  <br />#    npweps3    27 <br />#    npwwfn3    27<br />#   npwsigx4    27 <br />#    npwwfn4    27 <br />#    npweps5    27 <br />#    npwwfn5    27 <br />#   npwsigx6    27 <br />#    npwwfn6    27 <br />---------------------------------<br /><br />Then, replaced the above commented lines with these parameters:<br />   ecutwfn  4<br />   ecuteps  4<br />   ecutsigx 4.<br /><br />This seems to be the more appropriate way of specifying the number of plane waves used in the W and G calculations. These ecut-parameters don't have to be equal and should obtained from rigorous convergence studies for serious jobs. I made them equal just for a test case.<br /><br />I'm not sure yet which part that fixes the error you encountered. I tried to re-generate the error but without success. I think you are now in the best position to find out the answer. Please let us know how it goes.<br /><br />Hope this helps.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: can GW compute indirect band gap  ?</h3>
				<div class="date">Posted: <strong>Fri Apr 29, 2011 4:59 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear all<br /><br />Please let me do a little bit of correction to my last post. Regarding the parameters &quot;npwwfn&quot; and &quot;npwsigx&quot;for gw calculations, actually they work well provided that we set &quot;ecutwfn = 0.0&quot; and &quot;ecutsigx = 0.0&quot;. This has been explained clearly in the input variable description. Sorry for my careless.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>2</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=845&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:19:57 GMT -->
</html>
