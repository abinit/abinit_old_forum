<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=1063&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:19:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; ZnTe calcualtion error</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>ZnTe calcualtion error</h2>
		<p><a href="viewtopic842c.html?f=11&amp;t=1063">https://forum.abinit.org/viewtopic.php?f=11&amp;t=1063</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Sun May 01, 2011 2:09 pm</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Dear All,<br /><br />I am calculating the band gap of ZnTe. It is clearly that ZnTe is a direct band gap semiconductor. But I got a strange result that ZnTe is indirect band gap semiconductor. Also, I always got one error as follows:<br /><br /> m_gsphere.F90:160:ERROR<br />  G-shell not closed<br />  Initial G vector  2746/ 2809    -5   -5   -5 Rotated G vector     5    5    5<br />  Through sym   1 and itim   2<br />-P-0000<br />-P-0000  leave_new : decision taken to exit ...<br /><br />Could you kindly show me how to figure it out? Thank you very much.<br /><br />Attahced is the input file.<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Mon May 02, 2011 8:56 am</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello,<br /><br />In your input file, your Kohn-Sham states are expanded in a basis with an ecut of 10 Ha, then you ask an expansion in a basis with an ecut of 12 Ha (13 Ha) in the screening (sigma) calculation. That might be the origin of your error.<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Mon May 02, 2011 9:30 am</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi David,<br /><br /><br />Thank you for your help.<br /><br />Actually, I am doing several different tests at the same time. For the ecut, I also use 14 Ha to calculate ZnTe band gap in the primitive cell and the convetional cell. The calcualtion using the primitive cell is already finished and the attached is the input file. I also got a strange result. Could you kindly give me some comment about this input? Thank you very much!<br /><br />Best,<br /><br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Mon May 02, 2011 11:15 am</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello,<br /><br />Could you give more explanations on the &quot;strange results&quot; that you get. Maybe part of the output and/or log file would help understanding your strange results.<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Mon May 02, 2011 3:02 pm</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi David,<br /><br />Thank you for your response.<br /><br />The calculation shows that there is no band gap for ZnTe using the primitive cell, which is certainly wrong. I do not know where is the problem. As you can see in the input file, most of parameters are obtained by the convergence tests. For the setup of the unit cell , I also do it in the standard way. <br /><br />The other problem is that, if I calculate ZnTe using the conventional cell, I got a inderct band gap for ZnTe. <br /><br />These results are strange. And I must made some stupid mistakes in the input files. The worse thing is that I can not find it out. <br /><br />It would be very nice if you could give me some comments about the input file. Thank you very much.<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Tue May 03, 2011 10:39 am</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello,<br /><br />Did you carefully check your geometry ? Does it give the same space group ? Are the bond lengths the same (try with prtgeo in both cases and see if you get similar bond lengths) ? I suspect you have two different geometries.<br /><br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Tue May 03, 2011 11:02 am</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi David,<br /><br />I checked it. The problem is that I got errors using both primitive cell and conventional cell of ZnTe. Moreover, these errors are nothing about the accurance. Actually, The adopted structure is slightly different from the experimental one (less than 1%). I donot think this difference can change the direct band gap to indirect band gap or no band gap. <br /><br />Could you go through the geometry setups  in the input files and kindly give me some comments according to your experience?  Thank you very much.<br /><br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Tue May 03, 2011 2:00 pm</strong></div>
				<div class="author">by <strong>david.waroquiers</strong></div>
				<div class="content">Hello,<br /><br />I just checked your geometry and it is very different from one to another. I did a very low parameter calculation with prtgeo &gt; 0 and I got these bond lengths of the first neighbours of the Zn atom :<br /><br />with primitive cell :<br />Zn-Te : 3.49603 bohr<br /><br />with conventional cell :<br />Zn-Te : 4.99220 bohr<br /><br />I guess you have a factor (square root of 2) missing when you go from the primitive to the conventional cell...<br /><br />David</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Wed May 04, 2011 1:11 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear WG<br />(I'm sorry for long message, I'll try to make my points as clear as I can).<br /><br />From your input files, I understand that you are working with ZnTe of zinc blend structure. Please correct me if I'm wrong. Leaving the input parameters for the structure as they are while nbandkss, nband for gw were reduced to 50 to speedthing up, there were errors occurring during running your input files. Luckily, they can be solved as follows.<br /><br />For the ZnTe of conventional cell,<br />1. The error &quot;m_gsphere.F90:160:ERROR G-shell not closed.. &quot; in your first post is certainly fixed by reducing the value of ecutwfn, ecuteps, and ecutsigx to lower than ecut, or vice versa,  as David's suggestion.<br /><br />2.  In the sigma energy calculation (dataset3), you called &quot;optdriver3  8&quot;, which is the option for performing self-consistent GW. This tends to give the error:<br /><br />&quot;Subroutine Unknown:0:WARNING<br />  Only one of the three variables ecuteps, npweps, or nsheps can be non-zero.<br /><br /> chkinp: ERROR -<br />  Checking consistency of input data against itself gave    1 inconsistencies.<br />-P-0000<br />-P-0000  leave_new : decision taken to exit ...&quot;. <br /><br />This error can be fixed by just setting &quot;optdriver3  4&quot;, to call the sigma calculation in a standard one shot gw. Anyway, if you intend to use optdriver 8, please study carefully it's usage in the list of input variables. There will be more new input parameters needed to get it worked.<br /><br />3. There is a warning:<br />  &quot;scprqt:  WARNING -<br />  nstep=   50 was not enough SCF cycles to converge;<br />  maximum energy difference=  4.562E-04 exceeds toldfe=  1.000E-06&quot;<br />This clearly says that the nstep=50 is too small. It may partly lead to the strange results you got. With nstep increased to 100, the warning is removed.  <br /><br />For the ZnTe of primivetive cell,<br />1. I firstly got an error:<br />&quot; symkpt: ERROR -<br />   Chksymbreak=1 . It has been observed that the k point grid is not symmetric :<br />   for the symmetry number    2<br />   with symrc1=  0  0  1 -1 -1 -1  1  0  0<br />   the symmetric of the k point number    512 with components   -6.250000E-02   -6.250000E-02   -6.250000E-02<br />   does not belong to the k point grid.<br />   Please, read carefully the description of the input variable chksymbreak,<br />   Then, you might switch it to zero, or change your k point grid to one that is symmetric.<br />  -P-0000<br />  -P-0000  leave_new : decision taken to exit ...&quot; <br /><br />It seems something to do with the k-grid setting. As I changed, in your input file, from &quot;shiftk  0.5  0.5  0.5&quot; to &quot;shiftk  0.0  0.0  0.0&quot; and set &quot;kptgw3 0.0 0.0 0.0&quot; to make sure that the specified kptgw is one of those used indataset1 to generate KSS files, the run was completed.<br /><br />2. There was also the warning about the nstep was too small. Again, setting nstep =100 eliminated the warning.<br /><br /><br />Please note that your input file was tested with Abinit 6.4.3, in parallel running. The psp files were 30zn.pspnc and 52te.pspnc. This gives the top-most filled band and the lowest empty band to be band 9 and band 10 for the primitive cell, and band 36 and band 37 for the conventional cell (checked it from  &quot;occ&quot; parameter), respectively. Please, make sure you get it right when looking for band gaps.<br /><br />Hope this helps.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Wed May 04, 2011 2:06 pm</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Hi Thanusit, David,<br /><br /><br />Thank you for your help. I will read the input variables carefully and recalculate this structure. Thank you very much.<br /><br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Thu May 05, 2011 2:09 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear WG<br /><br />One more thing, ecut = 10 or 12 seems a bit too low for ZnTe. Have you done the convergence test of total energy with repect to ecut and ngkpt?<br /><br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Fri May 06, 2011 9:44 am</strong></div>
				<div class="author">by <strong>Newlife1982</strong></div>
				<div class="content">Dear Thanusit,<br /><br />I did not do convergence calculations about ecut because it is just a test. I used 14 Ha and followed all of your suggestions to recalculate ZnTe. Unfortuately, it seems that it is still wrong.  The following is the results at  k =    0.000   0.000   0.000:<br /><br /> E^0_gap          2.840<br /> E^GW_gap         2.496<br /> DeltaE^GW_gap   -0.344<br /><br />Also, there is no KS band gap information in output file. These results should not stem from the ecut or ngkpt. I think that this error is due to the setup of primitive cell. Could you please check that part? I did that part according to my understand which maybe has some problem. Thank you very much.<br /><br />One more thing, David ever said that GW-abinit only use single k-point to calculate the bigger structure and it is accurate enough. What is your opinion? If single K-point is fine, why should we do the convergence test of ngkpt?<br /><br />Best,<br /><br />WG</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnTe calcualtion error</h3>
				<div class="date">Posted: <strong>Fri May 06, 2011 1:38 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear WG<br /><br />To get a reliable GW result you have to perform the GW calculation on top of the well converged ground state calculation.  Please be aware that using small ecut is normally for test purpose ( such as to speed things up in order  to see if the input can run through). However, if ecut is too small to get a good convergence of ground state properties, then it is unlikely that you will get a result with sensible physical meaning. Actually, it is a common practice to perform the convergence study of total energy of a system with respected to ecut and ngkpt before we start any subsequent calculation. <br /><br />As far as I know, in order to obtain reliable GW correction, what we need in the first place is the well converged KSS, no matter how many targeted k-points to find GW corrections. This is why we need the convergence study of total energy with respected to ecut and ngkpt.   Only if the strange results remains despite you use the converge ecut, then you can rule out ecut from being the cause of the error. <br /><br />Hope this answer your question.<br /><br />Kind regards,<br />Thanusit</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=1063&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:19:57 GMT -->
</html>
