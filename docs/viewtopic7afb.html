<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=286&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:19:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; [BUG FIXED] Structural Optimization of FCC Ag using FHI PP</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>[BUG FIXED] Structural Optimization of FCC Ag using FHI PP</h2>
		<p><a href="viewtopic048d.html?f=9&amp;t=286">https://forum.abinit.org/viewtopic.php?f=9&amp;t=286</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>[BUG FIXED] Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Sun May 02, 2010 5:48 pm</strong></div>
				<div class="author">by <strong>JEJohns</strong></div>
				<div class="content">I spent yesterday afternoon trying to setup to do a set of calculations of a 100 super cell of Ag(100).  Before doing them, I wanted to test the psuedopotential I was using (the FHI GGA using PBE) so I set up a set of convergence studies for the silver FCC Structure.  I have two questions:  <br /><br />1) While using the optcell 1 argument, I had to specify a very large dilatmx (~&gt;1.3) because the routine kept trying to expand the unit cell way out on the first few broyden steps.  Is this normal?  I know from the tutorial this doesn't happen with LDA &amp; Aluminum.<br /><br />2)  After running convergences in Ecut (8Ha - 28 Ha), the size of the kpoint grid  (6x6x6 - 18x18x18), tsmear (0.2, 0.1, 0.05, 0.02, 0.01, 0.005), the unit cell converged to a lattice constant of 7.95 Bohr, and the actual value is well established at 7.729 Bohr.  Is a 2.8% expansion typical of convergence for the unit cell of a noble metal?  It seems a lot worse than the tutorial which got the convergence of aluminium to 0.2% with much softer parameters.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Tue May 04, 2010 1:09 am</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content"><blockquote><div><cite>JEJohns wrote:</cite>1) While using the optcell 1 argument, I had to specify a very large dilatmx (~&gt;1.3) because the routine kept trying to expand the unit cell way out on the first few broyden steps.  Is this normal?  I know from the tutorial this doesn't happen with LDA &amp; Aluminum.<br /></div></blockquote><br />dilatmx doesn't keep it from expanding, it only tolerates much larger variations in cells. Your pseudopotential is probably bad if it is expanding the lattice way beyond the experimental value. What does it relax to? What happens with optcell 2?<br /><br /><blockquote class="uncited"><div>2)  After running convergences in Ecut (8Ha - 28 Ha), the size of the kpoint grid  (6x6x6 - 18x18x18), tsmear (0.2, 0.1, 0.05, 0.02, 0.01, 0.005), the unit cell converged to a lattice constant of 7.95 Bohr, and the actual value is well established at 7.729 Bohr.  Is a 2.8% expansion typical of convergence for the unit cell of a noble metal?  It seems a lot worse than the tutorial which got the convergence of aluminium to 0.2% with much softer parameters.</div></blockquote><br />d-metals will always be harder potentials. The precision is pretty bad indeed, but sometimes tolerated. Again, probably your potential is to blame. Where did you get it (which table?). I have used <!-- m --><a class="postlink" href="ftp://ftp.abinit.org/pub/abinitio/Psps/GGA_FHI/47-Ag.GGA.fhi">ftp://ftp.abinit.org/pub/abinitio/Psps/ ... Ag.GGA.fhi</a><!-- m --> with decent results over the years (although not brilliant either, maybe 2% errors) - it requires a much higher ecut, though, as I recall.<br /><br />Matthieu</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Tue May 04, 2010 6:47 pm</strong></div>
				<div class="author">by <strong>JEJohns</strong></div>
				<div class="content">Thanks for the Response Matthieu<br /><blockquote><div><cite>mverstra wrote:</cite>dilatmx doesn't keep it from expanding, it only tolerates much larger variations in cells. Your pseudopotential is probably bad if it is expanding the lattice way beyond the experimental value. What does it relax to? What happens with optcell 2?</div></blockquote><br />It converges to 7.954 Bohr<br /><blockquote class="uncited"><div>d-metals will always be harder potentials. The precision is pretty bad indeed, but sometimes tolerated. Again, probably your potential is to blame. Where did you get it (which table?). I have used <!-- m --><a class="postlink" href="ftp://ftp.abinit.org/pub/abinitio/Psps/GGA_FHI/47-Ag.GGA.fhi">ftp://ftp.abinit.org/pub/abinitio/Psps/ ... Ag.GGA.fhi</a><!-- m --> with decent results over the years (although not brilliant either, maybe 2% errors) - it requires a much higher ecut, though, as I recall.<br />Matthieu</div></blockquote><br /><br />I came across this article <!-- m --><a class="postlink" href="http://iopscience.iop.org/1367-2630/10/6/063020/pdf/njp8_6_063020.pdf">http://iopscience.iop.org/1367-2630/10/ ... 063020.pdf</a><!-- m --> comparing the lattice parameters of d metals &amp; some work functions using different GGA psuedopotentials within the PAW method. So it seems like 2-3% is a little high, but not much worse.<br /><br />Also I was trying to calculate the work function for my slab, by taking the difference between the Fermi energy and the Potential at some point in the vacuum, so I put &quot;prtpot 1&quot; in the input file.  It is now outputting a potential file for each broyden step and dataset (outo_geom_DS#_TIM#_POT), but when I open them with cut3d, the potential it reads out is zero everywhere.  Is it a problem with my understanding of how prtpot should work or something else?<br /><blockquote class="uncited"><div>#Making the intial slab of 100 Ag using PBE IXC <br />#And Converged FCC Values from the FCC Structure<br />#By 7 slabs of vacuum, efermi had only coverged to the 20meV mark.<br />#but calc was taking much longer.  Using the 7 vacuum layers &amp; adding atoms<br />#looks like I used 6.5 slabs of vacuum. oops<br />kptopt 1<br />#Define a Unit Cell<br />#Definition of the unit cell<br />acell 7.954 7.954 7.954 #This is a 2.8% increase in unit cell size from<br />                                   #experimental<br />rprim:  0.5  -0.5  0.0    # Unit Cell with 2 atoms in FCC geometry<br />       0.5  0.5  0.0         #With 6.5 unit of vacuum <br />       0.0  0.0  8.0<br />rprim+ 0.0 0.0 0.0<br />       0.0 0.0 0.0<br />       0.0 0.0 0.5<br /><br />ionmov 3<br />ecutsm 0.5<br />ndtset 6<br />iprcel 45<br />ntime 75<br />nstep 75<br />#Define the atoms involved<br />ntypat 1<br />znucl 47<br /><br />#Define and position the atoms<br />natom: 4 natom+ 1                 #Starting with 4 atoms for this Ag(100) slab<br />typat 1 1 1 1 1 1 1 1 1 1<br />nband: 30  nband+ 7<br /><br /><br />xcart   0.0 0.0 0.0<br />        0.0 3.977 3.977<br />        0.0 0.0 7.954 <br />        0.0 3.977 11.931<br />        0.0 0.0 15.908<br />        0.0 3.977 19.885<br />        0.0 0.0 23.862<br />        0.0 3.977 27.839<br />        0.0 0.0 31.816<br />#Define the basis set<br /><br />ecut 26<br /><br />ngkpt 12 12 12       # This is a 2x2x2 FCC grid, based on the primitive vectors<br /><br /><br /><br />#Exchange-correlation functional<br />ixc 11             #11=&gt; GGA, Perdew-Burke-Ernzerhof GGA functional<br />tsmear 0.01<br />occopt 4<br />prtpot 1<br />toldff 1.0d-6    #difference in forces for SCF Convergence <br />tolmxf 1.0d-5   #Total difference in gradiants of forces for broyden<br />                       #convergence<br />#toldfe 1.0d-7<br />timopt 2<br /><br /></div></blockquote></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Thu May 06, 2010 10:16 am</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content">That is strange - try with a single dataset. Your trick of filling typat and the rest for the maximal number of atoms is clever but may be confusing abinit. If you examine the file produced by cut3d is it full of 0.0000D00 or some very small values /= 0?<br /><br />Matthieu</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Thu May 06, 2010 9:16 pm</strong></div>
				<div class="author">by <strong>JEJohns</strong></div>
				<div class="content"><blockquote><div><cite>mverstra wrote:</cite>That is strange - try with a single dataset. Your trick of filling typat and the rest for the maximal number of atoms is clever but may be confusing abinit. If you examine the file produced by cut3d is it full of 0.0000D00 or some very small values /= 0?<br /><br />Matthieu</div></blockquote><br /><br />I'm doing that calculation right now, but when I tell cut3d to print out the formatted 3d grid of potentials, I get numerical values.  For example, in one run, my ngfft was 27 27 320, and the output of cut3d  for the indexed 3D data (menu item #6), i get a block of numbers that are 233280rows by 4 columns, where the 4th column has reasonable values for the potential (27x27x320 is 233280).  I assume that this corresponds to a fourier transform of the potential, so i don't know why it's not giving me the real space equivalent. Is there a non trivial way to back that information out from the data I have?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Fri May 07, 2010 9:42 am</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content"><blockquote><div><cite>JEJohns wrote:</cite><br />I'm doing that calculation right now, but when I tell cut3d to print out the formatted 3d grid of potentials, I get numerical values.  For example, in one run, my ngfft was 27 27 320, and the output of cut3d  for the indexed 3D data (menu item #6), i get a block of numbers that are 233280rows by 4 columns, where the 4th column has reasonable values for the potential (27x27x320 is 233280).  I assume that this corresponds to a fourier transform of the potential, so i don't know why it's not giving me the real space equivalent. Is there a non trivial way to back that information out from the data I have?</div></blockquote><br /><br />Ok - this means your pot file is probably fine - the 3d indexed data is in real space I believe. So the problem is in the output method you chose. Perhaps you compiled with too much optimization. Give us your cut3d input values (which output file format were you using?), and output (unless it is too long). I mean the screen output of cut3d, not the file contents, which you said were 0.<br /><br />Matthieu</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Sat May 08, 2010 9:10 pm</strong></div>
				<div class="author">by <strong>JEJohns</strong></div>
				<div class="content"><blockquote><div><cite>mverstra wrote:</cite><blockquote><div><cite>JEJohns wrote:</cite><br />I'm doing that calculation right now, but when I tell cut3d to print out the formatted 3d grid of potentials, I get numerical values.  For example, in one run, my ngfft was 27 27 320, and the output of cut3d  for the indexed 3D data (menu item #6), i get a block of numbers that are 233280rows by 4 columns, where the 4th column has reasonable values for the potential (27x27x320 is 233280).  I assume that this corresponds to a fourier transform of the potential, so i don't know why it's not giving me the real space equivalent. Is there a non trivial way to back that information out from the data I have?</div></blockquote><br /><br />Ok - this means your pot file is probably fine - the 3d indexed data is in real space I believe. So the problem is in the output method you chose. Perhaps you compiled with too much optimization. Give us your cut3d input values (which output file format were you using?), and output (unless it is too long). I mean the screen output of cut3d, not the file contents, which you said were 0.<br /><br />Matthieu</div></blockquote><br />Ok, so here's the output from the single dataset calculation<br /><blockquote><div><cite>Cut3d']<br />.Version 6.0.3  of CUT3D <br />.(MPI version, prepared for a x86_64_linux_gnu4.4 computer) <br /><br />.Copyright (C) 1998-2010 ABINIT group . <br /> CUT3D comes with ABSOLUTELY NO WARRANTY.<br /> It is free software, and you are welcome to redistribute it<br /> under certain conditions (GNU General Public License,<br /> see ~abinit/COPYING or <!-- m --><a class="postlink" href="http://www.gnu.org/copyleft/gpl.txt">http://www.gnu.org/copyleft/gpl.txt</a><!-- m -->).<br /><br /> ABINIT is a project of the Universite Catholique de Louvain,<br /> Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .<br /> Please read ~abinit/doc/users/acknowledgments.html for suggested<br /> acknowledgments of the ABINIT effort.<br /> For more information, see <!-- m --><a class="postlink" href="http://www.abinit.org/">http://www.abinit.org</a><!-- m --> .<br /><br />.Starting date : Thu  6 May 2010.<br />  <br /><br />  What is the name of the 3D function (density, potential or wavef) file ?<br />&#91;/quote]<br />Ag100_7atoms12121o_geom_TIM12_POT<br />&#91;quote=&quot;Cut3d']<br />  =&gt; Your 3D function file is : Ag100_7atoms12121o_geom_TIM12_POT<br />Does this file contain formatted 3D ASCII data (=0)  <br />   or unformatted binary header + 3D data        (=1) ?<br />   or ETSF binary                                (=2) ?<br />&#91;/quote]<br />1<br />&#91;quote=&quot;Cut3d wrote:</cite>===============================================================================<br /> ECHO of the ABINIT file header <br /> <br /> First record :<br />.codvsn,headform,fform = 6.0.3    57  102<br /> <br /> Second record :<br /> bantot,intxc,ixc,natom  =  1218     0    11     7<br /> ngfft(1:3),nkpt         =    27    27   375    21<br /> nspden,nspinor          =     1     1<br /> nsppol,nsym,npsp,ntypat =     1    16     1     1<br /> occopt,pertcase,usepaw  =     4     0     0<br /> ecut,ecutdg,ecutsm      =  2.6000000000E+01  2.6000000000E+01  5.0000000000E-01<br /> ecut_eff                =  2.6000000000E+01<br /> qptn(1:3)               =  0.0000000000E+00  0.0000000000E+00  0.0000000000E+00<br /> rprimd(1:3,1)           =  3.9770000000E+00 -3.9770000000E+00  0.0000000000E+00<br /> rprimd(1:3,2)           =  3.9770000000E+00  3.9770000000E+00  0.0000000000E+00<br /> rprimd(1:3,3)           =  0.0000000000E+00  0.0000000000E+00  7.9540000000E+01<br /> stmbias,tphysel,tsmear  =  0.0000000000E+00  0.0000000000E+00  1.0000000000E-02<br /><br /> Third record :<br /> istwfk=   1   1   1   1   1   1   1   1   1   1   1   1<br />   1   1   1   1   1   1   1   1   1<br /> nband =  58  58  58  58  58  58  58  58  58  58  58  58<br />  58  58  58  58  58  58  58  58  58<br /> npwarr=16048159841597615960159521593415992159541597015954<br />15946159641596615934159241592615900158381584015814<br />15718<br /> so_psp=   1<br /> symafm=<br />          1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1<br />symrel=<br />           1   0   0   0   1   0   0   0   1    -1   0   0   0  -1   0   0   0  -1<br />          -1   0   0   0   1   0   0   0  -1     1   0   0   0  -1   0   0   0   1<br />          -1   0   0   0  -1   0   0   0   1     1   0   0   0   1   0   0   0  -1<br />           1   0   0   0  -1   0   0   0  -1    -1   0   0   0   1   0   0   0   1<br />           0   1   0   1   0   0   0   0   1     0  -1   0  -1   0   0   0   0  -1<br />           0  -1   0   1   0   0   0   0  -1     0   1   0  -1   0   0   0   0   1<br />           0  -1   0  -1   0   0   0   0   1     0   1   0   1   0   0   0   0  -1<br />           0   1   0  -1   0   0   0   0  -1     0  -1   0   1   0   0   0   0   1<br /> type  =   1   1   1   1   1   1   1<br /> kptns =                 (max 50 k-points will be written)<br />            4.166667E-02    4.166667E-02    5.000000E-01<br />            1.250000E-01    4.166667E-02    5.000000E-01<br />            2.083333E-01    4.166667E-02    5.000000E-01<br />            2.916667E-01    4.166667E-02    5.000000E-01<br />            3.750000E-01    4.166667E-02    5.000000E-01<br />            4.583333E-01    4.166667E-02    5.000000E-01<br />            1.250000E-01    1.250000E-01    5.000000E-01<br />            2.083333E-01    1.250000E-01    5.000000E-01<br />            2.916667E-01    1.250000E-01    5.000000E-01<br />            3.750000E-01    1.250000E-01    5.000000E-01<br />            4.583333E-01    1.250000E-01    5.000000E-01<br />            2.083333E-01    2.083333E-01    5.000000E-01<br />            2.916667E-01    2.083333E-01    5.000000E-01<br />            3.750000E-01    2.083333E-01    5.000000E-01<br />            4.583333E-01    2.083333E-01    5.000000E-01<br />            2.916667E-01    2.916667E-01    5.000000E-01<br />            3.750000E-01    2.916667E-01    5.000000E-01<br />            4.583333E-01    2.916667E-01    5.000000E-01<br />            3.750000E-01    3.750000E-01    5.000000E-01<br />            4.583333E-01    3.750000E-01    5.000000E-01<br />            4.583333E-01    4.583333E-01    5.000000E-01<br /> wtk =<br />          0.03  0.06  0.06  0.06  0.06  0.06  0.03  0.06  0.06  0.06<br />          0.06  0.03  0.06  0.06  0.06  0.03  0.06  0.06  0.03  0.06<br />          0.03<br />Then the occ = which shows ~41 occupied bands <br /><br />tnons =<br />          0.000000  0.000000  0.000000    0.000000  0.000000  0.300000<br />          0.000000  0.000000  0.300000    0.000000  0.000000  0.000000<br />          0.000000  0.000000  0.000000    0.000000  0.000000  0.300000<br />          0.000000  0.000000  0.300000    0.000000  0.000000  0.000000<br />          0.000000  0.000000  0.000000    0.000000  0.000000  0.300000<br />          0.000000  0.000000  0.300000    0.000000  0.000000  0.000000<br />          0.000000  0.000000  0.000000    0.000000  0.000000  0.300000<br />          0.000000  0.000000  0.300000    0.000000  0.000000  0.000000<br />  znucl= 47.00<br /><br /> Pseudopotential info :<br /> title=silver, fhi98PP : Trouiller-Martins-type, GGA Perdew/Burke/Ernzerhof (1996), l= 1 local<br />  znuclpsp= 47.00, zionpsp= 11.00, pspso=  0, pspdat= 11001, pspcod=  6, pspxc= 11<br />  lmnmax  =  4<br /> <br /> Last record :<br /> residm,etot,fermie=    1.618471E-06   -2.532602731854E+02   -1.700730E-01<br /> xred =<br />            0.000000E+00    0.000000E+00    4.478977E-04<br />           -5.000000E-01    5.000000E-01    4.953898E-02<br />            7.006492E-46    3.503246E-46    9.974912E-02<br />           -5.000000E-01    5.000000E-01    1.500000E-01<br />            0.000000E+00    0.000000E+00    2.002509E-01<br />           -5.000000E-01    5.000000E-01    2.504610E-01<br />            0.000000E+00    0.000000E+00    2.995521E-01<br /> End the ECHO of the ABINIT file header <br /> ===============================================================================<br /><br /> ===========================================================<br /><br /> ECHO important input variables ...<br /><br />  Dimensional primitive vectors (ABINIT equivalent : rprimd):<br />    3.977000E+00   -3.977000E+00    0.000000E+00<br />    3.977000E+00    3.977000E+00    0.000000E+00<br />    0.000000E+00    0.000000E+00    7.954000E+01<br />  Grid density (ABINIT equivalent : ngfft):    27   27  375<br />  Number of atoms       :           7<br />  Number of atomic types:           1<br /><br />   #    Atomic positions (cartesian coordinates - Bohr)<br />   1    0.000000E+00    0.000000E+00    3.562578E-02<br />   2    0.000000E+00    3.977000E+00    3.940330E+00<br />   3    4.179723E-45   -1.393241E-45    7.934045E+00<br />   4    0.000000E+00    3.977000E+00    1.193100E+01<br />   5    0.000000E+00    0.000000E+00    1.592796E+01<br />   6    0.000000E+00    3.977000E+00    1.992167E+01<br />   7    0.000000E+00    0.000000E+00    2.382637E+01<br /><br />  This file is a Density or Potential file <br /><br />  3D function was read. Ready for further treatment.<br /> ===========================================================<br /><br />  What is your choice ? Type:<br />   0 =&gt; exit<br />   1 =&gt; point  (interpolation of data for a single point)<br />   2 =&gt; line   (interpolation of data along a line)<br />   3 =&gt; plane  (interpolation of data in a plane)<br />   4 =&gt; volume (interpolation of data in a volume)<br />   5 =&gt; 3D formatted data (output the bare 3D data - one column)<br />   6 =&gt; 3D indexed data (bare 3D data, preceeded by 3D index)<br />   7 =&gt; 3D Molekel formatted data <br />   8 =&gt; 3D data with coordinates (tecplot ASCII format)<br />   9 =&gt; output .xsf file for XCrysDen<br />  10 =&gt; output .dx file for OpenDx<br />  11 =&gt; compute atomic charge using the Hirshfeld method<br />  12 =&gt; NetCDF file<br />  14 =&gt; Gaussian/cube wavefunction module<br /></div></blockquote><br />1<br /><blockquote><div><cite>Cut3d wrote:</cite> Your choice is  1<br /><br />  Select the coordinate system:<br />  Type 1) for cartesian coordinates<br />   or 2) for crystallographic coordinates<br /></div></blockquote><br /><br />1<br /><br /><blockquote><div><cite>Cut3d wrote:</cite> Input point Cartesian Coord:  X  Y  Z </div></blockquote><br />0 0 0<br /><blockquote><div><cite>Cut3d wrote:</cite>Crystallographic coordinates:     0.000000E+00    0.000000E+00    0.000000E+00<br /> X coordinate, r1 is:    0.000000E+00<br /> Y coordinate, r2 is:    0.000000E+00<br /> Z coordinate, r3 is:    0.000000E+00<br /><br /> ---------------------------------------------<br /> Non-spin-polarized value=     0.000000E+00<br /> ---------------------------------------------<br />  Task            1  has been done !<br /><br />  More analysis of the 3D file ? (1=default=yes,0=no)<br />[/quote<br /><br />Similarly, if I use any Cartesian point, or crystallographic point, i still get a 0.0000000E+00 answer<br /><br />[qoute=&quot;Cut3d']<br /> Input point Cartesian Coord:  X  Y  Z<br />1.2 1.3 14<br /> Crystallographic coordinates:    -1.257229E-02    3.143073E-01    1.760121E-01<br /> X coordinate, r1 is:    9.874277E-01<br /> Y coordinate, r2 is:    3.143073E-01<br /> Z coordinate, r3 is:    1.760121E-01<br /><br /> ---------------------------------------------<br /> Non-spin-polarized value=     0.000000E+00<br /> ---------------------------------------------<br />  Task            1  has been done !<br /></div></blockquote><br /><br /><br />[/quote]<br /><br />But If I do this with the Density file from the same run, I get very sensible answers, for example, the Density at 0,0,0 is 4.3685E-04.  Thanks again for all the help</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Sun May 09, 2010 12:58 pm</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content">Ok, this is much more specific. Maybe the &quot;point&quot; interpolation routine has been broken, and it was not noticed. This is not something we do very routinely, as you usually want the whole cell potential on a grid for visualization or something.<br /><br />Could you try the other options: line, volume interpolation, and perhaps the xsf/dx ouput files? If all of these are non 0.00 then we know it's the point interpolation and I can have a look at it.<br /><br />Matthieu</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Sun May 09, 2010 5:27 pm</strong></div>
				<div class="author">by <strong>JEJohns</strong></div>
				<div class="content">The point, Line, Plane, and Volume interpolations all give the potential as being pure ZERO.  Outputting the potential to an opendx file, or NetCDF file, or indexed 3D or Raw 3D give reasonable potentials, once you visualize them properly.  The *.cube file for gaussian loads the structure of the atoms correctly, but it is missing some header or some other information, and guassview can't load any surfaces, and I don't have a working install of XCrysDens to check that option.<br />--James</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Structural Optimization of FCC Ag using FHI PP</h3>
				<div class="date">Posted: <strong>Sun May 16, 2010 12:40 am</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content">You are entirely correct! This bug only shows up for the point line plane interpolations, and for potentials only, densities are fine. I will add this patch to the 6.0.5 version, but in the mean time you can add the following line inside src/98_main/cut3d.F90, at line 515 (obviously without the +).<br /><br />Great that this has come out!<br />Cheers,<br /><br />Matthieu<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp;else if(fform0==101 .or. fform0==102)then&nbsp; &nbsp; ! Potential case<br />&nbsp; &nbsp; &nbsp;if(ispden==0)then<br />&nbsp; &nbsp; &nbsp; &nbsp;grid(:,:,:)=grid_full(:,:,:,1)<br />&nbsp; &nbsp; &nbsp;else if(ispden==1 .or. ispden==2)then<br />&nbsp; &nbsp; &nbsp; &nbsp;grid(:,:,:)=grid_full(:,:,:,ispden)<br />&nbsp; &nbsp; &nbsp;else<br />&nbsp; &nbsp; &nbsp; &nbsp;write(*,*)' Error: bad ispden value'<br />&nbsp; &nbsp; &nbsp; &nbsp;stop<br />&nbsp; &nbsp; &nbsp;end if<br />+&nbsp; &nbsp; &nbsp;gridtt = grid<br />&nbsp; &nbsp;end if<br /></code></pre></div></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=286&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:19:39 GMT -->
</html>
