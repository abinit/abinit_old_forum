<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1726&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:23:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; DFT+U dmatpawu</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>DFT+U dmatpawu</h2>
		<p><a href="viewtopic3ccc.html?f=9&amp;t=1726">https://forum.abinit.org/viewtopic.php?f=9&amp;t=1726</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>DFT+U dmatpawu</h3>
				<div class="date">Posted: <strong>Mon Jul 02, 2012 9:45 am</strong></div>
				<div class="author">by <strong>Shiyun</strong></div>
				<div class="content">Dear ABINIT users,<br /><br />I'm a new learner of ABINIT and I encoutered a problem with dmatpawu when I perform DFT+U calculations. According to the describtion of dmatpawu from abinit website, I should give two 5*5 matrices for dmatpawu when lpawu=2. But I got an error which states ABINIT looking for 200 array elements for dmatpawu. I don't understand why. Would someone very kindly to help me check the error?<br />Thanks very much in advance.<br /><br />Yours Sincerely,<br />Shiyun<br /><br />Here I paste the error I got and the input file.<br />[list=] <br />inread : ERROR -<br />  Attempted to read ndig=     6 floating point digits,<br />   from string(1:ndig) NTYPAT, to initialize a floating variable.<br /><br /> inarray :<br />  An error occurred reading data for keyword &quot; DMATPAWU&quot;,<br />    looking for      200 array elements.<br /><br /> inarray : ERROR -<br />  There is a problem with the input file : maybe<br />  a disagreement between the declared dimension of the array,<br />  and the number of data actually provided.<br />  Action : correct your input file !<br />[/list]<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># Crystalline V2O5 : relaxation<br />#restartxf -2<br />ndtset 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # There are 10 sets of data<br />nsppol 2<br />nspden 2<br />spinat<br />0 0 2<br />0 0 0<br />0 0 0<br />0 0 -1<br /># GGA+U<br />usepawu&nbsp; &nbsp;2<br />lpawu&nbsp; &nbsp;2 -1<br />upawu&nbsp; 6.0 0.0 eV<br />jpawu&nbsp; 0.6 0.0 eV<br /><br />#Density matrix<br />usedmatpu 4<br /><br />dmatpawu<br />#Occupation matrix for spin&nbsp; 1 and atom 1<br />&nbsp; &nbsp; &nbsp;0.34626&nbsp; &nbsp;-0.00783&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000<br />&nbsp; &nbsp; -0.00783&nbsp; &nbsp; 0.54494&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.47850&nbsp; &nbsp;-0.00841&nbsp; &nbsp;-0.00275<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp;-0.00841&nbsp; &nbsp; 0.34973&nbsp; &nbsp; 0.01008<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp;-0.00275&nbsp; &nbsp; 0.01008&nbsp; &nbsp; 0.36332<br />#Occupation matrix for spin&nbsp; 1 and atom 2<br />&nbsp; &nbsp; &nbsp;0.34626&nbsp; &nbsp;-0.00783&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000<br />&nbsp; &nbsp; -0.00783&nbsp; &nbsp; 0.54494&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.00000<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp; 0.47850&nbsp; &nbsp;-0.00841&nbsp; &nbsp;-0.00275<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp;-0.00841&nbsp; &nbsp; 0.34973&nbsp; &nbsp; 0.01008<br />&nbsp; &nbsp; &nbsp;0.00000&nbsp; &nbsp; 0.00000&nbsp; &nbsp;-0.00275&nbsp; &nbsp; 0.01008&nbsp; &nbsp; 0.36332<br /><br />###########&nbsp; Definition of the atom types&nbsp; &nbsp;###################<br />ntypat 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # There are two types of atoms<br />znucl 23 8&nbsp; &nbsp; &nbsp; &nbsp; # The keyword &quot;znucl&quot; refers to the atomic number of the <br />#Definition of the atoms<br />natom 14&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # There are 14 atom per cell<br />typat 1&nbsp; 2&nbsp; 2&nbsp; 2 # 4 V atoms (first type), 10 O atoms (second type)<br />spgroup 59<br />spgaxor 5<br />spgorig 2<br />natrd 4&nbsp; &nbsp; &nbsp; &nbsp; # number of atom read<br />xred<br />&nbsp; 6.01180506706231E-01&nbsp; 2.50000000000000E-01&nbsp; 1.12164784624507E-01<br />&nbsp; 4.31085164975180E-01&nbsp; 2.50000000000000E-01&nbsp; 9.90527888580827E-01<br />&nbsp; 6.05402321024327E-01&nbsp; 2.50000000000000E-01&nbsp; 4.42282823196809E-01<br />&nbsp; 7.50000000000000E-01&nbsp; 2.50000000000000E-01&nbsp; 2.00560821829411E-03<br />#Definition of the primitive cell and scale of Cartisien Coordinate<br />acell 11.544&nbsp; 3.571&nbsp; 4.383&nbsp; angstrom&nbsp; &nbsp;# In unit of angstrom&nbsp; 1Bohr=0.5291772108 Anstrong<br />rprim&nbsp; 1.0&nbsp; 0.0&nbsp; 0.0 # Simple Cubic primitive vectors (to be scaled by acell)<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 1.0&nbsp; 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp;0.0&nbsp; 0.0&nbsp; 1.0<br />##################################################################<br /><br />######## Data set1:&nbsp; Optimize the atom coordinate&nbsp; ###########<br />optcell1 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# optimisation of volume only, not modify rprim<br />ionmov1&nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# <br />tolmxf1 5.0e-5<br />toldff1 5.0e-6<br />#######&nbsp; Data set 2: Optimize the cell&nbsp; #############<br />optcell2 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# optimisation of volume only, not modify rprim<br />ionmov2&nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# <br />tolmxf2 1.0e-4&nbsp; &nbsp; &nbsp;# Tolerance on the maximal force for BFGS structure relaxation<br />toldff2 1.0e-5<br /><br />ecutsm&nbsp; 0.5&nbsp; &nbsp; &nbsp; &nbsp;# important for cell relaxation (optcell /=0)<br />getcell -1&nbsp; &nbsp; &nbsp; &nbsp; # get cell parameter from previous out put data as input data<br />getxred -1&nbsp; &nbsp; &nbsp; &nbsp; # get XRED from...<br />dilatmx 1.1<br />ntime&nbsp; 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# give MD time steps or Broyden Stru Optim steps if ionmov=1 or 2<br />##################################################################<br /><br /><br />################&nbsp; &nbsp;Exchange-correlation functional&nbsp; ##############<br />ixc 11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # GGA, Perdew-Burke-Ernzerhof GGA function<br />pawecutdg 80&nbsp; &nbsp; &nbsp; # PAW-Energy Cutoff for the double grid<br />timopt 2<br />##################################################################<br /><br /><br />##############&nbsp; &nbsp;Definition of the k-point grid&nbsp; &nbsp;################<br />kptopt 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Default value in fact. set up the k point according to ngkpt or<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # kptrlatt, as well as nshiftk and shiftk.<br />ngkpt 4 6 6&nbsp; &nbsp; &nbsp; &nbsp;# This is a 4x6x6 orthorhombic grid, based on the primitive vectors<br />nshiftk 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# This is the default value in fact<br />shiftk 0.5 0.5 0.5<br />##################################################################<br /><br />###############&nbsp; Definition of the SCF procedure&nbsp; ################<br />nstep 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximal number of SCF cycles<br />iscf 17&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# <br />ecut 38.0<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: DFT+U dmatpawu</h3>
				<div class="date">Posted: <strong>Tue Jul 03, 2012 4:11 pm</strong></div>
				<div class="author">by <strong>blackburn</strong></div>
				<div class="content">Hi,<br /><br />You have 4 V atoms in total (after the geometry builder). You need to specify two 5x5 matrices for each atom : 2 (spin) x 5x5 x 4 (atoms) = 200. You can probably just repeat the same matrices you already have for the 3 other V atoms.<br /><br />Simon</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: DFT+U dmatpawu</h3>
				<div class="date">Posted: <strong>Wed Jul 04, 2012 11:11 am</strong></div>
				<div class="author">by <strong>Shiyun</strong></div>
				<div class="content">Dear Simon,<br />Thank you very much for your help and quick reply.<br /><br />All the best wishes,<br />Shiyun</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1726&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:23:43 GMT -->
</html>
