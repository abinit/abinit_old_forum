<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1673&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:51:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; phonon dispersion of graphane</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>phonon dispersion of graphane</h2>
		<p><a href="viewtopic200e.html?f=9&amp;t=1673">https://forum.abinit.org/viewtopic.php?f=9&amp;t=1673</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Sat May 19, 2012 8:15 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear users/developers,<br />I am trying to calculate the phonon dispersion of graphane.<br />Prior to this calculation I've made an optimization of the Lattice parameter, and Ecut.<br />But when it comes to phonon dispersion it is just terrible! the dispersion looks Ugly and I have a negative frequencies around -1000cm-1.<br />The input for the phonon calculations:<br />-----------------------------------------------------------------------<br />#tolvrs  1.0d-9<br />prtvol  3<br />ndtset 28<br />#jdtset  1 25 26 27 28<br /># ground state<br />#getwfk1  1<br />kptopt1  1<br />tolvrs1  1d-16<br />prtden1  1<br />getwfk1  0            # Cancel default<br />rfphon1  0            # Cancel default<br />  nqpt1  0<br /># Response Function calculation<br />   nqpt  1<br /> rfphon  1<br />rfatpol  1 4<br />  rfdir  1 1 1<br /> getwfk  1<br /> kptopt  1<br /> tolvrs  1.0d-9<br /><br />       qpt2   0.00000000E+00  0.00000000E+00  0.00000000E+00<br />       qpt3   6.66666667E-02  0.00000000E+00  0.00000000E+00<br />       qpt4   1.33333333E-01  0.00000000E+00  0.00000000E+00<br />       qpt5   2.00000000E-01  0.00000000E+00  0.00000000E+00<br />       qpt6   2.66666667E-01  0.00000000E+00  0.00000000E+00<br />       qpt7   3.33333333E-01  0.00000000E+00  0.00000000E+00<br />       qpt8   4.00000000E-01  0.00000000E+00  0.00000000E+00<br />       qpt9   4.66666667E-01  0.00000000E+00  0.00000000E+00<br />       qpt10  1.33333333E-01  6.66666667E-02  0.00000000E+00<br />       qpt11  2.00000000E-01  6.66666667E-02  0.00000000E+00<br />       qpt12  2.66666667E-01  6.66666667E-02  0.00000000E+00<br />       qpt13  3.33333333E-01  6.66666667E-02  0.00000000E+00<br />       qpt14  4.00000000E-01  6.66666667E-02  0.00000000E+00<br />       qpt15  4.66666667E-01  6.66666667E-02  0.00000000E+00<br />       qpt16 -4.66666667E-01  6.66666667E-02  0.00000000E+00<br />       qpt17  2.66666667E-01  1.33333333E-01  0.00000000E+00<br />       qpt18  3.33333333E-01  1.33333333E-01  0.00000000E+00<br />       qpt19  4.00000000E-01  1.33333333E-01  0.00000000E+00<br />       qpt20  4.66666667E-01  1.33333333E-01  0.00000000E+00<br />       qpt21 -4.66666667E-01  1.33333333E-01  0.00000000E+00<br />       qpt22  4.00000000E-01  2.00000000E-01  0.00000000E+00<br />       qpt23  4.66666667E-01  2.00000000E-01  0.00000000E+00<br />       qpt24 -4.66666667E-01  2.00000000E-01  0.00000000E+00<br />       qpt25 -4.00000000E-01  2.00000000E-01  0.00000000E+00<br />       qpt26 -4.66666667E-01  2.66666667E-01  0.00000000E+00<br />       qpt27 -4.00000000E-01  2.66666667E-01  0.00000000E+00<br />        qpt27 -4.00000000E-01  2.66666667E-01  0.00000000E+00<br />       qpt28 -3.33333333E-01  3.33333333E-01  0.00000000E+00<br /># SCF<br /><br />acell  4.7471698113 4.7471698113   15<br /><br />rprim   1.0000000000  0.0000000   0.000000<br />        0.5000000000  0.8660254037844386  0.000000<br />        0.0000000000  0.00000000  1.000000<br /><br />#DAT : Definition of the types of atoms<br /><br />ntypat 2<br />znucl 6 1<br /><br />#DA  : Definition of the atoms<br /><br />natom 4<br />typat 1 1 2 2<br />xred  1/3       1/3      0.400000/15<br />     -1/3      -1/3     -0.400000/15<br />      1/3       1/3      2.500000/15<br />     -1/3      -1/3     -2.500000/15<br /><br />#DPWset : Definition of the plane wave basis set<br />occopt 1<br />nband 14<br />ecut 38<br />diemac 6.00<br /><br />#Dkptgrid : Definition of the k-points grid<br /><br />#kptopt 1<br />ngkpt  15 15 1<br />nshiftk 1<br />shiftk 0 0 0<br />#toldfe 1e-8<br />#prtdos 2<br />#prtden 1<br />#band<br />#DSCFproc : Definition of the SCF procedure<br />#prtdos 2<br />nstep 50<br />----------------------------------------------------<br />And the input for anaddb:<br />------------------------------------------------------<br />!Input file for the ifc code. Analysis of a restricted SiO2 DDB<br />!Will use only the Gamma point information : compute<br />!Compute LO-TO splitting for different directions,<br />!as well as the dielectric tensor at zero frequency<br /><br />!Input file for the ifc code. Analysis of the BN-sheet DDB<br />!Flags<br /> dipdip 0<br /> eivec     1<br /> ifcflag   1     ! Interatomic force constant flag<br />     asr   1     ! Acoustic Sum Rule. 1 =&gt; imposed asymetrically<br /> symdynmat 1<br /><br />!Wavevector grid number 1 (coarse grid, from DDB)<br />  brav    1         ! Bravais Lattice : 1-S.C., 2-F.C., 3-B.C., 4-Hex.)<br />  ngqpt   15 15 1   ! Monkhorst-Pack indices<br />  nqshft  1         ! number of q-points in repeated basic q-cell<br />  q1shft  0 0 0.0<br /><br />!Effective charges<br />  chneut   1     ! Charge neutrality requirement for effective charges.<br /><br />!Wavevector list number 1 (Reduced coordinates and normalization factor)<br />  nph1l    239     ! number of phonons in list 1<br /><br />  qph1l<br /><br />  -0.33333   0.33333   0.00000   1.00000<br />  -0.33003   0.33003   0.00000   1.00000<br />  -0.32673   0.32673   0.00000   1.00000<br />  -0.32343   0.32343   0.00000   1.00000<br />  -0.32013   0.32013   0.00000   1.00000<br />  -0.31683   0.31683   0.00000   1.00000<br />  -0.31353   0.31353   0.00000   1.00000<br />  -0.31023   0.31023   0.00000   1.00000<br />  -0.30693   0.30693   0.00000   1.00000<br />  -0.30363   0.30363   0.00000   1.00000<br />  -0.30033   0.30033   0.00000   1.00000<br />  -0.29703   0.29703   0.00000   1.00000<br />  -0.29373   0.29373   0.00000   1.00000<br />  -0.29043   0.29043   0.00000   1.00000<br />  -0.28713   0.28713   0.00000   1.00000<br />  -0.28383   0.28383   0.00000   1.00000<br />  -0.28053   0.28053   0.00000   1.00000<br />  -0.27723   0.27723   0.00000   1.00000<br />  -0.27393   0.27393   0.00000   1.00000<br />  -0.27063   0.27063   0.00000   1.00000<br />-----------   -----------  ---------    ----------<br />---------------------------------------------------------------------------<br />This example is for 15x15 grid for kpts and qpts.<br />But I also tried the 30x30 for k-point but still have the same dispersion.<br />Many thanks for your help,<br />Samir</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Thu Jun 21, 2012 5:36 pm</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Before doing a finite q calculation, it might be a good idea to non-scf calculation with commensurable q mesh with the k mesh in G.S.<br /><br />In other words, add the following 7 lines before phonone calculation. You can see the the two parts have same qpt, but one is non-scf, the other is scf.<br />nqpt2 1<br />qpt2 0.0 0.0 0.1<br />getwfk2 1     #from SCF high-accuracy calculation<br />getden2 1     #from SCF high-accuracy calculation<br />kptopt2 3<br />tolwfr2 1.0d-18<br />iscf2 -2      # Prepare for finite q phonon <br /><br />After that, do the phonon calculation<br /><br />rfphon3  1<br />rfatpol3   1 2<br />rfdir3   1 1 1<br />nqpt3   1<br />qpt3   0.0 0.0 0.1<br />getwfk3   1             <br />getwfq3   2             <br />kptopt3   3<br />tolvrs3   1.0d-8     <br />iscf3 5                       <br /><br />Then, when doing the finite q calculation, you can call &quot;getwfq&quot; for the non-scf DDK. <br /><br />I'm not totally sure about your concerns, but it is the general procedure to be helpful.<br /><br />What's more, I believe at the beginning you don't want to calculate the entire dispersion, but few points for tests; extending to the full dispersion can be done later.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Fri Jun 22, 2012 11:56 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />I am really grateful for your help.<br />I'll check what you're suggesting but I am not sure that this problem comes directly from the fact that the qpts is not commensurable with respect to kpts.<br />I am experiencing the same problems for graphene. Indeed, as you might know graphene is much simpler than graphane. So I decided to reproduce graphene's phonons first. Especially since the structure is very similar (they have the same hex space group)<br />The phonon dispersion for graphene is even worse! as you can see it in the attached plot (the path is G-K-M-G)!. The input:<br /># phonons<br />prtvol 3<br />ndtset 28<br />udtset 14 2<br /># ground state<br />#Dataset 1 : SCF<br />#  Chksymbreak 0<br />#  rfasr 2<br />  getden 11<br />  getwfk 11<br />  kptopt 3<br /># Response Function calculation<br /># qpt generation<br />   nqpt  1<br />   qptopt 1<br />   ngqpt 10 10 1<br />   nshiftq 1<br />   shiftq 0.0 0.0 0.0<br />   iqpt:? 1<br />   iqpt+? 1<br />#Dataset 11 : SCF<br />  getden11  0<br />  getwfk11  0<br />    iscf11  7<br />    nqpt11  0<br />  prtden11  1<br />###############<br />#Dataset 2 : phonon at gamma<br />  getwfq12  0<br />##################<br /><br />#Dataset ?1 : non-SCF <br />    iscf?1 -2<br />  tolwfr?1  1.0d-20<br />#Dataset ?2 : RF<br />  getwfq?2  -1<br />  rfatpol?2  1 1<br />  rfdir?2  1 1 1<br />  rfphon?2  1<br />  tolvrs?2 1.0d-16<br />#######################################################################<br />#Common input variables<br />#######################################################################<br /> acell    4.6511685 4.6511685 14<br /> xred     2/3 1/3  0.0<br />          1/3 2/3  0.0<br />rprim  1.0 0.0 0.0               # Hex. primitive vectors(to be scaled by acell)<br />      -0.5  0.8660254037844386  0.0<br />       0.0 0.0  1.0<br />#Definition of the atom types<br />ntypat 1          # There are two types of atoms<br />znucl 6           # The keyword &quot;zatnum&quot; refers to the atomic number of the<br />                  # possible type(s) of atom. The pseudopotential(s)<br />                  # mentioned in the &quot;files&quot; file must correspond<br />                  # to the type(s) of atom.<br />#Definition of the atoms<br />natom 2<br />typat 1 1<br />    ngkpt  10 10 1<br />    nshiftk   1              # Use one copy of grid only (default)<br />    shiftk   0.0 0.0 0.0    # This choice of origin for the k point grid<br />                         # preserves the hexagonal symmetry of the grid,<br />                         # which would be broken by the default choice.<br />    nband 16<br />    nbdbuf 4<br />   occopt 3<br />   tsmear 0.005<br />#Definition of the planewave basis set<br />ecut   35.0        # Minimal kinetic energy cut-off, in Hartree<br />#Definition of the SCF procedure<br />nstep  500         # Maximal number of SCF cycles<br />diemac 12.0       # Although this is not mandatory, it is worth to<br />######################################<br />you can check in a separate test (you can just generate kpts for the GS using 10x10x1 grid for kptopt 1 and 3 and compare), that the qpts can be expressed as in terms of the kpts differences.<br />I spent a lot a lot of time on this problem (I am really suffering!) and I have the feeling that the problem might come from the 6.8.2 version of abinit.<br />So, I don't really know if installing the latest version could me helpful!. I already tried different sampling of kpts/qpts.......without success. I don't know what are the other parameter that could be relevant for phonons.<br />I really appreciate your help/suggestions.<br />Many thanks,<br />Sam.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jun 26, 2012 4:52 am</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Hello, I went through the input file and seems the essential elements are already there. So maybe let's cut the problem into several:<br /><br />1) is the convergence test good? (from observation it is already enough)<br /><br />2) is the acell(3)=14 large enough? (seems enough, too)<br /><br />3) is the structure fully relaxed? (check fcart and stress in the out file or log file)<br /><br />4) based on this structure, can the electronic structure be correctly reproduced? <br /><br />If you don't mind, could you please take a look back to confirm the above, so we can focus that the problem is only in the phonon part?<br /><br />If all of the above are correct, since I saw some negative frequencies, it might be from the acoustic sum rule; without which, there are negative frequencies.<br /><br />Also, the ZA mode should be proportional to q^2.<br /><br />If it still does not work, my suggestion is to follow two ways:<br /><br />1) get several q points manually (with commensurate k mesh of non-scf Ground State), and compare it. <br /><br />2) Calculate the dynamical matrix of commensurate in-equivalent q points(which q points needed to be calculated? just do a simple scf calculation, and grep &quot;kpt&quot;), and interpolate them with the phonon path you need. <br /><br />I'm sure that with the acoustic sum rule, enough large k mesh (all convergence), you are quite close to the final solution.<br /><br />Best,<br />Ludwig</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jun 26, 2012 1:25 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />Thank you so much for your help.<br />I think we can skip points 1 to 4 concerning the electronic structure of graphene. I already checked this and the DOS and the Band-structure are Ok.<br />Yes, I forced the ASR too in anaddb input (I checked both asr 1 and 2 but I got the same result I sent you). <br />Concerning phonons calculations I did not understand both points 1 and 2!<br />I don't understand what do you mean by: <br />1) get several q points manually (with commensurate k mesh of non-scf Ground State), and compare it. <br />for the input I already sent you I generated separately the following qpts:<br />                      0.00000000E+00  0.00000000E+00  0.00000000E+00<br />                       1.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       2.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       3.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       4.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       5.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       1.00000000E-01  1.00000000E-01  0.00000000E+00<br />                       2.00000000E-01  1.00000000E-01  0.00000000E+00<br />                       3.00000000E-01  1.00000000E-01  0.00000000E+00<br />                       4.00000000E-01  1.00000000E-01  0.00000000E+00<br />                       2.00000000E-01  2.00000000E-01  0.00000000E+00<br />                       3.00000000E-01  2.00000000E-01  0.00000000E+00<br />                       4.00000000E-01  2.00000000E-01  0.00000000E+00<br />                       3.00000000E-01  3.00000000E-01  0.00000000E+00<br />By just using a usual input (GS) with ngkpt 10 10 1 and kptopt 1. And I checked for the same ngkpt but for kptopt 3 (as it should be for kpts when doing phonon calculations) and I found that the qpts (kptopt 1) can be expressed in terms of kpts (kptopt 3). I don't understand what do you mean by generate manually? and which should be compared with which?<br />For the second point concerning the dynamical matrix I don't see why I should calculate q point that are equivalent (by symmetry). I can understand that I have probably to check inequivalent q-point separately and then interpolate but there should not be a way to interpolate equivalent points since they have the same frequencies!. But again this is what I am doing so far. If I make in the input nqptopt 1 means that the 14 points I gave previously are inequivalent and then at the anaddb stage they will be interpolated according to the indicated path!. Probably I am missing something but that is my understanding!.<br />I would be happy if you could explain more these two points.<br />Many many thanks,<br />Sam</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jun 26, 2012 5:17 pm</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Hello Sam:<br /><br />      Sorry for the possible confusion. I mean, maybe we can first reduce the possible problematic range.<br /><br />For example, if at certain q point, the phonon frequency is less than 0, we may first only check that single point (say, qx qy qz):<br /><br />First, a scf calculation taking advantage of full symmetry:<br />kptopt1   1             <br />tolvrs1   1.0d-18      <br />iscf1   5              <br />prtden1   1            <br /><br />Then,  a non-scf calculation at finite q, and use entire B.Z<br /><br />nqpt2 1<br />qpt2 qx qy qz<br />getwfk2 1     <br />getden2 1     <br />kptopt2 3<br />tolwfr2 1.0d-18<br />iscf2 -2       <br /><br />Finally, call the WFK of dataset1, and WFQ of dataset2<br /><br />rfphon3  1<br />rfatpol3   1 2<br />rfdir3   1 1 1<br />nqpt3   1<br />qpt3   qx qy qz<br />getwfk3   1           <br />getwfq3   2           <br />kptopt3   3<br />tolvrs3   1.0d-8     <br />iscf3 5                       <br /><br />Then, finally at the output file, you can <br />grep -A3 &quot;Phonon&quot; filename.out<br />to see Phonon frequencies directly.<br /><br />Can this get correct positive freq behavior? <br /><br />This does not use futher mrgddb and anaddb, only abinit; also it does not interpolate, only use a finite q G.S., and call it to calculate phonon. <br />In other words, this is the most reduced version to calculate phonon at finite q.<br /><br />If you still cannot get phonon correctly, then it might be a problem beyond our scope.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jun 26, 2012 7:11 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />I really appreciate your help.<br />You're right!. I am surprised that I have already troubles during the first GS calculation Check.<br />scfcge : ERROR -<br />Potential-based CG line minimization not converged after 13 restarts.<br />Action : read the eventual warnings about lack of convergence.<br />Some might be relevant. Otherwise, raise nband<br />As you know nband is already enough (nband 16) so I will try other iscf (for example 7) and other k-point sampling other then 10x10x1.<br />What do you think?<br />Thanks,<br />Sam</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jun 26, 2012 9:34 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />I used iscf 7 instead of 5 and the three steps was done successfully as you suggested. The main output data are as follow:<br />loper3 : total number of electrons, from k and k+q<br />  fully or partially occupied states are    8.000000E+00 and    8.000000E+00.<br />Phonon frequencies in cm-1    :<br />-  4.660460E+01  2.099668E+02  3.282793E+02  9.046315E+02  1.518869E+03<br />-  1.578322E+03<br />the 2DTE is also converged:<br />iter   2DEtotal(Ha)        deltaE(Ha) residm    vres2<br />-ETOT  1   23.630088896782     -2.389E+02 1.594E+00 2.949E+04<br /> ETOT  2   11.757348810888     -1.187E+01 4.160E-02 4.168E+02<br /> ETOT  3   11.559484232802     -1.979E-01 6.882E-04 1.498E+00<br /> ETOT  4   11.559173911248     -3.103E-04 3.210E-05 2.370E-02<br /> ETOT  5   11.559171583725     -2.328E-06 5.216E-07 5.066E-04<br /> ETOT  6   11.559171555644     -2.808E-08 1.397E-08 5.825E-05<br /> ETOT  7   11.559171535485     -2.016E-08 7.738E-10 2.206E-05<br /> ETOT  8   11.559171521792     -1.369E-08 2.074E-11 2.351E-08<br /> ETOT  9   11.559171521788     -4.178E-12 9.164E-13 6.588E-10<br />and the the dynamical matrix is calculated to be:<br />Dynamical matrix, in cartesian coordinates,<br />   if specified in the inputs, asr has been imposed<br />     j1       j2             matrix element<br />  dir pert dir pert     real part    imaginary part<br /><br />   1    1   1    1         0.5765623597         0.0000000000<br />   1    1   2    1         0.0243877579        -0.0000000130<br />   1    1   3    1        -0.0000003641         0.0000000919<br />   1    1   1    2        -0.5177520210        -0.1304228436<br />   1    1   2    2        -0.0050870905        -0.0326155268<br />   1    1   3    2         0.0000000000         0.0000000000<br />which means that the frequencies are positive. As this frequencies are calculated for q: 0.1 0.0 0.0 I compared them with the calculation I've done for the complete q-points (for which I got a negative frequencies).<br />loper3 : total number of electrons, from k and k+q<br />  fully or partially occupied states are    8.000000E+00 and    9.388526E+00.<br /> Initialisation of the first-order wave-functions :<br />Phonon frequencies in cm-1    :<br />- -2.576720E+03 -2.230206E+03 -2.178868E+03 -2.152276E+03 -1.351607E+03<br />- -1.318281E+03<br />The 2DTE:<br />ETOT 25  -506.70773439633     -4.547E-12 2.353E-20 1.265E-13<br /> ETOT 26  -506.70773439633     -3.183E-12 1.245E-20 3.292E-14<br /> ETOT 27  -506.70773439632      1.273E-11 4.967E-21 3.145E-15<br /> ETOT 28  -506.70773439631      1.000E-11 1.031E-21 2.390E-16<br /> ETOT 29  -506.70773439631     -4.547E-12 7.155E-23 6.962E-18<br /> Dynamical matrix, in cartesian coordinates,<br />   if specified in the inputs, asr has been imposed<br />     j1       j2             matrix element<br />  dir pert dir pert     real part    imaginary part<br /><br />   1    1   1    1        -1.4766922071         0.0000000000<br />   1    1   2    1         0.0426574927        -0.0001824885<br />   1    1   3    1        -0.0022453447        -0.0121550290<br />   1    1   1    2        -0.6628288078        -0.1260569249<br />   1    1   2    2         0.0228799948         0.0269300226<br />   1    1   3    2         0.0000000000         0.0000000000<br />As you see the output data is completely different!. I am really confused. If I look at the previous input (with the total q-point) The second phonon wave-vector (0.1 0.0 0.0) is calculated in a very similar way as you suggested with the only difference that the calculation is done in three steps instead of two with the third step being performed in a self-consistent way(iscf 7 which takes a lot of time when done for all q-points). Does it mean that my problem come from the Non-SCF calculation?. If so there is no many choices in abinit because we have two methods only iscf -2 and -3 (which I think I already checked).<br />Thanks a lot,<br />Sam</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Fri Jun 29, 2012 12:01 am</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Dear Sam:<br /><br />     Thanks for the post. I see that the ETOT is well converged. How about &quot;2DEtotal&quot; and &quot;non-var. 2DEtotal&quot; (they are listed right after the ETOT)? Are they the same? <br /><br />     If yes, this means that the Abinit itself is making correct result (positive), however, the Anaddb, which interpolates various matrices, give bad answer in certain direction. The acoustic sum rule is a usual source for negative freq problem, so you may even drop it (and charge neutrality) to see whether there is a real difference.<br /><br />  If not, there is one likely problem, that you may have to increase the k-mesh, to obtain more dynamical matrices of more in-equivalent K-points. Then you have more accuracy to do the dynamical matrix interpolation. One more further step can be done, to incorporate the DDB of the q=0.1 0.0 0.0(your example) calculated directly, to the mrgddb all in-equivalent K-points.<br /><br />     As to the non-SCF procedure, as long as we control the &quot;tolwfr&quot; low enough, and from a highly- accurate ground state, it should be OK. <br /><br />Best,<br />Ljludwig</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Fri Jun 29, 2012 10:39 am</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />The ETOT values I provided are those of 2DTE...and you see that both (for the case where frequencies are not negative and the case where they are not) converge but the converged values are not the same!. Not only the 2DTE are different but also the dynamical matrix. This is because we did iscf 7 (with one q-point) and in the wrong calculation iscf is -2.........to me this is the only difference. Probably there is a problem for iscf -2 in this version (6.8.2).<br />For the anaddb is still early to judge whether the problem comes from there or not. The negative frequencies I provided they are obtained at the level of abinit already (the first run for phonons). <br />Thanks any way,<br />Sam.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Tue Jul 03, 2012 8:16 pm</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Dear Sam:<br /><br />       I believe that you are correct. Before doing any interpolation, the in-equivalent q points themselves already have negative frequencies. Since they come from a scf ground state and non-scf DDK, we may have to set both ground state and ddk tolwfr to a same, very low value, and then calculate dynamical matrices. <br /><br />iscf2   -3         #ddk calculation<br />kptopt2   2<br />rfphon2   0<br />rfelfd2   2<br />tolwfr2   1.0d-25<br /><br />   This might be the final idea I have; if it still doesn't work, maybe the version may have to be changed.<br />Best,</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Sun Jul 08, 2012 10:11 am</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />I am very happy to tell you that I finally calculated the phonon dispersion of graphene (have a look at the attached plot).<br />I have just to add kptopt1 1. which means that the problem at Gamma (negative frequency) comes from the fact that kptopt was set to 3 (including Gamma point).<br />I am targeting the graphane (hydrogenated graphene) phonon dispersion. I did the calculation for graphene because it is simpler and very similar to graphane (since we have the same hex structure with two carbon and hydrogen sub-lattices). So I proceeded in the same way as you suggested, just for one k-point near the Gamma point, for-example. And with the same graphene phonon input I am still having some problems!.<br />The frequencies near the Gamma point are usually negative and when I get read of them I don't have the correct number of non-zero modes at the Gamma point!.<br /> For example, in the letter (Appl. Phys. Lett. 98, 051914 2011) there is 9 non-zero modes while I always find only 6 non-zero modes (around the Gamma point)!!! So I am wondering what is the parameter that control the number of  modes (at Gamma)?<br />I've already made a full geometry optimization and relaxation before the phonon calculation. <br />Is there any special setting for phonon-calculations in a semi-conducting material!  <br />Your help was really useful for me, and hope that we could solve the problem for graphane as well.<br />Thanks,<br />Sam</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Wed Jul 11, 2012 6:03 am</strong></div>
				<div class="author">by <strong>ljludwig</strong></div>
				<div class="content">Dear Sam: <br /><br />    Glad to hear that your problem is solved. I still don't get it- at the very beginning of your post, isn't kptopt1 already added? Could you please provide more detail, such as input file for future reference of this forum? Many thanks.<br /><br />     Are you sure this new hydrogenated graphene is thermodynamically stable?  If we look at the procedure how phonon is calculated, then it is simply displacement of atoms. The extent of displacement is denoted by wavevector. If the structure is not stable, then the distorted, displaced structure is possible to have lower energy the the &quot;ground state&quot;, especially near Gamma. Since Gamma is long-wavelength, such distortion is only small shift to &quot;equilibrium position&quot;. If the &quot;equilibrium&quot; ground state is not Real ground state with stability, then negative frequency occurs. <br /><br />     The modes are the same in different k points- some are degenerate. It depends on the atoms of the system. For instance the simplest one, 6 branches are 3 acoustic and 3 optic. 3 modes are Z direction, transverse , longitudinal. Assume you have 4 atoms in one u.c. (simple example), A, A, B,C, unlike graphene (A, A), changing A to another A gets back to same result, here two A are no longer the same (which is definitely related to symmetry). The AB, AC difference is then revealed as another 3 branches.  <br /> <br />     As to semiconductor, I don't think there is special setting. Mainly, the occupation of electrons are in k-space, not real space, so it should affect little to atom movement. But there does have something special for the k-mesh. Different crystal symmetry can perform better with a proper choice of k-grids. <br /><br />    So far as I see you might want to compare the Raman with and without the additional layer. That's a good idea. <br /><br />Cheers!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: phonon dispersion of graphane</h3>
				<div class="date">Posted: <strong>Wed Jul 11, 2012 12:10 pm</strong></div>
				<div class="author">by <strong>samabdel</strong></div>
				<div class="content">Dear Ludwig,<br />Sorry if my statement was not clear!<br />Indeed, I have just to add a line (with the complete qpts-data input): kptop11 1 as follows:<br /># phonons<br />prtvol 3<br />ndtset 28<br />udtset 14 2<br /># ground state<br />#Dataset 1 : SCF<br />#Chksymbreak 0<br />#rfasr 2<br />  getden 11<br />  getwfk 11<br />  kptopt 3<br /># Response Function calculation<br /># qpt generation<br />   nqpt  1<br />   qptopt 1<br />   ngqpt 10 10 1<br />   nshiftq 1<br />   shiftq 0.0 0.0 0.0<br />   iqpt:? 1<br />   iqpt+? 1<br />#Dataset 11 : SCF<br />  getden11  0<br />  getwfk11  0<br />    iscf11  7<br />    nqpt11  0<br />   prtden11  1<br />--&gt;   kptopt11 1<br />         ----<br />-------------------------<br />If you compare this input to the previous one (the one with negative G-frequency) you find that the only difference is that for the previous setting I had: kptopt 3, but for the correct one (the present one): kptopt 3 with kptopt11 1 (which correspond to the Gamma point).<br />Thanks,<br />Sam</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=1673&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:51:40 GMT -->
</html>
