<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=2903&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:18:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Running Abinit MPI+OpenMP on BlueGene/Q</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Running Abinit MPI+OpenMP on BlueGene/Q</h2>
		<p><a href="viewtopicecd1.html?f=3&amp;t=2903">https://forum.abinit.org/viewtopic.php?f=3&amp;t=2903</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Running Abinit MPI+OpenMP on BlueGene/Q</h3>
				<div class="date">Posted: <strong>Wed Jan 14, 2015 2:21 pm</strong></div>
				<div class="author">by <strong>mlawson</strong></div>
				<div class="content">Dear abinit users and developers, <br /><br />I'm trying to use the MPI+OpenMP-compiled version of Abinit-7.10.2 on a BG/Q. <br />The calculations start correctly but the number of threads per MPI task doesn't <br />seem to be retrieved/set correctly: <br /><br />    ==== OpenMP parallelism is ON ====<br />  - Max_threads:       1<br />  - Num_threads:      1<br />  - Num_procs:         1<br />  - Dynamic:             F<br />  - Nested:               F<br /><br />The calculations are launched as follows: <br /><br />  runjob  --np 256 --ranks-per-node 4 --envs &quot;OMP_NUM_THREADS=8&quot; : abinit &lt; calc.files &gt; calc.log<br /><br />I also noticed in the log file that the parameter max_nthreads is set to 1: <br /><br />  - outvars: echo of global parameters not present in the input file              <br />  -  max_nthreads =    1<br /><br />Am I missing something obvious? Thanks in advance for your help. <br /><br />Best regards,<br />Max<br /><br />PS. Please find below the biuld information <br /><br /> === Build Information === <br />  Version       : 7.10.2<br />  Build target  : powerpc64_linux_ibm14.1<br />  Build date    : 20150113<br /> <br /> === Compiler Suite === <br />  C compiler       : ibm12.1<br />  C++ compiler     : ibm12.1<br />  Fortran compiler : ibm14.1<br />  CFLAGS           :  -g -O3 -qarch=auto -qtune=auto -qstrict -qspill=2000<br />  CXXFLAGS         :  -g -O3 -qarch=auto -qtune=auto -qstrict -qspill=2000 -qessl<br />  FCFLAGS          :  -g -qzerosize -F/home/lawson/apps/abinit/misc/xlf.cfg -qsmp<br />  FC_LDFLAGS       :     -Wl,--allow-multiple-definition<br /> <br /> === Optimizations === <br />  Debug level        : basic<br />  Optimization level : standard<br />  Architecture       : ibm_powerpc64<br /> <br /> === Multicore === <br />  Parallel build : yes<br />  Parallel I/O   : yes<br />  openMP support : yes<br />  GPU support    : no<br /> <br /> === Connectors / Fallbacks === <br />  Connectors on : yes<br />  Fallbacks on  : yes<br />  DFT flavor    : libxc-fallback+wannier90-fallback<br />  FFT flavor    : fftw3<br />  LINALG flavor : custom<br />  MATH flavor   : none<br />  TIMER flavor  : abinit<br />  TRIO flavor   : none<br /> <br /> === Experimental features === <br />  Bindings            : @enable_bindings@<br />  Exports             : no<br />  GW double-precision : no</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Running Abinit MPI+OpenMP on BlueGene/Q</h3>
				<div class="date">Posted: <strong>Thu Jan 22, 2015 6:03 pm</strong></div>
				<div class="author">by <strong>pouillon</strong></div>
				<div class="content">From what you say, the problem is likely coming from your run-time environment, not from Abinit. You might have to tune more parameters of your runjob script to fully enable OpenMP. Feel free to ask your system administrator should you have any doubt.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=2903&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:18:02 GMT -->
</html>
