<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=595&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:42:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Responce calculations and PAW datasets</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Responce calculations and PAW datasets</h2>
		<p><a href="viewtopic6a85.html?f=10&amp;t=595">https://forum.abinit.org/viewtopic.php?f=10&amp;t=595</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Responce calculations and PAW datasets</h3>
				<div class="date">Posted: <strong>Wed Sep 15, 2010 7:19 pm</strong></div>
				<div class="author">by <strong>ruslan</strong></div>
				<div class="content">Hello, abinit users!<br /><br />I am trying to do a responce calculation with PAW potentials. Converging density is quickly done but the problem occurs when i try to converge wavefunctions using iscf -3<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># 2. converge responce to d/dk<br />iscf1 -3<br />kptopt1 2<br />rfphon1 0<br />rfelfd1 2<br />tolwfr1 1.0d-22<br /><br /># 3. responce to Q=0<br />getddk2 2<br />kptopt2 2<br />rfelfd2 3<br /></code></pre></div><br />It seems, that the system does not converge at all, as can be seen in output<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; &nbsp; &nbsp;iter&nbsp; &nbsp;2DEtotal(Ha)&nbsp; &nbsp; &nbsp; &nbsp; deltaE(Ha) residm&nbsp; &nbsp; vres2<br />-ETOT&nbsp; 1&nbsp; -45.736192492181&nbsp; &nbsp; &nbsp;-4.574E+01 7.977E-01 0.000E+00<br />&nbsp;ETOT&nbsp; 2&nbsp; -46.354527419797&nbsp; &nbsp; &nbsp;-6.183E-01 5.299E-01 0.000E+00<br />&nbsp;ETOT&nbsp; 3&nbsp; -46.401130927362&nbsp; &nbsp; &nbsp;-4.660E-02 1.272E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 4&nbsp; -46.397162406766&nbsp; &nbsp; &nbsp; 3.969E-03 1.191E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 5&nbsp; -46.398055674238&nbsp; &nbsp; &nbsp;-8.933E-04 1.497E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 6&nbsp; -46.347604885697&nbsp; &nbsp; &nbsp; 5.045E-02 2.263E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 7&nbsp; -46.358587559944&nbsp; &nbsp; &nbsp;-1.098E-02 2.309E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 8&nbsp; -46.318810908718&nbsp; &nbsp; &nbsp; 3.978E-02 3.369E+00 0.000E+00<br />&nbsp;ETOT&nbsp; 9&nbsp; -46.298235890568&nbsp; &nbsp; &nbsp; 2.058E-02 2.828E+00 0.000E+00<br />&nbsp;ETOT 10&nbsp; -46.277683366679&nbsp; &nbsp; &nbsp; 2.055E-02 4.298E+00 0.000E+00<br />&nbsp;ETOT 11&nbsp; -46.275402375590&nbsp; &nbsp; &nbsp; 2.281E-03 3.143E+00 0.000E+00<br />&nbsp;ETOT 12&nbsp; -46.220355643065&nbsp; &nbsp; &nbsp; 5.505E-02 5.058E+00 0.000E+00<br />&nbsp;ETOT 13&nbsp; -46.238456591518&nbsp; &nbsp; &nbsp;-1.810E-02 3.807E+00 0.000E+00<br />&nbsp;ETOT 14&nbsp; -46.206598389753&nbsp; &nbsp; &nbsp; 3.186E-02 5.678E+00 0.000E+00<br />&nbsp;ETOT 15&nbsp; -46.186604453668&nbsp; &nbsp; &nbsp; 1.999E-02 4.359E+00 0.000E+00<br />&nbsp;ETOT 16&nbsp; -46.172633619957&nbsp; &nbsp; &nbsp; 1.397E-02 6.182E+00 0.000E+00<br />&nbsp;ETOT 17&nbsp; -46.177863714078&nbsp; &nbsp; &nbsp;-5.230E-03 4.804E+00 0.000E+00<br />&nbsp;ETOT 18&nbsp; -46.132110261736&nbsp; &nbsp; &nbsp; 4.575E-02 6.591E+00 0.000E+00<br />&nbsp;ETOT 19&nbsp; -46.153101989510&nbsp; &nbsp; &nbsp;-2.099E-02 5.201E+00 0.000E+00<br />&nbsp;ETOT 20&nbsp; -46.121826117739&nbsp; &nbsp; &nbsp; 3.128E-02 6.923E+00 0.000E+00<br />&nbsp;ETOT 21&nbsp; -46.114789289932&nbsp; &nbsp; &nbsp; 7.037E-03 5.609E+00 0.000E+00<br />&nbsp;ETOT 22&nbsp; -46.107450928316&nbsp; &nbsp; &nbsp; 7.338E-03 7.191E+00 0.000E+00<br />&nbsp;ETOT 23&nbsp; -46.114623621245&nbsp; &nbsp; &nbsp;-7.173E-03 5.963E+00 0.000E+00<br />&nbsp;ETOT 24&nbsp; -46.070461895234&nbsp; &nbsp; &nbsp; 4.416E-02 7.408E+00 0.000E+00<br />&nbsp;ETOT 25&nbsp; -46.097296090667&nbsp; &nbsp; &nbsp;-2.683E-02 6.266E+00 0.000E+00<br />&nbsp;ETOT 26&nbsp; -46.077519928066&nbsp; &nbsp; &nbsp; 1.978E-02 7.584E+00 0.000E+00<br />&nbsp;ETOT 27&nbsp; -46.069253403734&nbsp; &nbsp; &nbsp; 8.267E-03 6.523E+00 0.000E+00<br />&nbsp;ETOT 28&nbsp; -46.062380503081&nbsp; &nbsp; &nbsp; 6.873E-03 7.727E+00 0.000E+00<br />&nbsp;ETOT 29&nbsp; -46.076245680092&nbsp; &nbsp; &nbsp;-1.387E-02 6.738E+00 0.000E+00<br />....<br /></code></pre></div><br />Is it a general limitation of current abinit implementation or am i missing some option?<br /><br />Second question is more general and regards doing responce calculations with wavefunctions loaded from _WFK file (.fhi pseudopotentials). Restarting produces get following warning:<br /><blockquote class="uncited"><div>-P-0000  hdr_check: WARNING -<br />-P-0000   Restart of self-consistent calculation need translated wavefunctions.<br />-P-0000   Indeed, critical differences between current calculation and<br />-P-0000   restart file have been detected in:<br />-P-0000         * the number, position, or weight of k-points<br />-P-0000         * the format of wavefunctions (istwfk)<br /></div></blockquote><br />allthough i set istwfk *1 during initial run. Is this warning rather harmless or does it have negative consequences regarding calculations? Is there a way to get rid of this warning? Till now i did RF calculations this way:<br />- convergence of density with kptopt 3 and shiftk 0 0 0 to produce _WFK input file (can i take advantage of  symmetry in this run? should i converge wavefunctions with iscf -2 afterwards?)<br />- individual runs for each q-point with irdwfk 1 and kptopt 3<br /><br />Third question is about number of grid points in responce calculation. I found that responce calculations for my system with ngkpt&gt;12 cannot be done due to Out-of-Memory errors (a job with 96 processors on cray XT6m for q=0.5,0.5,0 of A15 structure):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;newkpt: loop on k-points done in parallel<br />aborting job:<br />Fatal error in MPIDI_CRAY_SMPClus_Allreduce: Other MPI error, error stack:<br />MPIDI_CRAY_SMPClus_Allreduce(209): MPIDI_CRAY_SMPClus_Allreduce(sendbuf=0x2aaaf52db010, recvbuf=0x2aaafef1c010, count=20480000, type=MPI_DOUBLE_PRECISION, op=MPI_SUM, comm=MPI_COMM_WORLD) failed<br />MPIR_Allreduce(193)..............: Unable to allocate 163840000 bytes of memory for temporary buffer (probably out of memory)<br />&#91;NID 00171&#93; 2010-08-19 14:46:56 Apid 19696: initiated application termination<br />Application 19696 exit codes: 1<br />Application 19696 exit signals: Killed<br />Application 19696 resources: utime 0, stime 0<br /></code></pre></div><br />Increasing number of processors did not really help. What can be done to reduce memory needs of this calculation?<br /><br />Any help is appreciated,<br />Ruslan Zinetullin</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Responce calculations and PAW datasets</h3>
				<div class="date">Posted: <strong>Fri Sep 17, 2010 10:39 am</strong></div>
				<div class="author">by <strong>ruslan</strong></div>
				<div class="content">Additionally, during a RF calculation for Gamma point i get strange error from rhofermi3:<br /><blockquote class="uncited"><div> scfcv3, nstep=         200<br /> scfcv3, nstep=         200<br /> scfcv3, nstep=         200<br /> scfcv3, nstep=         200<br /><br /> rhofermi3 :  ERROR -<br />  Not yet allowed within PAW !<br />-P-0000<br />-P-0000  leave_new : decision taken to exit ...<br /></div></blockquote><br />Calculations with q/=0 are currently running without problems. What should i do to get q=0,0,0 working? <br /><br />I also wanted to mention, that a parameter pawxcdev had to be set to zero to get PAW RF running. I think it should be documented somewhere, at least in the description of it.<br /><br />Greetings,<br />Ruslan Zinetullin</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Responce calculations and PAW datasets</h3>
				<div class="date">Posted: <strong>Fri Sep 17, 2010 11:15 am</strong></div>
				<div class="author">by <strong>ruslan</strong></div>
				<div class="content">Responce calculations for q/=Gamma stopped with following error:<br /><blockquote class="uncited"><div>-P-0000 - newkpt: read input wf with ikpt,npw=  76    7556, make ikpt,npw=  10    7556<br />-P-0000 - newkpt: read input wf with ikpt,npw=  77    7522, make ikpt,npw=  11    7522<br />-P-0000  leave_test : synchronization done...<br /> newkpt: loop on k-points done in parallel<br /> pareigocc : MPI_ALLREDUCE<br /><br /><br /> Subroutine Unknown:0:BUG<br />  Does not support idir&gt;0 for that choice.<br />  Action : contact ABINIT group.<br /><br />.Delivered    1 WARNINGs and   0 COMMENTs to log file.<br /></div></blockquote><br /><br />any suggestions?<br /><br />Ruslan Zinetullin</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Responce calculations and PAW datasets</h3>
				<div class="date">Posted: <strong>Mon Sep 20, 2010 10:51 am</strong></div>
				<div class="author">by <strong>torrent</strong></div>
				<div class="content">Dear Ruslan,<br /><br />Response calculations are still not open within PAW in the official version and GIVE WRONG RESULTS !<br /><br />The developper team is currently testing and correcting this implementation.<br /><br />See releases notes :<br /><blockquote class="uncited"><div>D.4 The use of Density Functional Perturbation Theory with PAW<br />    (phonons and electric field) is in progress&quot;<br /></div></blockquote><br /><br />Keep in touch... <br />and have a look in releases notes in next versions.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=595&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:42:09 GMT -->
</html>
