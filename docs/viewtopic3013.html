<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=2415&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:47:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Ground state wavefunction of H atom not spherical symmetric?</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Ground state wavefunction of H atom not spherical symmetric?</h2>
		<p><a href="viewtopic5196-3.html?f=9&amp;t=2415">https://forum.abinit.org/viewtopic.php?f=9&amp;t=2415</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Ground state wavefunction of H atom not spherical symmetric?</h3>
				<div class="date">Posted: <strong>Wed Feb 05, 2014 2:10 am</strong></div>
				<div class="author">by <strong>kingkingred</strong></div>
				<div class="content">Dear all,<br />I just copied the code in tutorial 2.4 (<a href="http://www.abinit.org/documentation/helpfiles/for-v7.6/tutorial/lesson_base2.html#24" class="postlink">http://www.abinit.org/documentation/helpfiles/for-v7.6/tutorial/lesson_base2.html#24</a>), in which dataset1 deals with H2 molecule and dataset2 deals with an isolated H atom. I used xcrysden to plot the real part of WFK file of dataset2. It's completely not spherically symmetric. It's hard to understand since the nondegenerate 1s ground state (even for the real part) should be spherically symmetric. However, other results seem to be good. And the density is indeed spherical symmetric. Could you please help me on this?<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># H2 molecule in a big box<br />#<br /># This file to optimize the H2 bond length, compute the associated total<br /># energy, then to compute the total energy of the isolated H atom.<br /># Here, the ecut and acell are fixed : the double loop reduces <br /># effectively to a single loop.<br /><br />ndtset 2&nbsp; udtset 1 2<br /><br />#Definition of the unit cell and ecut, <br />#for which one will have to make a convergence study<br />&nbsp;acell:? 12 12 12&nbsp; acell+? 2 2 2 <br />&nbsp;ecut 30<br /><br />#First dataset : find the optimal bond length of H2, and associated total energy<br />&nbsp; &nbsp;natom?1 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# There are two atoms<br />&nbsp; ionmov?1 3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Use the modified Broyden algorithm<br />&nbsp; &nbsp;ntime?1 10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximum number of Broyden &quot;timesteps&quot;<br />&nbsp; tolmxf?1 5.0d-4&nbsp; &nbsp; &nbsp; &nbsp; # Stopping criterion for the geometry optimization : when <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# the residual forces are less than tolmxf, the Broyden <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# algorithm can stop<br />&nbsp; &nbsp;xcart?1 -0.7&nbsp; 0.0 0.0 # The starting values of the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.7&nbsp; 0.0 0.0 # atomic coordinates<br />&nbsp; toldff?1 5.0d-5&nbsp; &nbsp; &nbsp; &nbsp; # Will stop the SCF cycle when, twice in a row, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# the difference between two consecutive evaluations of<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# forces differ by less than toldff (in Hartree/Bohr)<br />&nbsp; &nbsp;nband?1&nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Just one band<br /><br />#Second dataset : get the total energy of the isolated atom<br />&nbsp; &nbsp;natom?2 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# There is one atom<br />&nbsp; nsppol?2 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Spin-polarized calculation<br />&nbsp; occopt?2 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Allow occupation numbers to be set by hand<br />&nbsp; &nbsp;nband?2 1 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Number of bands for spin up and spin down<br />&nbsp; &nbsp; &nbsp;occ?2 1.0&nbsp; 0.0&nbsp; &nbsp; &nbsp; # Occupation numbers for spin up state and spin down state.<br />&nbsp; toldfe?2 1.0d-6&nbsp; &nbsp; &nbsp; &nbsp; # Will stop the SCF cycles when, twice in a row, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# the difference between two consecutive evaluations <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# of total energy differ by less than toldfe (in Hartree)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# This value is way too large for most realistic studies of materials<br />&nbsp; &nbsp;xcart?2 0.0 0.0 0.0&nbsp; &nbsp;# The atom is located at the origin<br />&nbsp; spinat?2 0.0 0.0 1.0&nbsp; &nbsp;# Initialisation of spin<br /><br />#rprim 1 0 0&nbsp; 0 1 0&nbsp; 0 0 1 # This line, defining orthogonal primitive vectors,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# is commented, because it is precisely the default value of rprim<br /><br />#Definition of the atom types<br />ntypat 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # There is only one type of atom<br />znucl 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# The keyword &quot;znucl&quot; refers to the atomic number of the <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # possible type(s) of atom. The pseudopotential(s) <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # mentioned in the &quot;files&quot; file must correspond<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # to the type(s) of atom. Here, the only type is Hydrogen.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /><br />#Definition of the atoms<br />typat 1 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# For the first dataset, both numbers will be read,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # while for the second dataset, only one number will be read<br /><br />#Definition of the k-point grid<br />kptopt 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Enter the k points manually <br />nkpt 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Only one k point is needed for isolated system,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # taken by default to be 0.0 0.0 0.0<br /><br />#Definition of the SCF procedure<br />nstep 10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Maximal number of SCF cycles<br />#toldfe is no more defined, as toldff is used above... <br />diemac 1.0&nbsp; &nbsp; &nbsp; &nbsp; # Although this is not mandatory, it is worth to<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # precondition the SCF cycle. The model dielectric<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # function used as the standard preconditioner<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # is described in the &quot;dielng&quot; input variable section.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Here, we follow the prescriptions for molecules<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # in a big box<br /># add to conserve old &lt; 6.7.2 behavior for calculating forces at each SCF step<br />&nbsp;optforces 1<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Ground state wavefunction of H atom not spherical symmet</h3>
				<div class="date">Posted: <strong>Thu Feb 06, 2014 2:33 pm</strong></div>
				<div class="author">by <strong>gmatteo</strong></div>
				<div class="content"><blockquote class="uncited"><div>I used xcrysden to plot the real part of WFK file of dataset2. <br /></div></blockquote><br /><br />How did you extract the real part? <br />I used cut3d and vesta to plot the norm of the 1s state and it's spherically symmetric as expected (see attached file)<br />Besides, in dataset12, one has n(r) = |psi_{1s}(r)|^2 so it seems strange that you have a spherically symmetric density whereas psi_{1s} is not!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Ground state wavefunction of H atom not spherical symmet</h3>
				<div class="date">Posted: <strong>Thu Feb 06, 2014 2:50 pm</strong></div>
				<div class="author">by <strong>kingkingred</strong></div>
				<div class="content"><blockquote><div><cite>gmatteo wrote:</cite><blockquote class="uncited"><div>I used xcrysden to plot the real part of WFK file of dataset2. <br /></div></blockquote><br /><br />How did you extract the real part? <br />I used cut3d and vesta to plot the norm of the 1s state and it's spherically symmetric as expected (see attached file)<br />Besides, in dataset12, one has n(r) = |psi_{1s}(r)|^2 so it seems strange that you have a spherically symmetric density whereas psi_{1s} is not!</div></blockquote><br /><br /><br />cut3d just provides the 'real part' option when it processes the unformatted WFK file.<br />Indeed, that's why I posted it here.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Ground state wavefunction of H atom not spherical symmet</h3>
				<div class="date">Posted: <strong>Thu Feb 06, 2014 3:33 pm</strong></div>
				<div class="author">by <strong>gmatteo</strong></div>
				<div class="content">There was a bug if that particular option was selected (Xcrysden uses general grids, see <!-- m --><a class="postlink" href="http://www.xcrysden.org/doc/XSF.html#scalar-field">http://www.xcrysden.org/doc/XSF.html#scalar-field</a><!-- m -->)<br /><br />This patch should solve the problem. Alternatively, you can get the new version of wffile.F90 attached to this reply.<br />(I had to replace the F90 extension with log to upload the file. Replace .log with .F90, put the file in src/83_cut3d and recompile with make)<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code><br />=== modified file 'src/83_cut3d/wffile.F90'<br />--- src/83_cut3d/wffile.F90&nbsp; &nbsp; &nbsp;2013-01-23 13:57:47 +0000<br />+++ src/83_cut3d/wffile.F90&nbsp; &nbsp; &nbsp;2014-02-06 14:15:20 +0000<br />@@ -950,6 +950,7 @@<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shift_tau(:) = 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read (*,*) outputchar<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (outputchar == 'y' .or. outputchar == 'Y') then<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MSG_ERROR(&quot;Shift is buggy, don't use it&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(std_out,*) 'Give the three shifts (x,y,z &lt; ',nr1,nr2,nr3,') :'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(std_out,*)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read (*,*) gridshift1, gridshift2, gridshift3<br />@@ -1109,6 +1110,7 @@<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shift_tau(:) = 0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read (*,*) outputchar<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (outputchar == 'y' .or. outputchar == 'Y') then<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MSG_ERROR(&quot;Shift is buggy, don't use it&quot;)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(std_out,*) 'Give the three shifts (x,y,z &lt; ',nr1,nr2,nr3,') :'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(std_out,*)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; read (*,*) gridshift1, gridshift2, gridshift3<br />@@ -1165,16 +1167,19 @@<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(unout,'(1X,A)') 'BEGIN_BLOCK_DATAGRID3D'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(unout,*) 'datagrids'<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(unout,'(1X,A)') 'DATAGRID_3D_DENSITY'<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write(unout,*) nr1,nr2,nr3<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write(unout,*) nr1+1,nr2+1,nr3+1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(unout,*) '0.0 0.0 0.0 '<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do ir1 = 1,3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; write(unout,'(3(ES17.10,2X))') (Bohr_Ang*rprimd(ir2,ir1), ir2=1,3)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end do<br />&nbsp;<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir3=1,nr3<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir2=1,nr2<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir1=1,nr1<br />-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write(unout,'(ES17.10)') fofr(1,ir1,ir2,ir3)<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir3=1,nr3+1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ii3=mod(ir3-1,nr3) + 1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir2=1,nr2+1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ii2=mod(ir2-1,nr2) + 1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;do ir1=1,nr1+1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ii1=mod(ir1-1,nr1) + 1<br />+&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;write(unout,'(ES17.10)') fofr(1,ii1,ii2,ii3)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end do<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end do<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end do<br /></code></pre></div></div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=2415&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:47:56 GMT -->
</html>
