<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1776&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:50:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Parallelism in the linear-response not working</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Parallelism in the linear-response not working</h2>
		<p><a href="viewtopic7568-2.html?f=10&amp;t=1776">https://forum.abinit.org/viewtopic.php?f=10&amp;t=1776</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Parallelism in the linear-response not working</h3>
				<div class="date">Posted: <strong>Thu Jul 26, 2012 1:31 am</strong></div>
				<div class="author">by <strong>nbod</strong></div>
				<div class="content"><div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><img src="images/upload_icons/txt.gif" alt="" /> <a class="postlink" href="download/file683e.php?id=589">trf2_1.in</a></dt>
						<dd>(4.73 KiB) Downloaded 354 times</dd>
		</dl>
		
		
			</div>Dear abinit users, <br /><br />I have been trying to calculated phonon frequencies, band structures and eventually thermal properties of quartz SiO2 using the parallel version of abinit. During the step where the generation of DDB's is taking place my calculation fails. I do not know whether it has to do with the way the parallel environment is set up or the input file itself. Here I am attaching my input file. The output file is too heavy to attach so I will only copy and paste the end of it. Any input is very appreciated!!<br />In the output file the MPI setting show the following: <br />=== MPI === <br />  Parallel build : yes<br />  Parallel I/O   : yes<br />  Time tracing   : no<br />  GPU support    : no<br /><br />Should parallel I/O be activated or not? <br /><br />Also, the following warning : <br /><br />distrb2: WARNING -<br />  nproc_kpt=  16 &gt;= nkpt=  10* nsppol=   1<br />  The number of processors is larger than nkpt. This is a waste.<br /> invars1: mkmem  undefined in the input file. Use default mkmem  = nkpt<br /> invars1: With nkpt_me=    1 and mkmem  =    10, ground state wf handled in core.<br /> Resetting mkmem  to nkpt_me to save memory space.<br /><br />Here is the end of the output file: <br /><br />--------------------------------------------------------------------------------<br /> Perturbation wavevector (in red.coord.)   0.000000  0.000000  0.000000<br /> Perturbation : displacement of atom   5   along direction   1<br />  loper3 2 nkpt          16<br /> insy3 : only one element in the set of symmetries for this perturbation :<br />   1   0   0   0   1   0   0   0   1<br /> symatm: atom number     1 is reached starting at atom<br />   1<br /> symatm: atom number     2 is reached starting at atom<br />   2<br /> symatm: atom number     3 is reached starting at atom<br />   3<br /> symatm: atom number     4 is reached starting at atom<br />   4<br /> symatm: atom number     5 is reached starting at atom<br />   5<br /> symatm: atom number     6 is reached starting at atom<br />   6<br /> symatm: atom number     7 is reached starting at atom<br />   7<br /> symatm: atom number     8 is reached starting at atom<br />   8<br /> symatm: atom number     9 is reached starting at atom<br />   9<br /> symkpt : not enough symmetry to change the number of k points.<br /> getmpw: optimal value of mpw=    4402<br />kpgio: loop on k-points done in parallel<br /> inwffil : before hdr_check <br /> inwffil : examine the header of disk file trf2_1o_DS1_WFK<br />-P-0000<br />-P-0000 ================================================================================<br />-P-0000<br />-P-0000           - hdr_check: checking restart file header for consistency -<br />-P-0000<br />-P-0000<br />-P-0000         current calculation                         restart file<br />-P-0000         -------------------                         ------------<br />-P-0000<br />-P-0000   calculation expects a wf_planewave    |  input file contains a wf_planewave<br />-P-0000 . ABINIT  code version 6.12.3           |  ABINIT  code version 6.12.3<br />-P-0000 . date 20120719 bantot  416 natom    9  |  date 20120719 bantot  260 natom    9<br />-P-0000   nkpt  16 nsym  2 ngfft  45,  45,  48  |  nkpt  10 nsym  2 ngfft  45,  45,  48<br />-P-0000   ntypat  2 ecut_eff  24.0000000        |  ntypat  2 ecut_eff  24.0000000<br />-P-0000   usepaw  0                             |  usepaw  0<br />-P-0000   usewvl  0                             |  usewvl  0<br />-P-0000   rprimd:                               |  rprimd:<br />-P-0000      9.3824902   0.0000000   0.0000000  |     9.3824902   0.0000000   0.0000000<br />-P-0000     -4.6912451   8.1254749   0.0000000  |    -4.6912451   8.1254749   0.0000000<br />-P-0000      0.0000000   0.0000000  10.2498745  |     0.0000000   0.0000000  10.2498745<br />-P-0000<br />-P-0000  hdr_check: WARNING -<br />-P-0000   input nkpt=      16 not equal disk file nkpt=      10<br />-P-0000   symafm:                               |  symafm:<br />-P-0000     1  1                                |    1  1<br />-P-0000   symrel:                               |  symrel:<br />-P-0000     1  0  0  0  1  0  0  0  1           |    1  0  0  0  1  0  0  0  1<br />-P-0000     0  1  0  1  0  0  0  0 -1           |    0  1  0  1  0  0  0  0 -1<br />-P-0000   typat:                                |  typat:<br />-P-0000     1  1  1  2  2  2  2  2  2           |    1  1  1  2  2  2  2  2  2<br />-P-0000   so_psp  :                             |  so_psp  :<br />-P-0000     1  1                                |    1  1<br />-P-0000   tnons:                                |  tnons:<br />-P-0000      0.0000000   0.0000000   0.0000000  |     0.0000000   0.0000000   0.0000000<br />-P-0000     -0.0000000   0.0000000  -0.0000000  |    -0.0000000   0.0000000  -0.0000000<br />-P-0000    znucl:                               |   znucl:<br />-P-0000    14.00  8.00                          |   14.00  8.00<br />-P-0000   pseudopotential atom type  1:         |  pseudopotential atom type  1:<br />-P-0000   pspso   0 pspxc   1                   |  pspso   0 pspxc   1<br />-P-0000   pspdat 940714 pspcod    1 zion   4.0  |  pspdat 940714 pspcod    1 zion   4.0<br />-P-0000   pseudopotential atom type  2:         |  pseudopotential atom type  2:<br />-P-0000   pspso   0 pspxc   1                   |  pspso   0 pspxc   1<br />-P-0000   pspdat 940714 pspcod    1 zion   6.0  |  pspdat 940714 pspcod    1 zion   6.0<br />-P-0000   xred:                                 |  xred:<br />-P-0000      0.5248000   0.0000000   0.3333330  |     0.5248000   0.0000000   0.3333330<br />-P-0000     -0.0000000   0.5248000   0.6666670  |    -0.0000000   0.5248000   0.6666670<br />-P-0000      0.4752000   0.4752000   0.0000000  |     0.4752000   0.4752000   0.0000000<br />-P-0000      0.1570000   0.4160000   0.8768000  |     0.1570000   0.4160000   0.8768000<br />-P-0000      0.5840000   0.7410000   0.2101330  |     0.5840000   0.7410000   0.2101330<br />-P-0000      0.2590000   0.8430000   0.5434670  |     0.2590000   0.8430000   0.5434670<br />-P-0000      0.4160000   0.1570000   0.1232000  |     0.4160000   0.1570000   0.1232000<br />-P-0000      0.7410000   0.5840000   0.7898670  |     0.7410000   0.5840000   0.7898670<br />-P-0000      0.8430000   0.2590000   0.4565330  |     0.8430000   0.2590000   0.4565330<br />-P-0000<br />-P-0000  hdr_check: WARNING -<br />-P-0000   Restart of self-consistent calculation need translated wavefunctions.<br />-P-0000   Indeed, critical differences between current calculation and<br />-P-0000   restart file have been detected in:<br />-P-0000         * the number, position, or weight of k-points<br />-P-0000         * the format of wavefunctions (istwfk)<br />-P-0000 ================================================================================<br />-inwffil : will read wavefunctions from disk file trf2_1o_DS1_WFK<br />-P-0000  initwf : disk file gives npw=  4390 nband=    26 for kpt number=    1<br />-P-0000  initwf :    26 bands have been initialized from disk<br />-P-0000  leave_test : synchronization done...<br /> wfsinp: loop on k-points and spins done in parallel<br /> pareigocc : MPI_ALLREDUCE<br />-P-0000  leave_test : synchronization done...<br /> wfsinp: loop on k-points done in parallel<br />-P-0000 - newkpt: read input wf with ikpt,npw=   1    4390, make ikpt,npw=   1    4390<br />-P-0000  leave_test : synchronization done...<br /> newkpt: loop on k-points done in parallel<br /> pareigocc : MPI_ALLREDUCE<br /><br /> getmpw: optimal value of mpw=    4402<br />kpgio: loop on k-points done in parallel<br /> inwffil : before hdr_check <br /> inwffil : examine the header of disk file trf2_1o_DS1_WFK<br />-P-0000<br />-P-0000 ================================================================================<br />-P-0000<br />-P-0000           - hdr_check: checking restart file header for consistency -<br />-P-0000<br />-P-0000<br />-P-0000         current calculation                         restart file<br />-P-0000         -------------------                         ------------<br />-P-0000<br />-P-0000   calculation expects a wf_planewave    |  input file contains a wf_planewave<br />-P-0000 . ABINIT  code version 6.12.3           |  ABINIT  code version 6.12.3<br />-P-0000 . date 20120719 bantot  416 natom    9  |  date 20120719 bantot  260 natom    9<br />-P-0000   nkpt  16 nsym  2 ngfft  45,  45,  48  |  nkpt  10 nsym  2 ngfft  45,  45,  48<br />-P-0000   ntypat  2 ecut_eff  24.0000000        |  ntypat  2 ecut_eff  24.0000000<br />-P-0000   usepaw  0                             |  usepaw  0<br />-P-0000   usewvl  0                             |  usewvl  0<br />-P-0000   rprimd:                               |  rprimd:<br />-P-0000      9.3824902   0.0000000   0.0000000  |     9.3824902   0.0000000   0.0000000<br />-P-0000     -4.6912451   8.1254749   0.0000000  |    -4.6912451   8.1254749   0.0000000<br />-P-0000      0.0000000   0.0000000  10.2498745  |     0.0000000   0.0000000  10.2498745<br />-P-0000<br />-P-0000  hdr_check: WARNING -<br />-P-0000   input nkpt=      16 not equal disk file nkpt=      10<br />-P-0000   symafm:                               |  symafm:<br />-P-0000     1  1                                |    1  1<br />-P-0000   symrel:                               |  symrel:<br />-P-0000     1  0  0  0  1  0  0  0  1           |    1  0  0  0  1  0  0  0  1<br />-P-0000     0  1  0  1  0  0  0  0 -1           |    0  1  0  1  0  0  0  0 -1<br />-P-0000   typat:                                |  typat:<br />-P-0000     1  1  1  2  2  2  2  2  2           |    1  1  1  2  2  2  2  2  2<br />-P-0000   so_psp  :                             |  so_psp  :<br />-P-0000     1  1                                |    1  1<br />-P-0000   tnons:                                |  tnons:<br />-P-0000      0.0000000   0.0000000   0.0000000  |     0.0000000   0.0000000   0.0000000<br />-P-0000     -0.0000000   0.0000000  -0.0000000  |    -0.0000000   0.0000000  -0.0000000<br />-P-0000    znucl:                               |   znucl:<br />-P-0000    14.00  8.00                          |   14.00  8.00<br />-P-0000   pseudopotential atom type  1:         |  pseudopotential atom type  1:<br />-P-0000   pspso   0 pspxc   1                   |  pspso   0 pspxc   1<br />TACC: Cleaning up after job: 2698534<br />TACC: Done.<br /><br />Could that be also a reason why this calculation fails? <br />Should I include such variables as npkpt npband in my input file?? Please help!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Parallelism in the linear-response not working</h3>
				<div class="date">Posted: <strong>Thu Aug 02, 2012 8:22 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">well, I think your shiftk is not compatible with a primitive hexagonal cell as you have here. Do an initial run with kptrlen 60 (say), and prtkpt 1, so abinit can tell you what are good values for kptrlatt and shiftk for your system.Also, by the way, your kpt grid looks VERY coarse right now. Before doing a phonon calc I would make sure that the ground state stress is accurately converged with both ecut and kpt mesh.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1776&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:50:22 GMT -->
</html>
