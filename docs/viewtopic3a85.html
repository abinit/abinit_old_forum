<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=2657&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:52:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Compile abinit-7.6.3 with levmar library</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Compile abinit-7.6.3 with levmar library</h2>
		<p><a href="viewtopic57b4.html?f=3&amp;t=2657">https://forum.abinit.org/viewtopic.php?f=3&amp;t=2657</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Compile abinit-7.6.3 with levmar library</h3>
				<div class="date">Posted: <strong>Tue May 06, 2014 9:11 am</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear all<br />I'm trying to compile abinit-7.6.3 with the supporting levmar library on Rock_clusters-6.1.1/centos6.5/linux_x86_64. The compilers are as follows.  <br />$ gcc --version<br />gcc (GCC) 4.4.7 20120313 (Red Hat 4.4.7-4)<br />$ gfortran --version<br />GNU Fortran (GCC) 4.4.7 20120313 (Red Hat 4.4.7-4)<br />$ mpicc --version<br />gcc (GCC) 4.4.7 20120313 (Red Hat 4.4.7-4)<br />$ mpif90 --version<br />GNU Fortran (GCC) 4.4.7 20120313 (Red Hat 4.4.7-4)<br />$ mpirun --version<br />mpirun (Open MPI) 1.6.2<br /><br />In the configure step, I used <br /><br />$ ../abinit-7.6.3/configure --with-config-file=./build.ac --prefix=/export/home/thanusit/apps/gcc-4.4.7/abinit/7.6.3_try_levmar.<br /><br />The details of build.ac is listed below. The configure passed (config.log is attached) but make failed with the error: <br /><br />../../src/70_gw/lib70_gw.a(m_model_screening.o): In function `__m_model_screening_MOD_sequential_fitting':<br />/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/70_gw/../../../abinit-7.6.3/src/70_gw/m_model_screening.F90:479: undefined reference to `dfit_re_and_im_screening_'<br />collect2: ld returned 1 exit status.<br />(please see ==make's errors== below for more detais).<br /><br />However, if with_algo_flavor=&quot;levmar&quot; and the associating &quot;with_algo_incs&quot; and &quot;with_algo_libs&quot; flags were commented out, the make was succesful. This suggests that the other libraries are good and that the error has something to do with the attemp to use the levmar library. The levmar libray was installed via rpm using:levmar-devel-2.5-8.fc19.x86_64.rpm and levmar-2.5-8.fc19.x86_64.rpm. <br /><br />I dont know what I'm missing. Is the installed levmar library the right one for abinit? Is the gcc too old? Any suggestion would be greatly appreciated.<br /><br />Best Regards,<br />Thanusit<br /><br />==vi build.ac==<br />#enable_fallbacks=&quot;no&quot;<br />enable_exports=&quot;yes&quot;<br />enable_pkg_check=&quot;yes&quot;<br />enable_64bit_flags=&quot;yes&quot;<br />enable_gw_dpc=&quot;yes&quot;<br />enable_mpi=&quot;yes&quot;<br />enable_mpi_io=&quot;yes&quot;<br />with_mpi_prefix=&quot;/opt/openmpi&quot;<br />with_trio_flavor=&quot;netcdf+etsf_io+fox&quot;<br />with_netcdf_incs=&quot;-I/usr/include -I/usr/lib64/gfortran/modules&quot;<br />with_netcdf_libs=&quot;-L/usr/lib64 -lnetcdf -lnetcdff&quot;<br />with_fft_flavor=&quot;fftw3&quot;<br />with_fft_incs=&quot;-I/usr/include&quot;<br />with_fft_libs=&quot;-L/usr/lib64 -lfftw3 -lfftw3f&quot;<br />with_linalg_flavor=&quot;atlas&quot;<br />with_linalg_incs=&quot;-I/usr/include&quot;<br />with_linalg_libs=&quot;-L/usr/lib64/atlas -llapack -lf77blas -lcblas -latlas&quot;<br />with_algo_flavor=&quot;levmar&quot;<br />with_algo_incs=&quot;-I/usr/include&quot;<br />with_algo_libs=&quot;-L/usr/lib64 -llevmar&quot;<br />with_math_flavor=&quot;gsl&quot;<br />with_math_incs=&quot;-I/usr/include&quot;<br />with_math_libs=&quot;-L/usr/lib64 -lgsl -lgslcblas -lm&quot;<br />with_dft_flavor=&quot;atompaw+bigdft+libxc+wannier90&quot;<br />========================================================<br /><br />===make's errors====<br />...<br />Making all in 98_main<br />make[3]: Entering directory `/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/98_main'<br />/opt/openmpi/bin/mpif90 -m64 -DHAVE_CONFIG_H -I. -I../../../abinit-7.6.3/src/98_main -I../.. -I../../src/incs -I../../../abinit-7.6.3/src/incs -I/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/include   -I/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/include -I/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/include -I/usr/include -I/usr/lib64/gfortran/modules -I/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/include -I/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/include -I/usr/include -I/usr/include -I/usr/include -I/usr/include   -ffree-form -J/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/mods  -O2 -mtune=native -march=native -m64 -g -ffree-line-length-none -fPIC    -m64 -g -ffree-line-length-none -fPIC   -c -o abinit-abinit.o `test -f 'abinit.F90' || echo '../../../abinit-7.6.3/src/98_main/'`abinit.F90<br />/opt/openmpi/bin/mpif90 -m64 -ffree-form -J/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/mods  -O2 -mtune=native -march=native -m64 -g -ffree-line-length-none -fPIC    -m64 -g -ffree-line-length-none -fPIC     -o abinit abinit-abinit.o  ../../src/95_drive/lib95_drive.a ../../src/79_seqpar_mpi/lib79_seqpar_mpi.a ../../src/77_ddb/lib77_ddb.a ../../src/77_suscep/lib77_suscep.a ../../src/72_response/lib72_response.a ../../src/71_bse/lib71_bse.a ../../src/70_gw/lib70_gw.a ../../src/69_wfdesc/lib69_wfdesc.a ../../src/68_dmft/lib68_dmft.a  ../../src/68_recursion/lib68_recursion.a ../../src/68_rsprc/lib68_rsprc.a ../../src/67_common/lib67_common.a ../../src/66_paw/lib66_paw.a ../../src/66_wfs/lib66_wfs.a ../../src/65_psp/lib65_psp.a ../../src/65_nonlocal/lib65_nonlocal.a  ../../src/64_atompaw/lib64_atompaw.a ../../src/62_occeig/lib62_occeig.a ../../src/62_iowfdenpot/lib62_iowfdenpot.a ../../src/62_wvl_wfs/lib62_wvl_wfs.a ../../src/62_poisson/lib62_poisson.a ../../src/62_cg_noabirule/lib62_cg_noabirule.a ../../src/62_ctqmc/lib62_ctqmc.a ../../src/61_ionetcdf/lib61_ionetcdf.a ../../src/57_iovars/lib57_iovars.a ../../src/57_iopsp_parser/lib57_iopsp_parser.a ../../src/56_recipspace/lib56_recipspace.a ../../src/56_xc/lib56_xc.a ../../src/56_mixing/lib56_mixing.a ../../src/56_io_mpi/lib56_io_mpi.a ../../src/53_abiutil/lib53_abiutil.a ../../src/53_spacepar/lib53_spacepar.a ../../src/53_ffts/lib53_ffts.a  ../../src/52_fft_mpi_noabirule/lib52_fft_mpi_noabirule.a ../../src/51_manage_mpi/lib51_manage_mpi.a ../../src/49_gw_toolbox_oop/lib49_gw_toolbox_oop.a ../../src/47_xml/lib47_xml.a ../../src/45_geomoptim/lib45_geomoptim.a ../../src/44_abitypes_defs/lib44_abitypes_defs.a ../../src/43_wvl_wrappers/lib43_wvl_wrappers.a ../../src/43_ptgroups/lib43_ptgroups.a ../../src/42_parser/lib42_parser.a ../../src/42_nlstrain/lib42_nlstrain.a ../../src/42_libpaw/lib42_libpaw.a ../../src/41_xc_lowlevel/lib41_xc_lowlevel.a ../../src/41_geometry/lib41_geometry.a ../../src/32_util/lib32_util.a ../../src/28_numeric_noabirule/lib28_numeric_noabirule.a ../../src/27_toolbox_oop/lib27_toolbox_oop.a ../../src/21_psiesta_noabirule/lib21_psiesta_noabirule.a ../../src/18_timing/lib18_timing.a ../../src/16_hideleave/lib16_hideleave.a  ../../src/14_hidewrite/lib14_hidewrite.a ../../src/12_hide_mpi/lib12_hide_mpi.a ../../src/11_qespresso_ext/lib11_qespresso_ext.a ../../src/11_memory_mpi/lib11_memory_mpi.a ../../src/10_defs/lib10_defs.a  ../../src/01_linalg_ext/lib01_linalg_ext.a ../../src/01_interfaces_ext/lib01_interfaces_ext.a ../../src/01_gsl_ext/lib01_gsl_ext.a -L/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/lib -lwannier90 -L/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/lib -lbigdft -ldft_common -labinit -L/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/lib -letsf_io_low_level -letsf_io_utils -letsf_io -L/usr/lib64 -lnetcdf -lnetcdff -L/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/lib -lxc -L/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/fallbacks/exports/lib -lFoX_sax -lFoX_utils -lFoX_fsys -lFoX_common -L/usr/lib64 -lfftw3 -lfftw3f -L/usr/lib64 -lgsl -lgslcblas -lm -L/usr/lib64 -llevmar -L/usr/lib64/atlas -llapack -lf77blas -lcblas -latlas -lrt -L/opt/openmpi/lib -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7 -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../.. -lmpi_f90 -lmpi_f77 -lmpi -libverbs -ldat -lrt -lnsl -lutil -lgfortranbegin -lgfortran -lm -ldl -lpthread -L/opt/openmpi/lib -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7 -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-redhat-linux/4.4.7/../../.. -lmpi_f90 -lmpi_f77 -lmpi -libverbs -ldat -lrt -lnsl -lutil -lgfortranbegin -lgfortran -lm -ldl -lpthread <br />../../src/70_gw/lib70_gw.a(m_model_screening.o): In function `__m_model_screening_MOD_sequential_fitting':<br />/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/70_gw/../../../abinit-7.6.3/src/70_gw/m_model_screening.F90:479: undefined reference to `dfit_re_and_im_screening_'<br />collect2: ld returned 1 exit status<br />make[3]: *** [abinit] Error 1<br />make[3]: Leaving directory `/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src/98_main'<br />make[2]: *** [all-recursive] Error 1<br />make[2]: Leaving directory `/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar/src'<br />make[1]: *** [all-recursive] Error 1<br />make[1]: Leaving directory `/state/partition1/home/thanusit/src_build/abinit-7.6.3_build_dir_gcc-4.4.7_try_levmar'<br />make: *** [all] Error 2<br />=============================================================================</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Compile abinit-7.6.3 with levmar library</h3>
				<div class="date">Posted: <strong>Tue May 06, 2014 9:40 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content">hi,<br /><br />you must add in your build.ac file :<br /><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>enable_clib=&quot;yes&quot;</code></pre></div><br /><br />jmb</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Compile abinit-7.6.3 with levmar library&nbsp;&nbsp;<span style="color: #006600">[SOLVED]</span></h3>
				<div class="date">Posted: <strong>Wed May 07, 2014 6:47 pm</strong></div>
				<div class="author">by <strong>thanusit</strong></div>
				<div class="content">Dear jmb<br />Thank you for your suggestion. The flag enable_clib=&quot;yes&quot; did fix the above error. However, make still got a hiccup with another error:<br />------------------------------------------------------------------------------------<br /> ../../../abinit-7.6.3/src/98_main/mrgscr.F90:2313.15:<br /><br />           if (is_scr/=.true.) then<br />               1 <br />Error: Logicals at (1) must be compared with .neqv. instead of /=<br />make[3]: *** [mrgscr-mrgscr.o] Error 1.<br />------------------------------------------------------------------------------------<br /><br />As suggested in the error messege, I tried to fix this new error by making a slight modification to ../src/98_main/mrgscr.F90,  e.g.  <br />by replacing &quot;if (is_scr/=.true.) then&quot; with &quot;if (is_scr.neqv..true.) then&quot;, and the trick worked. &quot;make&quot; was successful. &quot;make tests&quot; were all succesful and &quot;./runtests.py fast&quot; gave:<br />---------------------------------------------------------------------------------------------------<br />Test suite completed in 27.24 s (average time for test = 2.35 s, stdev = 2.20 s)<br />failed: 0, succeeded: 10, passed: 1, skipped: 0, disabled: 0<br />Suite   failed  passed  succeeded  skipped  disabled  run_etime  tot_etime<br />fast         0       1         10        0         0      25.81      26.89<br /> --------------------------------------------------------------------------------------------------<br /><br />I'm no developer but hope that is a proper way of resolving it.<br /><br />Best regards,<br />Thanusit</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Compile abinit-7.6.3 with levmar library</h3>
				<div class="date">Posted: <strong>Wed May 07, 2014 7:48 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content">sorry Thanusit,<br /><br />I had the same problem and I forgot to mention it on my last post ! <br />the suggestion is correct : fix on the development branch…<br /><br />jmb</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=2657&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:52:35 GMT -->
</html>
