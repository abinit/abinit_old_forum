<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=14&t=729&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:50:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Zr pseudopotential</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Zr pseudopotential</h2>
		<p><a href="viewtopicc64e.html?f=14&amp;t=729">https://forum.abinit.org/viewtopic.php?f=14&amp;t=729</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Sun Nov 07, 2010 10:05 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content">Hi, All:<br />Thank you for a nice tutorial at <!-- m --><a class="postlink" href="http://www.abinit.org/documentation/helpfiles/for-v6.4/tutorial/lesson_paw2.html">http://www.abinit.org/documentation/hel ... _paw2.html</a><!-- m -->.<br />I am going to perform calculations of the tetragonal ZrO2-(12 mol. %)CeO2 system. Could you give me some hints about Zr pseudopotential generation. I've selected 4s<span style="font-size: 50%; line-height: 116%;">2</span>4p<span style="font-size: 50%; line-height: 116%;">6</span>4d<span style="font-size: 50%; line-height: 116%;">2</span>5s<span style="font-size: 50%; line-height: 116%;">2</span>5p<span style="font-size: 50%; line-height: 116%;">0</span> configuration as valence. Can I add two s functions to the 4s and 5s, or only one, or to avoid adding to them. If I need to add, then please tell me how to do it. Perhaps an electronic configuration that I chose (12 electrons) is too high? Yet I could only add to 4d, since my system does not have 3d. How do I add to the 4s and 5s, and should it be done?<br /><br />Here is my input:<br />Zr 40<br />GGA-PBE scalarrelativistic loggrid 700<br />5 5 4 0 0 0<br />4 2 2<br />5 1 0<br />0 0 0<br />c<br />c<br />c<br />v<br />v<br />c<br />c<br />v<br />v<br />c<br />v<br />2<br />2.4<br />n<br />n<br />y<br />0.<br />n<br />bloechl<br />3 0. troulliermartins<br />0<br /><br />How close should be the values &quot;evale&quot; and &quot;evale from matrix elements&quot; (-306.672<strong class="text-strong"><em class="text-italics">551210258</em></strong> and -306.672<strong class="text-strong"><em class="text-italics">645257582080</em></strong>   -is it enought?).<br />Do I chose the correct rpaw (the smallest Zr-O interatomic distance at ZrO2-(12 mol. %)CeO2 system  is   3.99 bohr,  rpaw for oxygen pseudopotential is 0.14 bohr).<br />Are my files wfn4 and wfn6 (wfn4.jpg and wfn6.jpg attached here) correct?<br /><br />Best regards,<br />Maxim.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Mon Nov 08, 2010 6:05 pm</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content">Hello Maxim,<br /><br />The 12e- valence configuration looks fine to me. If you plot the radial wavefunctions of Zr, you can see that only 4s 4p 4d and 5s have  significant contributions above 2 a.u. 3d is core. I would start with a rpaw between 1.9 to 2.2 a.u. 4s and 5s are valence; add at least one s projector. 4p is valence, you added 5p empty as valence then add one more p projector and probably add two projectors for d.<br /><br />For the valence electrons energy comparison, it looks fair to me - the closest the best.<br /><br />To add the four projectors as mentioned earlier. A quick test input for atompaw follows; it's better than a thousand words (maybe launch atompaw interactively to follow the meaning of the different parameters) ...<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Zr 40<br />GGA-PBE scalarrelativistic loggrid 800<br />5 5 4 0 0<br />4 2 2<br />5 1 0<br />0 0 0<br />c<br />c<br />c<br />v<br />v<br />c<br />c<br />v<br />v<br />c<br />v<br />2<br />2.2<br />y<br />5.0<br />n<br />y<br />6.0<br />n<br />y<br />2.0<br />y<br />6.0<br />n<br />Vanderbilt<br />3 0. ultrasoft<br />2.1<br />2.1<br />2.1<br />2.1<br />2.1<br />2.1<br />2.1<br />2.1<br />2.1<br />0<br /></code></pre></div><br /><br />Kind regards,<br /><br />Alain</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Mon Nov 08, 2010 7:10 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">First, for oxygen: do you really mean 0.14 Bohr? that's really small--maybe you mean 1.4 Bohr? Anyway, here is what I use mostly:<br /><br />O 8<br />GGA-PBE loggrid 1201<br />2 2 0 0 0 0<br />2 1 4<br />0 0 0<br />c<br />v<br />v<br />1<br />1.45<br />y<br />-0.676<br />n<br />y<br />-1.742<br />n<br />custom rrkj<br />2 0 ultrasoft<br />1.45<br />1.45<br />1.45<br />1.45<br />1<br />2 1 4<br />0 0 0<br />2<br />default<br />0<br /><br />Next, for Zr, the following is a good starting point:<br /><br />Zr 40<br />GGA-PBE scalarrelativistic loggrid 1200<br />5 5 4 0 0 0<br />4 2 2<br />5 0 2<br />5 1 0<br />0 0 0<br />c<br />c<br />c<br />v<br />v<br />c<br />c<br />v<br />v<br />c<br />v<br />2<br />2.5<br />n<br />n<br />y<br />2<br />n<br />custom polynom2 7 10.0 vanderbiltortho besselshape<br />3 0 ultrasoft<br />2.5<br />2.5<br />2.5<br />2.5<br />2.5<br />2.5<br />1<br />4 2 2 <br />5 0 2<br />5 1 0<br />0 0 0<br />2<br />default <br />0<br /><br />If you are not using the very recent release of atompaw you have to remove the two lines just before the end (2 \cr default).<br /><br />I tried the above pair on monoclinic ZrO2 and it seems to converge reasonably.<br /><br />Joe</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Mon Nov 08, 2010 11:25 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content">Dear jzwanzig and Alain_Jacques,<br />Thanks for your help.<br /><br />Of course, it was typo: rpaw for oxygen was 1.4 Bohr.<br /><br />Another question. Why if we have e. g. 6 basis functions, the atompaw produces 10 wfni files?<br />Also if we have the largest l=2 in our system, why atompaw produces logderiv.3?<br />Does these &quot;extra&quot; files have any important information?<br /><br />maxim</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Tue Feb 01, 2011 11:06 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content">Dear jzwanzig!<br />Ssory for this late reply.<br />I have just started working on this theme and I would like to know your opinion.<br />I have studied your dataset and found that:<br />1. the PS Partial waves and Projectors doesn't have the order of some units for the wfni files.<br />Do I have to do anything here?<br />2. the PS Partial wave and Projector don't have the same order of magnitude for the the wfn6 file and the logarithmic derivatives for l = 0 have a ghost state:<br /><div class="inline-attachment">
			
				<dl class="thumbnail">
			<dt><a href="download/filee0d9.jpg?id=270&amp;mode=view"><img src="download/file014c.jpg?id=270&amp;t=1" class="postimage" alt="1.jpg" title="1.jpg (23.75 KiB) Viewed 11055 times" /></a></dt>
					</dl>
		
		
		
		
			</div><br />Should I add the additional partial-wave here?<br /><br />I've tried to solve the ghost state problem. I have used the bessel scheme and r<span style="font-size: 85%; line-height: 116%;">vloc</span> = 2.0<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Zr 40<br />GGA-PBE scalarrelativistic loggrid 1200<br />5 5 4 0 0 0<br />4 2 2<br />5 0 2<br />5 1 0<br />0 0 0<br />c<br />c<br />c<br />v<br />v<br />c<br />c<br />v<br />v<br />c<br />v<br />2<br />2.5 2.5 2.0 2.5<br />n<br />n<br />y<br />2<br />n<br />custom polynom2 7 10.0 vanderbiltortho besselshape<br />3 0 bessel<br />2.5<br />2.5<br />2.5<br />2.5<br />2.5<br />2.5<br />1<br />4 2 2 <br />5 0 2<br />5 1 0<br />0 0 0<br />0<br /></code></pre></div><br />and here is what I got:<br /><div class="inline-attachment">
			
				<dl class="thumbnail">
			<dt><a href="download/filefce7.jpg?id=271&amp;mode=view"><img src="download/file237b.jpg?id=271&amp;t=1" class="postimage" alt="2.jpg" title="2.jpg (43.9 KiB) Viewed 11055 times" /></a></dt>
					</dl>
		
		
		
		
			</div><br />Using another method (setting rc = 1.8 for 4s<span style="font-size: 50%; line-height: 116%;">2</span>)<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Zr 40<br />GGA-PBE scalarrelativistic loggrid 1200<br />5 5 4 0 0 0<br />4 2 2<br />5 0 2<br />5 1 0<br />0 0 0<br />c<br />c<br />c<br />v<br />v<br />c<br />c<br />v<br />v<br />c<br />v<br />2<br />2.5<br />n<br />n<br />y<br />2<br />n<br />custom polynom2 7 10.0 vanderbiltortho besselshape<br />3 0 ultrasoft<br />1.8<br />2.5<br />2.5<br />2.5<br />2.5<br />2.5<br />1<br />4 2 2 <br />5 0 2<br />5 1 0<br />0 0 0<br />0<br /></code></pre></div><br />I've got this:<br /><div class="inline-attachment">
			
				<dl class="thumbnail">
			<dt><a href="download/file2162.jpg?id=272&amp;mode=view"><img src="download/file871e.jpg?id=272&amp;t=1" class="postimage" alt="3.jpg" title="3.jpg (41.86 KiB) Viewed 11055 times" /></a></dt>
					</dl>
		
		
		
		
			</div><br />Which variant is correct and how to deal with the wfn6 file?<br />Are these datasets ready for use in abinit?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Wed Feb 02, 2011 7:49 pm</strong></div>
				<div class="author">by <strong>blackburn</strong></div>
				<div class="content">Hi maxim,<br /><br />I recently made a pseudo for Zr. Here's the input for atompaw:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Zr 40<br />GGA-PBE loggrid 3001<br />5 5 4 0 0 0&nbsp; &nbsp;<br />4 2 2<br />5 0 2<br />5 1 0 <br />0 0 0 <br />c <br />c <br />c <br />v<br />v <br />c<br />c <br />v<br />v <br />c <br />v <br />2<br />3.2<br />y<br />5.0<br />n<br />n <br />y<br />2.0<br />n <br />VANDERBILT&nbsp; &nbsp;<br />3 0<br />2.0<br />5.0<br />2.5<br />3.0<br />2.0<br />2.0<br />2.0<br />0<br /></code></pre></div><br /><br />It has 12 electrons. It's probably not optimal but it worked great for the system I was interested in. The projectors should be good.<br /><br />Let me know if it helped / worked.<br /><br />Simon</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Thu Feb 03, 2011 9:21 am</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">First, to Maxim: in my experience the custom polynom2 choice is almost always best for transition metals (like Zr), but also this choice seems in general to give projectors with larger amplitudes. I don't know why (Marc Torrent or Natalie Holzwarth would know I'm sure) but in general they are still usable (unless they get too big, but you won't know until you run test calculations). When you are building the PAW sets you should be also running them in abinit (at least if they look at all reasonable) on something very simple and fast; use pawprtvol -3 and look at the output, it will show you if you are getting occupations and or D_ij's that are too big for the code to work well. What I'm trying to say here is that the log derivatives etc tests in atompaw are not enough, you can make a set that looks good at this level and still doesn't give good performance in abinit. Unfortunately PAW and pseudopotential generation in general is something of an ill-posed problem (non-unique solution) so it is iterative. A critical step to success is to identify a test solid you can run in abinit quickly enough to get useful feedback. So anyway, based on the two pictures you posed, the first one looks better than the second, but try them both.<br /><br />Next, regarding the input set that Simon posted, you should give that a try (see how it compares to the one I posted to you originally). The one thing you might do though is try to reduce the loggrid value, I see Simon has this set at 3001 (this is very large at least in my experience, Simon, was this really necessary? It will eat a LOT of memory--usually for transition metals something like 1500 is enough).<br /><br />Joe</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Thu Feb 03, 2011 2:35 pm</strong></div>
				<div class="author">by <strong>blackburn</strong></div>
				<div class="content">The loggrid is indeed quite large. I don't think it's necessary to keep it at that value. I just tried it with loggrid=2001 and it looks ok (from the logderivate and wfn point-of-view).<br /><br />Simon</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Sat Feb 05, 2011 9:31 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content">Thank you.<br />Dear jzwanzig, blackburn - One more question. If I need to calculate the total energy to within 0.1 eV (3.68 mHartree), then I should use ecut, which converges total energy witnin 3.68 mHartree, not 1 mHartree. Right?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Mon Feb 07, 2011 5:50 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">Well, yes, but going from 3.68 to 1.00 seems like a small extra step to make sure you are converged to where you want to be. Also it depends a little bit what you will use your results for--remember that the total energy of the GS converges faster than many other quantities do (stress, for example).</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Thu Feb 10, 2011 11:17 am</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content"><blockquote><div><cite>Alain_Jacques wrote:</cite>The 12e- valence configuration looks fine to me. If you plot the radial wavefunctions of Zr, you can see that only 4s 4p 4d and 5s have  significant contributions above 2 a.u. 3d is core. I would start with a rpaw between 1.9 to 2.2 a.u. 4s and 5s are valence; add at least one s projector. 4p is valence, you added 5p empty as valence then add one more p projector and probably add two projectors for d.<br /></div></blockquote><br />Thank you.<br />Should I increase rpaw to a value maximally close to the interatomic distance in my solid (and what benefits it gives - the gain in speed?) or can I leave 2.2 a.u.<br /><br />Best regards,<br />Maxim.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Thu Feb 10, 2011 12:21 pm</strong></div>
				<div class="author">by <strong>jzwanzig</strong></div>
				<div class="content">Yes, you can increase r_paw in the way you indicate. You will then converge with a lower e_cut and hence faster calculations, with no loss in accuracy (PAW is equivalent to an all-electron calculation for the valence electrons, provided your set of projectors is complete). As always, though, you must test your results carefully. The most precise way to test PAW, although it's time-consuming, is by comparison with the results of a FLAPW calculation, which you can do for example with another open source code called ELK.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Sat Feb 26, 2011 4:05 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content"><blockquote><div><cite>jzwanzig wrote:</cite>When you are building the PAW sets you should be also running them in abinit (at least if they look at all reasonable) on something very simple and fast; use pawprtvol -3 and look at the output, it will show you if you are getting occupations and or D_ij's that are too big for the code to work well.</div></blockquote><br /><br />Thank you all!<br />I've done physical quantities test of cubic zro2 using pawprtvol -3 and that's what I got:<br /><div class="inline-attachment">
			
				<dl class="thumbnail">
			<dt><a href="download/file688e.jpg?id=287&amp;mode=view"><img src="download/filea3c3.jpg?id=287&amp;t=1" class="postimage" alt="table.jpg" title="table.jpg (128.79 KiB) Viewed 10927 times" /></a></dt>
					</dl>
		
		
		
		
			</div><br /><div class="inline-attachment">
			
				<dl class="thumbnail">
			<dt><a href="download/file0350.jpg?id=289&amp;mode=view"><img src="download/file19cc.jpg?id=289&amp;t=1" class="postimage" alt="Graph1.jpg" title="Graph1.jpg (94.17 KiB) Viewed 10926 times" /></a></dt>
					</dl>
		
		
		
		
			</div><br />It seems that all pseudopotentials are close to FP-LAPW values. But the number of errors differs significantly: we have 0 warnings for Alain Jacques's pseudopotential, and from 44 to 76 warnings for others. The errors are:<br />&quot;print_ij: WARNING - The matrix seems to have high value(s) !&quot;<br />&quot;mkdenpos : WARNING - Density went &lt; 0 at        ... points&quot;<br />etc.<br /><br />I posted the input, output and log files here <!-- m --><a class="postlink" href="http://www.speedyshare.com/files/27092184/physical_quantities.zip">http://www.speedyshare.com/files/270921 ... tities.zip</a><!-- m --><br />Thanks again.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Zr pseudopotential</h3>
				<div class="date">Posted: <strong>Wed Mar 09, 2011 10:57 pm</strong></div>
				<div class="author">by <strong>maxim</strong></div>
				<div class="content">I used ecut=24 Ha for the 2x2x2 cell of solid solution ZrO2-CeO2 with the vacancy. Are pseudopotentials good enough?<br />If not - I ran the idea of - what else can be adjusted in pseudopotential?<br />Thanks for your help.<br /><br />Best regards,<br />Maxim.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=14&t=729&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 01:50:00 GMT -->
</html>
