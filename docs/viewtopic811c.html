<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=192&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:11:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Problem convergence SCF</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Problem convergence SCF</h2>
		<p><a href="viewtopicc17c-2.html?f=9&amp;t=192">https://forum.abinit.org/viewtopic.php?f=9&amp;t=192</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Problem convergence SCF</h3>
				<div class="date">Posted: <strong>Mon Mar 22, 2010 10:08 pm</strong></div>
				<div class="author">by <strong>Samuel</strong></div>
				<div class="content">Hi, <br /><br />I'm currently trying to calculate the optimal height of a fcc FeNi L10 ferromagnetic supercell containing 10 atoms (it is an hexagonal structure in the (111) plane).<br /><br /><br />My SCF cycle does not converge:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>BROYDEN STEP NUMBER&nbsp; &nbsp;0&nbsp; ------------------------------------------------------<br /><br />&nbsp; &nbsp; &nbsp;iter&nbsp; &nbsp;Etot(hartree)&nbsp; &nbsp; &nbsp;deltaE(h) residm&nbsp; &nbsp; nres2&nbsp; &nbsp;diffor&nbsp; &nbsp;maxfor&nbsp; &nbsp;magn<br />&nbsp;ETOT&nbsp; 1&nbsp; -312.60618381500&nbsp; &nbsp; -3.13E+02 2.09E+00 1.81E+03 5.3E-02 5.29E-02 9.199<br />&nbsp;ETOT&nbsp; 2&nbsp; -313.24670613267&nbsp; &nbsp; -6.41E-01 4.52E-01 2.35E+03 4.9E-01 4.33E-01 11.84<br />&nbsp;ETOT&nbsp; 3&nbsp; -310.71193697027&nbsp; &nbsp; &nbsp;2.53E+00 1.84E+00 2.49E+03 9.4E-01 7.09E-01 5.860<br />&nbsp;ETOT&nbsp; 4&nbsp; -309.43344505848&nbsp; &nbsp; &nbsp;1.28E+00 1.92E+00 6.60E+02 1.2E+00 4.53E-01 6.908<br />&nbsp;ETOT&nbsp; 5&nbsp; -310.37168186074&nbsp; &nbsp; -9.38E-01 1.32E+00 1.41E+03 1.7E+00 1.22E+00 5.316<br />&nbsp;ETOT&nbsp; 6&nbsp; -309.43477850700&nbsp; &nbsp; &nbsp;9.37E-01 5.34E-01 6.82E+02 1.6E+00 6.85E-01 5.260<br />&nbsp;ETOT&nbsp; 7&nbsp; -309.95216905246&nbsp; &nbsp; -5.17E-01 1.26E+00 1.88E+03 1.7E+00 1.65E+00 3.747<br />&nbsp;ETOT&nbsp; 8&nbsp; -309.40324893839&nbsp; &nbsp; &nbsp;5.49E-01 9.23E-01 5.01E+02 1.6E+00 3.54E-01 5.816<br />&nbsp;ETOT&nbsp; 9&nbsp; -309.22283938569&nbsp; &nbsp; &nbsp;1.80E-01 3.23E-01 1.04E+02 3.9E-01 1.25E-01 6.370<br />&nbsp;ETOT 10&nbsp; -309.34652237466&nbsp; &nbsp; -1.24E-01 3.99E-01 3.34E+02 4.1E-01 3.39E-01 6.352<br />&nbsp;ETOT 11&nbsp; -309.22248899386&nbsp; &nbsp; &nbsp;1.24E-01 1.04E-01 7.92E+01 5.6E-01 2.25E-01 7.310<br />&nbsp;ETOT 12&nbsp; -309.24050243038&nbsp; &nbsp; -1.80E-02 1.12E-01 1.09E+02 2.1E-01 1.58E-01 7.399<br />ETOT 13&nbsp; -309.22064803040&nbsp; &nbsp; &nbsp;1.99E-02 3.18E-01 3.55E+01 1.8E-01 6.29E-02 7.718<br />&nbsp;ETOT 14&nbsp; -309.29479133657&nbsp; &nbsp; -7.41E-02 5.13E-02 2.44E+02 4.0E-01 3.98E-01 6.885<br />&nbsp;ETOT 15&nbsp; -309.26522510592&nbsp; &nbsp; &nbsp;2.96E-02 5.10E-02 1.08E+02 4.4E-01 1.64E-01 7.429<br />&nbsp;ETOT 16&nbsp; -309.26166770342&nbsp; &nbsp; &nbsp;3.56E-03 1.12E-01 9.31E+01 3.6E-01 2.08E-01 8.079<br />&nbsp;ETOT 17&nbsp; -309.25967886189&nbsp; &nbsp; &nbsp;1.99E-03 8.70E-02 6.36E+01 1.6E-01 9.57E-02 7.918<br />&nbsp;ETOT 18&nbsp; -309.24742252023&nbsp; &nbsp; &nbsp;1.23E-02 5.69E-02 3.27E+01 1.3E-01 9.51E-02 7.917<br />&nbsp;ETOT 19&nbsp; -309.27230810643&nbsp; &nbsp; -2.49E-02 2.66E-01 9.54E+01 2.1E-01 2.54E-01 8.150<br />&nbsp;ETOT 20&nbsp; -309.24597053519&nbsp; &nbsp; &nbsp;2.63E-02 6.48E-02 2.98E+01 2.9E-01 1.66E-01 8.464<br />&nbsp;ETOT 21&nbsp; -309.24414502700&nbsp; &nbsp; &nbsp;1.83E-03 1.46E-02 1.88E+01 1.7E-01 5.22E-02 8.504<br />&nbsp;ETOT 22&nbsp; -309.29235083028&nbsp; &nbsp; -4.82E-02 6.20E-02 1.57E+02 1.4E-01 1.45E-01 8.148<br />&nbsp;ETOT 23&nbsp; -309.41836779211&nbsp; &nbsp; -1.26E-01 2.48E-01 4.67E+02 7.3E-01 6.38E-01 6.611<br />&nbsp;ETOT 24&nbsp; -309.46204537162&nbsp; &nbsp; -4.37E-02 2.07E-01 5.53E+02 9.2E-01 3.13E-01 6.778<br />&nbsp;ETOT 25&nbsp; -309.24637216961&nbsp; &nbsp; &nbsp;2.16E-01 2.00E-01 2.08E+01 3.5E-01 9.52E-02 8.662<br />&nbsp;ETOT 26&nbsp; -309.25293656823&nbsp; &nbsp; -6.56E-03 1.73E-02 2.70E+01 5.2E-02 7.24E-02 8.527<br />&nbsp;ETOT 27&nbsp; -309.27467387807&nbsp; &nbsp; -2.17E-02 3.87E-02 6.90E+01 1.6E-01 1.83E-01 8.073<br />&nbsp;ETOT 28&nbsp; -309.32746201720&nbsp; &nbsp; -5.28E-02 8.62E-02 2.07E+02 2.8E-01 3.73E-01 7.813<br />&nbsp;ETOT 29&nbsp; -309.25436609148&nbsp; &nbsp; &nbsp;7.31E-02 6.83E-02 2.75E+01 4.2E-01 1.65E-01 8.693<br />&nbsp;ETOT 30&nbsp; -309.26130623710&nbsp; &nbsp; -6.94E-03 4.11E-02 3.82E+01 2.2E-01 1.03E-01 8.608<br />&nbsp;ETOT 31&nbsp; -309.33341869759&nbsp; &nbsp; -7.21E-02 1.08E-01 2.67E+02 1.6E-01 2.06E-01 8.205<br />&nbsp;ETOT 32&nbsp; -309.44296810488&nbsp; &nbsp; -1.10E-01 3.65E-01 5.06E+02 8.2E-01 6.68E-01 6.759<br />&nbsp;ETOT 33&nbsp; -309.42917655047&nbsp; &nbsp; &nbsp;1.38E-02 2.20E-01 5.20E+02 9.7E-01 3.01E-01 7.469<br />&nbsp;ETOT 34&nbsp; -309.25382772422&nbsp; &nbsp; &nbsp;1.75E-01 2.02E-01 2.78E+01 3.6E-01 1.13E-01 8.981<br />&nbsp;ETOT 35&nbsp; -309.27961735513&nbsp; &nbsp; -2.58E-02 6.26E-02 7.65E+01 9.4E-02 1.17E-01 8.546<br />&nbsp;ETOT 36&nbsp; -309.34997923735&nbsp; &nbsp; -7.04E-02 1.22E-01 2.54E+02 4.7E-01 5.07E-01 7.314<br />&nbsp;ETOT 37&nbsp; -309.31302404989&nbsp; &nbsp; &nbsp;3.70E-02 1.18E-01 1.74E+02 5.0E-01 3.65E-01 8.104<br />&nbsp;ETOT 38&nbsp; -309.35876277181&nbsp; &nbsp; -4.57E-02 1.03E-01 3.00E+02 6.2E-01 6.74E-01 7.667<br />&nbsp;ETOT 39&nbsp; -309.31328334626&nbsp; &nbsp; &nbsp;4.55E-02 3.06E-01 1.52E+02 7.9E-01 2.52E-01 8.503<br />&nbsp;ETOT 40&nbsp; -309.32274257938&nbsp; &nbsp; -9.46E-03 2.01E-01 2.47E+02 3.0E-01 2.03E-01 8.328<br />&nbsp;ETOT 41&nbsp; -309.39059258932&nbsp; &nbsp; -6.79E-02 2.80E-01 3.93E+02 7.3E-01 5.62E-01 7.162<br />&nbsp;ETOT 42&nbsp; -309.34860082067&nbsp; &nbsp; &nbsp;4.20E-02 1.52E-01 3.15E+02 7.8E-01 2.24E-01 8.173<br />&nbsp;ETOT 43&nbsp; -309.44698355550&nbsp; &nbsp; -9.84E-02 3.90E-01 7.58E+02 9.2E-01 7.74E-01 7.880<br />&nbsp;ETOT 44&nbsp; -309.50325836390&nbsp; &nbsp; -5.63E-02 5.55E-01 6.68E+02 7.9E-01 5.13E-01 6.525<br />&nbsp;ETOT 45&nbsp; -309.61951086313&nbsp; &nbsp; -1.16E-01 4.99E-01 7.63E+02 1.1E+00 1.16E+00 6.005<br />&nbsp;ETOT 46&nbsp; -309.69608081524&nbsp; &nbsp; -7.66E-02 4.12E-01 9.03E+02 1.1E+00 1.17E+00 5.768<br />&nbsp;ETOT 47&nbsp; -309.53003125265&nbsp; &nbsp; &nbsp;1.66E-01 2.95E-01 6.42E+02 1.3E+00 1.05E+00 6.485<br />&nbsp;ETOT 48&nbsp; -309.75580495089&nbsp; &nbsp; -2.26E-01 1.34E+00 1.43E+03 1.6E+00 1.07E+00 5.996<br />&nbsp;ETOT 49&nbsp; -309.94254293567&nbsp; &nbsp; -1.87E-01 1.58E+00 1.80E+03 1.0E+00 9.12E-01 6.036<br />&nbsp;ETOT 50&nbsp; -309.98266200099&nbsp; &nbsp; -4.01E-02 1.30E+00 1.07E+03 1.9E+00 9.78E-01 5.246<br /><br />&nbsp;Cartesian components of stress tensor (hartree/bohr^3)<br />&nbsp; sigma(1 1)= -1.31424401E-02&nbsp; sigma(3 2)= -7.62161247E-04<br />&nbsp; sigma(2 2)= -6.74268992E-03&nbsp; sigma(3 1)= -4.82769636E-07<br />&nbsp; sigma(3 3)=&nbsp; 1.61621942E-03&nbsp; sigma(2 1)= -4.09508824E-07<br /><br /><br />&nbsp;scprqt:&nbsp; WARNING -<br />&nbsp; nstep=&nbsp; &nbsp;50 was not enough SCF cycles to converge;<br />&nbsp; density residual=&nbsp; 1.074E+03 exceeds tolvrs=&nbsp; 1.000E-12</code></pre></div><br /><br />I already have try with:<br /><br />1) iprcel 45<br />2) iprcel 145<br />3)  iprcel 145 and nnsclo à 3.<br />4)  iprcel 145 and nnsclo à 4.<br />5)  iprcel 145, nnsclo à 4 and nline 5 <br />6)   iprcel 0 and diemixmag -4<br /><br />None of this converge.<br /><br />I've attached the input file.<br /><br />Best regards.<br /><br />Ps: I cannot put the log file because .tar and .gz files are not allowed. In addition the max size is 2MB.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem convergence SCF</h3>
				<div class="date">Posted: <strong>Tue Mar 23, 2010 11:04 am</strong></div>
				<div class="author">by <strong>Samuel</strong></div>
				<div class="content">Advertisement spam?<br /><br />7) I've also try with only one long SCF cycle:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;scprqt:&nbsp; WARNING -<br />&nbsp; nstep=&nbsp; 500 was not enough SCF cycles to converge;<br />&nbsp; density residual=&nbsp; 2.619E+03 exceeds tolvrs=&nbsp; 1.000E-12<br /></code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem convergence SCF</h3>
				<div class="date">Posted: <strong>Tue Mar 23, 2010 11:52 am</strong></div>
				<div class="author">by <strong>mverstra</strong></div>
				<div class="content">magnetic systems are often hard to converge. Try with different initial spinat values, try increasing nline, and you can try preconditionning with a small diemix and some value for diemac (but I doubt this will be sufficient).<br /><br />I have heard of a very clever combination of scf algorithms which does an additional rotation of the states to make the convergence more monotonic (and much quicker) but this is not implemented in abinit, alas.<br /><br />good luck<br /><br />Matthieu</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=192&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:11:13 GMT -->
</html>
