<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=2661&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 23:03:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Even number of planewaves for nonSCF WFK</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Even number of planewaves for nonSCF WFK</h2>
		<p><a href="viewtopicd56c.html?f=9&amp;t=2661">https://forum.abinit.org/viewtopic.php?f=9&amp;t=2661</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Even number of planewaves for nonSCF WFK</h3>
				<div class="date">Posted: <strong>Mon May 12, 2014 5:15 am</strong></div>
				<div class="author">by <strong>temok</strong></div>
				<div class="content">Dear Members of the Forum,<br /><br />As documented in the description of 'ecut',<br /><a href="http://www.abinit.org/documentation/helpfiles/for-v7.6/input_variables/varbas.html#ecut" class="postlink">http://www.abinit.org/documentation/helpfiles/for-v7.6/input_variables/varbas.html#ecut</a><br />or in<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>~/ABINIT/doc/theory/ELF/wf_elecden_kinden_elf.pdf</code></pre></div> [page 2]<br />the number of planewaves can be different at different kpoints.<br /><br /><span style="color: #0040FF">I wonder if it is possible to enforce ABINIT to output the <strong class="text-strong">non-scf</strong> WFK with the same number of planewaves at all k-points.</span><br />(perhaps using dilatmx ?) I know there is 'npwwfn', but it only applies for screeening or sigma calculations.<br /><br />My interest in this is because I wish to implement a Model Hamiltonian starting from the non-scf WFK. At some point I need to perform projections between states at a fixed kpoint k and a set of states at different kpoints (q1, q2, ..). This leds me to read the &quot;cg&quot; that contains the wavefunction coefficients. But then I face the issue that the number of G's is different for different k-points, i.e. the length of cg_nk(G)  can be different that the length of  cg_mq(G).<br /><br /><span style="color: #4040FF">If this can not be enforced for nonSCF WFK's, would the following be a suitable solution?</span><br />1) to sort out all the cg's, so that the  i-th planewave  always corresponds to the same combination of reduced coordinates, say [n, l, m], for all cg's.<br />2) then apply a filter where I remove the highest planewaves, <br />(those closer to the surface of the sphere (k+G)^2 ), <br />so that all cg_nk (G) have the same number of G's for any nk<br /><br /><span style="color: #4040FF">By the way, how does abinit checks <strong class="text-strong">ortho</strong>gonality?</span><br />The normalization check does not face this lenght issue, as it requires summing up states at the same k-point, i.e.<br />    sum_spin    sum_G    |  c_k(G,spin) |  = 1, for a given k<br />which  is the last eqn of Section 1 of<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>~/ABINIT/doc/theory/wavefunction.pdf</code></pre></div><br />With regards,<br />Temok</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=9&t=2661&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 23:03:46 GMT -->
</html>
