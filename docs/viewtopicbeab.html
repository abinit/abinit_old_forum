<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3405&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 23:20:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Fortran error in 17_libtetra_ext</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Fortran error in 17_libtetra_ext</h2>
		<p><a href="viewtopica057.html?f=3&amp;t=3405">https://forum.abinit.org/viewtopic.php?f=3&amp;t=3405</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Fortran error in 17_libtetra_ext</h3>
				<div class="date">Posted: <strong>Tue Oct 18, 2016 6:29 pm</strong></div>
				<div class="author">by <strong>marco.digennaro</strong></div>
				<div class="content">Dear everybody, <br /><br />I am trying to install Abinit v8 on one CSCS machines: Piz Dora (<!-- m --><a class="postlink" href="http://www.cscs.ch/computers/piz_daint_piz_dora/index.html">http://www.cscs.ch/computers/piz_daint_ ... index.html</a><!-- m -->)<br />I am testing two options, one is with the local cray compiler PrgEnv-cray and the other one is with PrgEnv-intel (as suggested on <!-- m --><a class="postlink" href="http://www.archer.ac.uk/documentation/software/abinit/compiling_7_phase2.php">http://www.archer.ac.uk/documentation/s ... phase2.php</a><!-- m -->)<br /><br />With the PrgEnv-intel there is no problem in configuration, but then when I run abinit on the terminal I get this error:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;Tue Oct 18 18:35:37 2016&#93; &#91;unknown&#93; Fatal error in MPI_Init: Other MPI error, error stack:<br />MPIR_Init_thread(525): <br />MPID_Init(225).......: channel initialization failed<br />MPID_Init(598).......:&nbsp; PMI2 init failed: 1 <br />forrtl: error (76): Abort trap signal<br />Image&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Routine&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Line&nbsp; &nbsp; &nbsp; &nbsp; Source&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />abinit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0000000005489E71&nbsp; Unknown&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Unknown&nbsp; Unknown<br /></code></pre></div><br /><br />On the other side, with the cray compiler I find this error after configuration (no .ac file specified):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>make&#91;5&#93;: Entering directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray/src/17_libtetra_ext'<br />ftn -DHAVE_CONFIG_H -I. -I../../../src/17_libtetra_ext -I../..&nbsp; -I../../src/incs -I../../../src/incs -I/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp/fallbacks/exports/include&nbsp; &nbsp; -g&nbsp; &nbsp; -c -o m_kptrank.o ../../../src/17_libtetra_ext/m_kptrank.F90<br />../../../src/17_libtetra_ext/m_kptrank.F90(29): error #7002: Error in opening the compiled module file.&nbsp; Check INCLUDE paths.&nbsp; &nbsp;&#91;M_PROFILING_ABI&#93;<br />&nbsp;use m_profiling_abi<br />-----^<br />../../../src/17_libtetra_ext/m_kptrank.F90(30): error #7002: Error in opening the compiled module file.&nbsp; Check INCLUDE paths.&nbsp; &nbsp;&#91;M_ERRORS&#93;<br />&nbsp;use m_errors, only : msg_hndl<br />-----^<br />../../../src/17_libtetra_ext/m_kptrank.F90(30): error #6580: Name in only-list does not exist.&nbsp; &nbsp;&#91;MSG_HNDL&#93;<br />&nbsp;use m_errors, only : msg_hndl<br />----------------------^<br />../../../src/17_libtetra_ext/m_kptrank.F90(163): error #6406: Conflicting attributes or multiple declaration of name.&nbsp; &nbsp;&#91;MSG_HNDL&#93;<br />&nbsp; &nbsp; &nbsp;call msg_hndl(msg,&quot;ERROR&quot;, &quot;PERS&quot; ,file=&quot;m_kptrank.F90&quot;, line=163)<br />----------^<br />../../../src/17_libtetra_ext/m_kptrank.F90(174): error #6406: Conflicting attributes or multiple declaration of name.&nbsp; &nbsp;&#91;MSG_HNDL&#93;<br />&nbsp; &nbsp; &nbsp;call msg_hndl(msg,&quot;ERROR&quot;, &quot;PERS&quot; ,file=&quot;m_kptrank.F90&quot;, line=174)<br />----------^<br />../../../src/17_libtetra_ext/m_kptrank.F90(291): error #6406: Conflicting attributes or multiple declaration of name.&nbsp; &nbsp;&#91;MSG_HNDL&#93;<br />&nbsp; &nbsp;call msg_hndl(msg,&quot;ERROR&quot;, &quot;PERS&quot; ,file=&quot;m_kptrank.F90&quot;, line=291)<br />--------^<br />compilation aborted for ../../../src/17_libtetra_ext/m_kptrank.F90 (code 1)<br />make&#91;5&#93;: *** &#91;m_kptrank.o&#93; Error 1<br />make&#91;5&#93;: Leaving directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray/src/17_libtetra_ext'<br />make&#91;4&#93;: *** &#91;all-recursive&#93; Error 1<br />make&#91;4&#93;: Leaving directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray/src'<br />make&#91;3&#93;: *** &#91;all-recursive&#93; Error 1<br />make&#91;3&#93;: Leaving directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray'<br />make&#91;2&#93;: *** &#91;all&#93; Error 2<br />make&#91;2&#93;: Leaving directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray'<br />make&#91;1&#93;: *** &#91;multi&#93; Error 2<br />make&#91;1&#93;: Leaving directory `/users/mdigenna/CODES/ABINIT/abinit-8.0.8/tmp_cray'<br />make: *** &#91;mj4&#93; Error 2<br /></code></pre></div><br /><br />could anybody suggest a solution why it is not working with cray?<br /><br />thanks</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Fortran error in 17_libtetra_ext</h3>
				<div class="date">Posted: <strong>Sat Oct 22, 2016 11:07 am</strong></div>
				<div class="author">by <strong>gmatteo</strong></div>
				<div class="content">Hi Marco,<br /><br />I have access to another cray machine and we have compiled abinit with PrgEnv-intel and PrgEnv-gnu.<br />Note that ftn compiles binaries that are supposed to be executed on the compute node so I would suggest<br />to request an interactive session with salloc (I assume the machine uses Slurm) and try to run Abinit there.<br /><br />As concerns PrgEnv-cray. It seems that the directory with the Fortran modules is not passed to the Fortran compiler.<br />Each compiler uses it's own option for the specification of the &quot;Fortran include directory&quot;  e.g. gfortran uses -J/directory/name <br />I will look at the documentation of the Cray compiler and try to compile with  PrgEnv-cray on the other machine.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3405&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 23:20:43 GMT -->
</html>
