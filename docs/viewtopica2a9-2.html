<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=1514&start=25&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:18:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; abinit-6.10.3 error message with make command - Page 2</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>abinit-6.10.3 error message with make command</h2>
		<p><a href="viewtopic39ff.html?f=3&amp;t=1514">https://forum.abinit.org/viewtopic.php?f=3&amp;t=1514</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>2</strong> of <strong>2</strong></div>
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Wed Jan 16, 2013 6:36 pm</strong></div>
				<div class="author">by <strong>MichalP</strong></div>
				<div class="content">Here's the output of config.log pertaining to linear algebra support.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>configure:30017: checking for the requested linear algebra support<br />configure:30019: result: goto<br />configure:30050: checking whether to select a fallback for linear algebra<br />configure:30058: result: no<br />configure:30083: checking for BLAS support in specified libraries<br />configure:30092: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30092: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call zgemm<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30099: result: no<br />configure:30104: checking for AXPBY support in specified BLAS libraries<br />configure:30116: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30116: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call saxpby<br />|&nbsp; &nbsp; &nbsp; &nbsp;call daxpby<br />|&nbsp; &nbsp; &nbsp; &nbsp;call caxpby<br />|&nbsp; &nbsp; &nbsp; &nbsp;call zaxpby<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30123: result: no<br />configure:30132: checking for gemm3m in specified libraries<br />configure:30142: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30142: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; call cgemm3m<br />|&nbsp; &nbsp; &nbsp; call zgemm3m<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30149: result: no<br />configure:30163: checking for mkl_imatcopy in specified libraries<br />configure:30175: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30175: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main||&nbsp; &nbsp; &nbsp; &nbsp;call mkl_simatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_dimatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_cimatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_zimatcopy<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30182: result: no<br />configure:30191: checking for mkl_omatcopy in specified libraries<br />configure:30203: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit statusconfigure:30203: $? = 1configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_somatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_domatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_comatcopy<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_zomatcopy<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30210: result: no<br />configure:30219: checking for mkl_omatadd in specified libraries<br />configure:30231: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blascollect2: ld returned 1 exit statusconfigure:30231: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_somatadd<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_comatadd<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_domatadd<br />|&nbsp; &nbsp; &nbsp; &nbsp;call mkl_zomatadd<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30238: result: no<br />configure:30249: checking for LAPACK support in specified libraries<br />configure:30258: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30258: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call zhpev<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30265: result: no<br />configure:30268: checking for BLACS support in specified libraries<br />configure:30277: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30277: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call blacs_gridinit<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30284: result: no<br />configure:30287: checking for ScaLAPACK support in specified libraries<br />configure:30296: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30296: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call pzheevx<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30303: result: no<br />configure:30306: checking for MAGMA (version&gt;=1.1.0) support in specified libraries<br />configure:30308: checking TEST<br />configure:30317: /usr/local/Cellar/open-mpi/1.6.3/bin/mpif90 -o conftest&nbsp; -g -ffree-line-length-none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;conftest.F90 -L/usr/local/Cellar/openblas/0.2.5/lib -llapack -lcblas -lf77blas -latlas -lopenblas&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&amp;5<br />ld: library not found for -lf77blas<br />collect2: ld returned 1 exit status<br />configure:30317: $? = 1<br />configure: failed program was:<br />|&nbsp; &nbsp; &nbsp; &nbsp;program main<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;call magmaf_zhegvd<br />|<br />|&nbsp; &nbsp; &nbsp; &nbsp;end<br />configure:30324: result: no<br />configure:30932: checking whether we have a serial linear algebra support<br />configure:30934: result: no<br />configure:30963: WARNING: falling back to internal linear algebra libraries<br />configure:30970: checking whether we have a MPI linear algebra support<br />configure:30972: result: no<br />configure:30992: checking whether we have a GPU linear algebra support<br />configure:30994: result: no<br />configure:31244: checking for the actual linear algebra support<br />configure:31246: result: netlib-fallback<br />configure:31550: checking for the requested algorithmic support<br />configure:31552: result: none<br />configure:31998: checking for the actual algorithmic support<br />configure:32000: result: none<br />configure:32301: checking for the requested math support<br />configure:32303: result: none<br />configure:32864: checking for the actual math support<br />configure:32866: result: none</code></pre></div></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Wed Jan 16, 2013 7:03 pm</strong></div>
				<div class="author">by <strong>gmatteo</strong></div>
				<div class="content">ld: library not found for -lf77blas<br /><br />It seems that libf77blas has not been installed in /usr/local/Cellar/openblas/0.2.5/lib</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Wed Jan 16, 2013 7:56 pm</strong></div>
				<div class="author">by <strong>MichalP</strong></div>
				<div class="content">libopenblas.dylib and libopenblas_sandybridgep-r0.2.5.dylib are the only libraries in /usr/local/Cellar/openblas/0.2.5/lib  <br />Should I also compile openblas from source to ensure all the libraries I need are present?  I got openblas from homebrew/science<br /><!-- m --><a class="postlink" href="https://github.com/Homebrew/homebrew-science/blob/master/openblas.rb">https://github.com/Homebrew/homebrew-sc ... penblas.rb</a><!-- m --></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Thu Jan 17, 2013 11:18 am</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content">Hi Michal,<br /><br />-llapack -lcblas -lf77blas -latlas is the recipe for ATLAS linalg linking, not openBLAS. The openBLAS library contains BLAS and an optimized LAPACK. So for your homebrew system, the right abinit configure option for linalg should be --with-linalg-libs=&quot;-L/usr/local/Cellar/openblas/0.2.5/lib -lopenblas&quot;. Don't forget to add /usr/local/Cellar/openblas/0.2.5/lib to the DYLIB_LIBRARY_PATH environment variable as shown earlier with someting like export DYLIB_LIBRARY_PATH=/usr/local/Cellar/openblas/0.2.5/lib:$DYLIB_LIBRARY_PATH - homebrew setup maybe already does it but it won't hurt to be sure. Same story for all the paths to the libraries that aren't in canonic locations.<br />Again if configure falls back on internal linalg, attach the new config.log<br />I also suggest to group the configure options at the beginning and the environment variables at the end i.e. configure --enable-mpi=&quot;yes&quot; .... FCCPP=/usr/local/gfortran/bin/cpp ... there are sometimes strange side effects when they are mixed.<br /><br />Kind regards,<br /><br />Alain</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Thu Jan 17, 2013 3:50 pm</strong></div>
				<div class="author">by <strong>MichalP</strong></div>
				<div class="content">Success! Thank you very much for all your help!<br /><br />Here are the configure options I used:<br /><br />../configure FCCPP=/usr/local/gfortran/bin/cpp CFLAGS_OPTIM=&quot;-O2&quot; FCFLAGS_OPTIM=&quot;-O2&quot; --enable-mpi=&quot;yes&quot; --enable-optim=&quot;yes&quot; --with-mpi-prefix=&quot;/usr/local/Cellar/open-mpi/1.6.3&quot; --with-fft-flavor=&quot;fftw3&quot; --with-fft-libs=&quot;-L/usr/local/fftw-3.3.3/lib -lfftw3&quot; --with-linalg-flavor=&quot;goto&quot; --with-linalg-libs=&quot;-L/usr/local/Cellar/openblas/0.2.5/lib -lopenblas&quot;<br /><br />Summary of important options:<br /><br />  * C compiler      : gnu version <br />  * Fortran compiler: gnu version 4.6<br />  * architecture    :   ( bits)<br /><br />  * debugging       : basic<br />  * optimizations   : yes<br /><br />  * OpenMP enabled  : no (collapse: ignored)<br />  * MPI    enabled  : yes<br />  * MPI-IO enabled  : yes<br />  * GPU    enabled  : no (none)<br /><br />  * TRIO   flavor = netcdf-fallback+etsf_io-fallback<br />  * TIMER  flavor = abinit (libs: ignored)<br />  * LINALG flavor = goto (libs: user-defined)<br />  * ALGO   flavor = none (libs: ignored)<br />  * FFT    flavor = fftw3 (libs: user-defined)<br />  * MATH   flavor = none (libs: ignored)<br />  * DFT    flavor = libxc-fallback+atompaw-fallback+bigdft-fallback+wannier90-fallback<br /><br />Configuration complete.<br /><br />tests_v1 runs without any errors, what file should I check to ensure the tests all completed correctly?<br /><br />Is there any other info I can include that might help future mac users out?<br /><br />Thanks<br />Michal</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Thu Jan 17, 2013 4:39 pm</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content">Hi Michal,<br /><br />Glad it worked <img class="smilies" src="images/smilies/icon_e_smile.gif" alt=":-)" title="Smile" /><br /><br />In the tests subdirectory where you built abinit i.e. the place from which you launched make tests_v1, you can check the results with a <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>more */*/report</code></pre></div>It gives a short summary. If some of them fail, you should go in the corresponding tests subdirectory and look at the offending txx.err , txx.diff and txx.out files where xx is the failed case.<br />You should also run the full accuracy test suite with a <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>make tests_acc4</code></pre></div>I assume your CPU can sustain four simultaneous threads and use the same more command to check all the report files.<br />As we are talking about threads, keep in mind that MPI and openBLAS may compete on your available cores (depending on how openBLAS was compiled) so you should have a look at <a href="https://github.com/xianyi/OpenBLAS" class="postlink">https://github.com/xianyi/OpenBLAS</a> for info about limiting the number of openBLAS threads if you notice cores overloading.<br /><br />After installing abinit in its final location, you may have to invoke the export DYLD_LIBRARY_PATH=... if you have error messages about missing libraries when you launch abinit - this is related to homebrew configuration. Same story for PATH - if you use mpirun, check that you have the right one.<br /><br />Kind regards,<br /><br />Alain</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Thu Jan 17, 2013 6:57 pm</strong></div>
				<div class="author">by <strong>MichalP</strong></div>
				<div class="content">Sounds good, thanks again for the help. How can I tell if I have cores overloading?<br /><br />While I am running the tests, I have between 2 and 4 abinit processes running, each at 4 threads, fluctuating between using 90 and 260% of the cpu each according to activity monitor.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: abinit-6.10.3 error message with make command</h3>
				<div class="date">Posted: <strong>Fri Jan 18, 2013 12:06 pm</strong></div>
				<div class="author">by <strong>Alain_Jacques</strong></div>
				<div class="content">Hi Michal,<br /><br />On OSX, use <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>top -o cpu</code></pre></div>to display the load or use Activity Monitor<br />The tests_acc4 launches a maximum of 4 simultaneous tests in order to keep a 4 cores systems busy. I think you mentioned that you have a I7 processor - it has either 2 or 4 &quot;real&quot; cores ... I don't take the hyperthreading into account. So with a load larger than 2 (for 2 cores) or 4 (for 4 cores), your system looses efficiency by switching context. So you should adjust mpirun -np parameter and OPENBLAS_NUM_THREADS environment variable to keep the load into the limit of the number of available cores.<br /><br />Alain</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>2</strong> of <strong>2</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=1514&start=25&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:18:31 GMT -->
</html>
