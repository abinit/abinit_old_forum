<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=4043&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 18:38:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Undefined reference error when compiling ABINIT 8.10.2</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Undefined reference error when compiling ABINIT 8.10.2</h2>
		<p><a href="viewtopic768c.html?f=3&amp;t=4043">https://forum.abinit.org/viewtopic.php?f=3&amp;t=4043</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Undefined reference error when compiling ABINIT 8.10.2&nbsp;&nbsp;<span style="color: #006600">[SOLVED]</span></h3>
				<div class="date">Posted: <strong>Tue Feb 19, 2019 11:16 am</strong></div>
				<div class="author">by <strong>Tom Schoonjans</strong></div>
				<div class="content">Hi,<br /><br />I am compiling ABINIT 8.10.2 on our HPC cluster but got stuck with an undefined reference linking error:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Making all in 98_main<br />make&#91;3&#93;: Entering directory `/home/vol03/scarf783/software/abinit-8.10.2/src/98_main'<br />mpif90 -free -module /home/vol03/scarf783/software/abinit-8.10.2/src/mods&nbsp; &nbsp;-O3 -g -extend-source -noaltparam -nofpscomp&nbsp; -qopenmp&nbsp; -g -extend-source -noaltparam -nofpscomp&nbsp; -qopenmp -static-intel -static-libgcc&nbsp; -static-intel -static-libgcc&nbsp; -o anaddb anaddb-anaddb.o -static-intel -static-libgcc&nbsp; ../../src/77_ddb/lib77_ddb.a ../../src/72_response/lib72_response.a ../../src/69_wfdesc/lib69_wfdesc.a ../../src/68_rsprc/lib68_rsprc.a ../../src/67_common/lib67_common.a ../../src/66_vdwxc/lib66_vdwxc.a ../../src/66_wfs/lib66_wfs.a ../../src/66_nonlocal/lib66_nonlocal.a ../../src/65_paw/lib65_paw.a ../../src/64_psp/lib64_psp.a ../../src/62_wvl_wfs/lib62_wvl_wfs.a ../../src/62_poisson/lib62_poisson.a ../../src/62_iowfdenpot/lib62_iowfdenpot.a ../../src/62_cg_noabirule/lib62_cg_noabirule.a ../../src/62_ctqmc/lib62_ctqmc.a ../../src/62_cg_noabirule/lib62_cg_noabirule.a ../../src/61_occeig/lib61_occeig.a ../../src/59_ionetcdf/lib59_ionetcdf.a ../../src/57_iovars/lib57_iovars.a ../../src/57_iopsp_parser/lib57_iopsp_parser.a ../../src/56_recipspace/lib56_recipspace.a ../../src/56_xc/lib56_xc.a ../../src/56_mixing/lib56_mixing.a ../../src/56_io_mpi/lib56_io_mpi.a ../../src/55_abiutil/lib55_abiutil.a ../../src/54_spacepar/lib54_spacepar.a ../../src/53_ffts/lib53_ffts.a ../../src/52_fft_mpi_noabirule/lib52_fft_mpi_noabirule.a ../../src/51_manage_mpi/lib51_manage_mpi.a ../../src/49_gw_toolbox_oop/lib49_gw_toolbox_oop.a ../../src/45_geomoptim/lib45_geomoptim.a ../../src/44_abitypes_defs/lib44_abitypes_defs.a ../../src/44_abitools/lib44_abitools.a ../../src/43_wvl_wrappers/lib43_wvl_wrappers.a ../../src/43_ptgroups/lib43_ptgroups.a ../../src/42_parser/lib42_parser.a ../../src/42_nlstrain/lib42_nlstrain.a ../../src/42_libpaw/lib42_libpaw.a ../../src/41_xc_lowlevel/lib41_xc_lowlevel.a ../../src/41_geometry/lib41_geometry.a ../../src/32_util/lib32_util.a ../../src/29_kpoints/lib29_kpoints.a ../../src/28_numeric_noabirule/lib28_numeric_noabirule.a ../../src/27_toolbox_oop/lib27_toolbox_oop.a ../../src/21_hashfuncs/lib21_hashfuncs.a ../../src/18_timing/lib18_timing.a ../../src/17_libtetra_ext/lib17_libtetra_ext.a ../../src/16_hideleave/lib16_hideleave.a&nbsp; ../../src/14_hidewrite/lib14_hidewrite.a ../../src/12_hide_mpi/lib12_hide_mpi.a ../../src/11_memory_mpi/lib11_memory_mpi.a ../../src/10_dumpinfo/lib10_dumpinfo.a ../../src/10_defs/lib10_defs.a ../../src/02_clib/lib02_clib.a -L/apps/contrib/dls-spectroscopy/netcdf/4.6.2-intel2018/lib -lnetcdff -lnetcdf -L/apps/contrib/dls-spectroscopy/libxc/4.2.3-intel2018/lib -lxcf90 -lxc -lfftw3 -L/apps/contrib/dls-spectroscopy/scalapack/2.0.2-intel-2018/lib -lscalapack -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/mkl/lib/intel64 -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core -lrt -L/opt/ibm/platform_mpi/lib/linux_amd64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/mkl/lib/intel64_lin -L/apps/intel/2018/clck/2018.3/lib/intel64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/ipp/lib/intel64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/compiler/lib/intel64_lin -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64/gcc4.7 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/daal/lib/intel64_lin -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64_lin/gcc4.4 -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/ -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../lib64 -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../lib64/ -L/lib/../lib64 -L/lib/../lib64/ -L/usr/lib/../lib64 -L/usr/lib/../lib64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/mkl/lib/intel64_lin/ -L/apps/intel/2018/clck/2018.3/lib/intel64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/ipp/lib/intel64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/compiler/lib/intel64_lin/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64/gcc4.7/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/daal/lib/intel64_lin/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64_lin/gcc4.4/ -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../ -L/lib64 -L/lib/ -L/usr/lib64 -L/usr/lib -lpcmpio -lpcmpi -ldl -lifport -lifcoremt -limf -lsvml -lm -lipgo -lirc -lpthread -lirc_s -L/opt/ibm/platform_mpi/lib/linux_amd64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/mkl/lib/intel64_lin -L/apps/intel/2018/clck/2018.3/lib/intel64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/ipp/lib/intel64 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/compiler/lib/intel64_lin -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64/gcc4.7 -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/daal/lib/intel64_lin -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64_lin/gcc4.4 -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/ -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../lib64 -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../../lib64/ -L/lib/../lib64 -L/lib/../lib64/ -L/usr/lib/../lib64 -L/usr/lib/../lib64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/mkl/lib/intel64_lin/ -L/apps/intel/2018/clck/2018.3/lib/intel64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/ipp/lib/intel64/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/compiler/lib/intel64_lin/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64/gcc4.7/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/daal/lib/intel64_lin/ -L/apps/intel/2018/compilers_and_libraries_2018.3.222/linux/tbb/lib/intel64_lin/gcc4.4/ -L/usr/lib/gcc/x86_64-redhat-linux/4.8.5/../../../ -L/lib64 -L/lib/ -L/usr/lib64 -L/usr/lib -lpcmpio -lpcmpi -ldl -lifport -lifcoremt -limf -lsvml -lm -lipgo -lirc -lpthread -lirc_s <br />../../src/32_util/lib32_util.a(m_special_funcs.o): In function `m_special_funcs_mp_gamma_function_':<br />/home/vol03/scarf783/software/abinit-8.10.2/src/32_util/m_special_funcs.F90:1050: undefined reference to `gsl_f90_sf_gamma_'<br />make&#91;3&#93;: *** &#91;anaddb&#93; Error 1</code></pre></div><br /><br />I invoked configure as:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>./configure --prefix=/apps/contrib/dls-spectroscopy/abinit/8.10.2-intel2018 CC=mpicc CXX=mpiCC FC=mpif90 F77=mpif77 --enable-mpi=yes --enable-openmp=yes --with-linalg-flavor=mkl+scalapack --with-linalg-libs=&quot;-L/apps/contrib/dls-spectroscopy/scalapack/2.0.2-intel-2018/lib -lscalapack -L$MKL_LIBS -lmkl_intel_lp64 -lmkl_intel_thread -lmkl_core&quot; --with-math-flavor=gsl --with-dft-flavor=libxc --with-libxc-incs=-I/apps/contrib/dls-spectroscopy/libxc/4.2.3-intel2018/include --with-libxc-libs=&quot;-L/apps/contrib/dls-spectroscopy/libxc/4.2.3-intel2018/lib -lxcf90 -lxc&quot; --with-fft-flavor=fftw3-mkl --with-trio-flavor=netcdf&nbsp; --with-etsf-io-incs=-I/apps/contrib/dls-spectroscopy/etsf_io/1.0.4-intel2018/include --with-etsf-io-libs=&quot;-L/apps/contrib/dls-spectroscopy/etsf_io/1.0.4-intel2018/lib -letsf_io_low_level -letsf_io_utils -letsf_io&quot; --with-netcdf-incs=-I/apps/contrib/dls-spectroscopy/netcdf/4.6.2-intel2018/include --with-netcdf-libs=&quot;-L/apps/contrib/dls-spectroscopy/netcdf/4.6.2-intel2018/lib -lnetcdff -lnetcdf&quot;</code></pre></div><br /><br />Going through the code shows that gsl_f90_sf_gamma_ is implemented in src/01_gsl_ext/gsl_f90_sf_gamma.c and ends up getting compiled into src/01_gsl_ext/lib01_gsl_ext.a  which does not get linked in thereby triggering the linker error...<br /><br />Can you explain me how I can add explicit linking against lib01_gsl_ext.a? I am usually quite confident hacking autotools projects but ABINIT's buildsystem is quite scary <img class="smilies" src="images/smilies/icon_e_smile.gif" alt=":-)" title="Smile" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Undefined reference error when compiling ABINIT 8.10.2</h3>
				<div class="date">Posted: <strong>Tue Feb 19, 2019 3:00 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content">Hi,<br /><br />it's a bug...<br /><br />I reproduced the problem with abinit 8.11.5 under ubuntu 18.10.2  with packages  gnu 7.3 / libgsl-dev</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Undefined reference error when compiling ABINIT 8.10.2</h3>
				<div class="date">Posted: <strong>Tue Feb 19, 2019 4:52 pm</strong></div>
				<div class="author">by <strong>Tom Schoonjans</strong></div>
				<div class="content">Thanks for confirming the issue quickly.<br /><br />Is there a way for me to fix this quickly?<br /><br />Thanks,<br /><br />Tom</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Undefined reference error when compiling ABINIT 8.10.2</h3>
				<div class="date">Posted: <strong>Tue Feb 19, 2019 10:41 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content">Tom,<br /><br />I made a patch for the next release ( 8.10.3 )<br /><br />the problem affects not only anaddb, but 11 other binaries<br /><br />here is a &quot;simple&quot; workaround  made for anaddb but you must repeat these steps for all other binaries  <img class="smilies" src="images/smilies/icon_rolleyes.gif" alt=":roll:" title="Rolling Eyes" /> :<br /><ul>1) in src/98_main,  edit the Makefile<br />2) search  :  anaddb_LDADD<br />3) after  &quot;$(LIB_02_CLIB) \&quot;   add      &quot;<strong class="text-strong">$(LIB_01_GSL_EXT) \</strong>&quot;<br />4) after  &quot;-L/usr/lib/x86_64-linux-gnu/ -lnetcdf -lnetcdff \&quot;   add  &quot;<strong class="text-strong">-L/usr/lib/x86_64-linux-gnu -lgsl -lgslcblas -lm \</strong>&quot;<br /></ul><span style="color: #BF0000">caution : <br />- Makefile  doesn't like spaces at the beginning of the line: use tab<br />- the PATH of gsl libs and the names of libs are for ubuntu packages ( 18.04 ) </span><br /><br />repeat for theses binaries if you need it<br /><ul>conducti<br />cut3d<br />ioprof<br />fold2Bloch<br />mrgddb<br />mrgdv<br />mrggkk<br />mrgscr<br />optic<br />tdep<br />ujdet</ul><br />good luck  <img class="smilies" src="images/smilies/icon_e_wink.gif" alt=";)" title="Wink" /></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Undefined reference error when compiling ABINIT 8.10.2</h3>
				<div class="date">Posted: <strong>Wed Feb 20, 2019 4:38 pm</strong></div>
				<div class="author">by <strong>jbeuken</strong></div>
				<div class="content"><a href="https://www.abinit.org/sites/default/files/packages/abinit-8.10.3.tar.gz" class="postlink">v8.10.3</a></div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Undefined reference error when compiling ABINIT 8.10.2</h3>
				<div class="date">Posted: <strong>Tue Mar 05, 2019 4:56 pm</strong></div>
				<div class="author">by <strong>pouillon</strong></div>
				<div class="content">Please note that GSL support is about to be removed because it is highly marginal and unmaintained. The only call to it occurs in src/32_util/m_special_funcs.F90.<br /><br />You can safely leave it disabled.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=4043&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 18:38:06 GMT -->
</html>
