<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=3612&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 19:56:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; wrong number of qpoints in GKK file wrt anaddb input</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>wrong number of qpoints in GKK file wrt anaddb input</h2>
		<p><a href="viewtopic8706.html?f=10&amp;t=3612">https://forum.abinit.org/viewtopic.php?f=10&amp;t=3612</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>wrong number of qpoints in GKK file wrt anaddb input</h3>
				<div class="date">Posted: <strong>Sat May 27, 2017 11:59 am</strong></div>
				<div class="author">by <strong>beda</strong></div>
				<div class="content">Dear Users,<br />      What is the correct procedure to find the q points for el-ph calculations and the qpaths in anaddb?  The system which I took is two-dimensional buckled Boron. To get a  q-points, a ground state calculation was done with kptopt 1 and the ngkpt set to the q-point grid (8 4 1 in my case), then copied the k-points (in total 15 points) as qpt for response calculation. mrggddb and mrggkk wrks normally without problem, but on calling &quot;anaddb&quot;, error comes up  &quot;<span style="text-decoration: underline">--- !ERROR src_file: read_gkk.F90 src_line: 651 mpi_rank: 0 message: |Found wrong number of qpoints in GKK file wrt anaddb input nqpt_anaddb nqpt_gkk = 61</span>&quot;.  <br />     I am to unable to understand how to obtain correctly the qpoints in the el-ph inputs and consequently qpaths for the anaddb. Any suggestion and help will be appreciated.  <br />********************************************************************************************<br />teph_1.in<br /><br />ndtset 34<br /># DATASET 1 : make ground state wavefunctions and density<br />tolwfr1  1.0d-14<br />nline1   8       # This is to expedite the convergence of higher-lying bands<br />rfphon1  0       # for DS1 do _not_ do perturbation<br />nqpt1    0       # for DS1 do _not_ do perturbation<br />prtwf1   1       # need GS wavefunctions for further runs<br />getwfk1  0<br />kptopt1  1<br /># enforce calculation of forces at each SCF step<br />optforces 1<br />qpt2      0.00000000E+00  0.00000000E+00  0.00000000E+00<br />qpt3      1.25000000E-01  0.00000000E+00  0.00000000E+00<br />qpt4      2.50000000E-01  0.00000000E+00  0.00000000E+00<br />qpt5      3.75000000E-01  0.00000000E+00  0.00000000E+00<br />qpt6      5.00000000E-01  0.00000000E+00  0.00000000E+00<br />qpt7      0.00000000E+00  2.50000000E-01  0.00000000E+00<br />qpt8      1.25000000E-01  2.50000000E-01  0.00000000E+00<br />qpt9      2.50000000E-01  2.50000000E-01  0.00000000E+00<br />qpt10     3.75000000E-01  2.50000000E-01  0.00000000E+00<br />qpt11     5.00000000E-01  2.50000000E-01  0.00000000E+00<br />qpt12     0.00000000E+00  5.00000000E-01  0.00000000E+00<br />qpt13     1.25000000E-01  5.00000000E-01  0.00000000E+00<br />qpt14     2.50000000E-01  5.00000000E-01  0.00000000E+00<br />qpt15     3.75000000E-01  5.00000000E-01  0.00000000E+00<br />qpt16     5.00000000E-01  5.00000000E-01  0.00000000E+00<br />#  DS5 get DDK perturbation (stored in GKK matrix element files)<br />tolwfr17  1.0d-14<br />qpt17     0.0 0.0 0.0<br />rfphon17  0<br />rfelfd17  2<br />prtwf17   0<br /># WF on full BZ<br />tolwfr18      1.0d-14<br />prtwf18       1<br />getwfk18      1<br />nstep18       1<br />nline18       1<br />nqpt18        0<br />rfphon18      0<br /># Compute the GKK correctly (no gauge problem)<br />qpt19         0.0 0.0 0.0<br />prtgkk19      1            # print out gkk files directly<br />iscf19       -2<br />tolwfr19      1.0d-14<br />nstep19       1<br />nline19       1<br />getwfk19      18<br />get1den19     2<br />qpt20         1.25000000E-01  0.00000000E+00  0.00000000E+00<br />prtgkk20      1            # print out gkk files directly<br />iscf20       -2<br />tolwfr20      1.0d-14<br />nstep20       1<br />nline20       1<br />getwfk20      18<br />get1den20     3<br />qpt21        2.50000000E-01  0.00000000E+00  0.00000000E+00<br />prtgkk21      1<br />iscf21       -2<br />tolwfr21      1.0d-14<br />nstep21       1<br />nline21       1<br />getwfk21      18<br />get1den21     4<br />qpt22        3.75000000E-01  0.00000000E+00  0.00000000E+00<br />prtgkk22      1<br />iscf22       -2<br />tolwfr22      1.0d-14<br />nstep22       1<br />nline22       1<br />getwfk22      18<br />get1den22     5<br />qpt23        5.00000000E-01  0.00000000E+00  0.00000000E+00<br />prtgkk23      1<br />iscf23       -2<br />tolwfr23      1.0d-14<br />nstep23       1<br />nline23       1<br />getwfk23      18<br />get1den23     6<br />qpt24        0.00000000E+00  2.50000000E-01  0.00000000E+00<br />prtgkk24      1<br />iscf24       -2<br />tolwfr24      1.0d-14<br />nstep24       1<br />nline24       1<br />getwfk24      18<br />get1den24     7<br />qpt25      1.25000000E-01  2.50000000E-01  0.00000000E+00<br />prtgkk25      1<br />iscf25       -2<br />tolwfr25      1.0d-14<br />nstep25       1<br />nline25       1<br />getwfk25      18<br />get1den25     8<br />qpt26      2.50000000E-01  2.50000000E-01  0.00000000E+00<br />prtgkk26      1<br />iscf26       -2<br />tolwfr26      1.0d-14<br />nstep26       1<br />nline26       1<br />getwfk26      18<br />get1den26     9<br />qpt27      3.75000000E-01  2.50000000E-01  0.00000000E+00<br />prtgkk27      1<br />iscf27       -2<br />tolwfr27      1.0d-14<br />nstep27       1<br />nline27       1<br />getwfk27      18<br />get1den27     10<br />qpt28      5.00000000E-01  2.50000000E-01  0.00000000E+00<br />prtgkk28      1<br />iscf28       -2<br />tolwfr28      1.0d-14<br />nstep28       1<br />nline28       1<br />getwfk28      18<br />get1den28     11<br />qpt29      0.00000000E+00  5.00000000E-01  0.00000000E+00<br />prtgkk29      1<br />iscf29       -2<br />tolwfr29      1.0d-14<br />nstep29       1<br />nline29       1<br />getwfk29      18<br />get1den29     12<br />qpt30      1.25000000E-01  5.00000000E-01  0.00000000E+00<br />prtgkk30      1<br />iscf30       -2<br />tolwfr30      1.0d-14<br />nstep30       1<br />nline30       1<br />getwfk30      18<br />get1den30     13<br />qpt31      2.50000000E-01  5.00000000E-01  0.00000000E+00<br />prtgkk31      1<br />iscf31       -2<br />tolwfr31      1.0d-14<br />nstep31       1<br />nline31       1<br />getwfk31      18<br />get1den31     14<br />qpt32      3.75000000E-01  5.00000000E-01  0.00000000E+00<br />prtgkk32      1<br />iscf32       -2<br />tolwfr32      1.0d-14<br />nstep32       1<br />nline32       1<br />getwfk32      18<br />get1den32     15<br />qpt33      5.00000000E-01  5.00000000E-01  0.00000000E+00<br />prtgkk33      1<br />iscf33       -2<br />tolwfr33      1.0d-14<br />nstep33       1<br />nline33       1<br />getwfk33      18<br />get1den33     16<br /># DS12 get the ddk matrix elements on the full grid<br />prtgkk34     1<br />rfphon34     0             # no phonons here<br />rfelfd34     2             # Activate the calculation of the d/dk perturbation<br />qpt34        0.0 0.0 0.0   # This is a calculation at the Gamma point<br />iscf34      -3             # The d/dk perturbation must be treated non SC-ly<br />tolwfr34     1.0d-14       # Must use tolwfr for non-self-consistent calculations<br />nstep34      1<br />nline34      1<br />getwfk34     18<br />get1den34    17<br /># general data for all phonon calculations:<br />prepgkk 1        # flag to calculate all perturbations for el-phon calculations<br />use_nonscf_gkk 0 # enforce old default and scf-calculate all perturbations<br />nqpt 1           # 1 qpoint at a time<br />tolvrs 1.e-8     # tolerance on 2DTE convergence: potential^(1) is what we need<br />getwfk 1         # all other DS get wf from DS1<br />prtwf 0<br />rfatpol 1 2      # all atoms are perturbed<br />rfdir 1 1 1      # all directions of perturbation<br />rfphon 1<br />#  Common data for GS and perturbation runs<br />ngkpt        8 4 1<br />kptopt       3<br />ecut         4.0<br /># Use a centered grid for the kpoints<br />nshiftk      1<br />shiftk       0.0 0.0 0.0<br />#  Common data<br />acell        3*3.0869<br />rprim<br /> 1.000000   0.000000   0.000000<br /> 0.000000   1.761988   0.000000<br /> 0.000000   0.000000  12.243416<br />nband        10<br />#  include metallic occupation function with a small smearing<br />occopt       7<br />tsmear       0.001<br />natom        2<br />typat        1 1<br />xred         <br />         0.500000000   0.000000000   0.521829741<br />         0.000000000   0.500000000   0.478170259<br />nstep        800<br />ntypat       1<br />znucl        5<br />*********************************************************************************************************<br />ANADDB_Input<br /># turn on calculation of the electron-phonon quantities<br />elphflag 1<br />nqpath  15 <br />qpath<br />                       0.00000000E+00  0.00000000E+00  0.00000000E+00                       <br />                       1.25000000E-01  0.00000000E+00  0.00000000E+00<br />                       2.50000000E-01  0.00000000E+00  0.00000000E+00<br />                       3.75000000E-01  0.00000000E+00  0.00000000E+00<br />                       5.00000000E-01  0.00000000E+00  0.00000000E+00<br />                       0.00000000E+00  2.50000000E-01  0.00000000E+00<br />                       1.25000000E-01  2.50000000E-01  0.00000000E+00<br />                       2.50000000E-01  2.50000000E-01  0.00000000E+00<br />                       3.75000000E-01  2.50000000E-01  0.00000000E+00<br />                       5.00000000E-01  2.50000000E-01  0.00000000E+00<br />                       0.00000000E+00  5.00000000E-01  0.00000000E+00<br />                       1.25000000E-01  5.00000000E-01  0.00000000E+00<br />                       2.50000000E-01  5.00000000E-01  0.00000000E+00<br />                       3.75000000E-01  5.00000000E-01  0.00000000E+00<br />                       5.00000000E-01  5.00000000E-01  0.00000000E+00<br />mustar 0.136<br />ngqpt 4 2 1<br />asr 2 <br />dipdip 0<br />brav 1<br />nqshft 1<br />q1shft 0.0 0.0 0.0<br />ifcflag 1<br />ifcana 1<br />ifcout 0<br />natifc 0<br />atifc 1 2 3<br />dieflag 0<br />eivec 1<br />nph1l 1<br />qph1l<br />              0.00000000E+00  0.00000000E+00  0.00000000E+00 1<br />*********************************************************************************************<br />Best,<br />Beda</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=3612&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 19:56:46 GMT -->
</html>
