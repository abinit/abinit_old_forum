<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3176&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:17:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; parallel_run error of abinit 3</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>parallel_run error of abinit 3</h2>
		<p><a href="viewtopic9c11.html?f=3&amp;t=3176">https://forum.abinit.org/viewtopic.php?f=3&amp;t=3176</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>parallel_run error of abinit 3</h3>
				<div class="date">Posted: <strong>Mon Jan 11, 2016 10:01 pm</strong></div>
				<div class="author">by <strong>anemonekgo</strong></div>
				<div class="content">Dear all,<br /><br />I'm always thankful for the help.<br />Continuously, I'm trying for parallelization of abinit from the end of last year.<br />I got advice in this forum twice so far to come on today's stage.<br /><br />My former question was about error of the &quot;libraries&quot; when having started abinit by parallelization.<br />Thanks to your advice, I was able to disappear &quot;libraries errors&quot;that well.<br /><br />#Because the record of the past exchanges was a long sentence, I made the following links<br />==New questions; parallel_run error of abinit &lt; <!-- l --><a class="postlink-local" href="viewtopic1627.html?f=2&amp;t=3171">viewtopic.php?f=2&amp;t=3171</a><!-- l --> &gt;<br /><br />When it was over, the following new error message occurred.<br /><br /><strong class="text-strong">$ mpirun -np 8 -machinefile /home/appwg-3/my_hosts abinit &lt; BaTiO3.files &gt; BaTiO3.log</strong><br /><blockquote class="uncited"><div>root@node00:/home/appwg-3/BaTiO3_n8_cluster# mpirun -np 8 -machinefile /home/appwg-3/my_hosts abinit &lt; BaTiO3.files &gt; BaTiO3.log<br /><br />Program received signal SIGILL: Illegal instruction.<br /><br />Backtrace for this error:<br /><br />Program received signal SIGILL: Illegal instruction.<br /><br />Backtrace for this error:<br />#0  0x7f1e27e2f642<br />#1  0x7f1e27e2fd7e<br />#2  0x7f1e2756bd3f<br />#3  0x11e4a4f<br />#4  0xdb6a3c<br />#5  0xdac65e<br />#6  0xd7e8e1<br />#7  0xd24655<br />#8  0x478548<br />#9  0x47814c<br />#0  0x7fada22d5642<br />#1  0x7fada22d5d7e<br />#2  0x7fada1a11d3f<br />#3  0x11e4a4f<br />#4  0xdb6a3c<br />#5  0xdac65e<br />#6  0xd7e8e1<br />#7  0xd24655<br />#8  0x478548<br />#9  0x47814c<br />#10  0x7fada19fcec4<br />#11  0x47817c<br />#12  0xffffffffffffffff<br />#10  0x7f1e27556ec4<br />#11  0x47817c<br />#12  0xffffffffffffffff<br /><br />Program received signal SIGILL: Illegal instruction.<br /><br />Backtrace for this error:<br />#0  0x7f7a4b4bc642<br />#1  0x7f7a4b4bcd7e<br />#2  0x7f7a4abf8d3f<br />#3  0x11e4a4f<br />#4  0xdb6a3c<br />#5  0xdac65e<br />#6  0xd7e8e1<br />#7  0xd24655<br />#8  0x478548<br />#9  0x47814c<br />#10  0x7f7a4abe3ec4<br />#11  0x47817c<br />#12  0xffffffffffffffff<br /><br />Program received signal SIGILL: Illegal instruction.<br /><br />Backtrace for this error:<br />#0  0x7f7bb9b29642<br />#1  0x7f7bb9b29d7e<br />#2  0x7f7bb9265d3f<br />#3  0x11e4a4f<br />#4  0xdb6a3c<br />#5  0xdac65e<br />#6  0xd7e8e1<br />#7  0xd24655<br />#8  0x478548<br />#9  0x47814c<br />#10  0x7f7bb9250ec4<br />#11  0x47817c<br />#12  0xffffffffffffffff<br />--------------------------------------------------------------------------<br />mpirun noticed that process rank 6 with PID 3539 on node node01 exited on signal 4 (Illegal instruction).<br />--------------------------------------------------------------------------<br /></div></blockquote><br /><br />*Please refer to Log of attachment.<br />------------------------------------------<br />#my_hosts<br />192.168.0.100 node00 slots=4 max-slots=4<br />192.168.0.101 node01 slots=4 max-slots=4<br />------------------------------------------<br /><br />At this point in time I do not know what the cause is.<br /><br />Would you tell me advice about this cause?<br /><br />Please help me again.<br /><br />Best regards,<br />anmonekgo<br />(Haruyuki Satou)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: parallel_run error of abinit 3</h3>
				<div class="date">Posted: <strong>Wed Jan 13, 2016 1:05 pm</strong></div>
				<div class="author">by <strong>pouillon</strong></div>
				<div class="content">This happens because the node on which you're running Abinit has a different architecture than the one on which you built it.<br /><br />Rebuilding Abinit with optimizations compatible with the <strong class="text-strong">run-time</strong> architecture shoudl solve your problem.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: parallel_run error of abinit 3</h3>
				<div class="date">Posted: <strong>Thu Jan 14, 2016 11:12 pm</strong></div>
				<div class="author">by <strong>anemonekgo</strong></div>
				<div class="content">Dear Pouillon,<br /><br />Thank you for your prompt reply.<br />I am going to study the run-time architecture now for and examine the method that you suggest.<br />If a result of the examination is obtained, I am going to report it.<br /><br />With many thanks,<br />anemonekgo<br />(Haruyuki Satou)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: parallel_run error of abinit 3&nbsp;&nbsp;<span style="color: #006600">[SOLVED]</span></h3>
				<div class="date">Posted: <strong>Mon Jan 25, 2016 7:16 am</strong></div>
				<div class="author">by <strong>anemonekgo</strong></div>
				<div class="content">Dear Pouillon,<br />CC:Dear all,<br /><br /> <br />I'm always thankful for the help.<br /><br />The advice from you was very helpful.<br /><br />As a result of trying the following optimization based on your advice, all the 64cpu was able to run.<br /><br />@optimization of the abinit configure options<br /><br />0) ./configure --with-config-file=&quot;./ubuntu.ac&quot; 　　　　　　　　　　　　　　　 #base#    <br />=&gt;Terminated with the above error<br /><br />1)+ fcflags_opt_67_common=&quot;-O2&quot; fcflags_opt_77_lwf=&quot;-O2&quot; fcflags_opt_wannier90=&quot;-O2&quot;  <br />=&gt;Terminated with the same error<br /><br />2)+ fcflags_opt_67_common=&quot;-O2&quot; fcflags_opt_77_lwf=&quot;-O2&quot; fcflags_opt_wannier90=&quot;-O2&quot; --enable-optim=&quot;no&quot; --enable-debug=&quot;enhanced&quot;<br />=&gt;All the CPUs ran simultaneously! But calculation speed was slow(about 2x). <br /><br />3)+ fcflags_opt_67_common=&quot;-O2&quot; fcflags_opt_77_lwf=&quot;-O2&quot; fcflags_opt_wannier90=&quot;-O2&quot;  --enable-debug=&quot;enhanced&quot;<br />=&gt;All the CPUs ran simultaneously! But calculation speed was slow(about 2x). <br /><br />4)+ fcflags_opt_67_common=&quot;-O2&quot; fcflags_opt_77_lwf=&quot;-O2&quot; fcflags_opt_wannier90=&quot;-O2&quot; --enable-optim=&quot;no&quot;<br />=&gt;All the CPUs ran simultaneously! But calculation speed was slow(about 2x).<br /> <br />5)+ fcflags_opt_67_common=&quot;-O2&quot; fcflags_opt_77_lwf=&quot;-O2&quot; fcflags_opt_wannier90=&quot;-O2&quot; -enable-optim=&quot;safe&quot;<br /><strong class="text-strong"><span style="text-decoration: underline"><span style="color: #4000FF">=&gt;All the CPUs ran simultaneously! And normal speed end!</span></span></strong><br /><br /><br />Thanks to you, I was able to run 16node(x4cpu).<br /><br />But there are cases when It occasionally stops calculation by the following error.<br /><br />The mpirun command that I use;<br /><br />$ mpirun --allow-run-as-root -np 64 -machinefile my_hosts abinit &lt; BaTiO3.files &gt; BaTiO3.log <br /><br />It seems to be communication fault [ of one node ] ?.　~~~hostname (IP-addr.) isn't same each time.<br /><br />=======================================================================================================<br /><br /> ITER STEP NUMBER     2<br /> vtorho : nnsclo_now=  2, note that nnsclo,dbl_nnsclo,istep=  0 0  2<br />--------------------------------------------------------------------------<br />ORTE has lost communication with its daemon located on node:<br /><br />  hostname:  192.168.0.101<br /><br />This is usually due to either a failure of the TCP network<br />connection to the node, or possibly an internal failure of<br />the daemon itself. We cannot recover from this failure, and<br />therefore will terminate the job.<br /><br />--------------------------------------------------------------------------<br />=======================================================================================================<br /><br />This is investigating the cause at present.<br /><br />I would appreciate it if you would give me some advice.<br /><br />Best regards,<br />anemonekgo<br />(Satou Haruyuki)<br /><br /><br />=====================================================================================================================<br />@Remarks<br /><br />#ubuntu.ac<br />--------------------------------------------------------------------------------------------------------------------<br />prefix=&quot;/usr/local&quot;<br />enable_mpi=&quot;yes&quot;<br />enable_mpi_io=&quot;yes&quot;<br />with_mpi_prefix=&quot;/usr/local/openmpi&quot;<br />#with_trio_flavor=&quot;netcdf+etsf_io&quot;<br />with_trio_flavor=&quot;netcdf+etsf_io+fox&quot;<br />#with_netcdf_incs=&quot;-I/usr/local/netcdf-4.3.3/gcc49/include&quot;<br />#with_netcdf_libs=&quot;-L/usr/local/netcdf-4.3.3/gcc49/lib -lnetcdf -lnetcdff&quot;<br />with_fft_flavor=&quot;fftw3&quot;<br />with_fft_incs=&quot;-I/usr/local/fftw/3.3.4/include&quot;<br />with_fft_libs=&quot;-L/usr/local/fftw/3.3.4/lib -lfftw3 -lfftw3_mpi -lfftw3_threads -lfftw3f -lfftw3f_mpi -lfftw3f_threads&quot;<br />with_linalg_flavor=&quot;atlas&quot;<br />with_linalg_libs=&quot;-L/usr/lib -llapack -lf77blas -lcblas -latlas&quot;<br />#with_linalg_flavor=&quot;netlib&quot;<br />#with_linalg_libs=&quot;-L/usr/local/lib -llapack -lblas&quot;<br />#with_linalg_flavor=&quot;netlib+scalapack&quot;<br />#with_linalg_libs=&quot;-L/usr/local/lib -lscalapack -llapack -lblas&quot;<br />with_dft_flavor=&quot;atompaw+bigdft+libxc+wannier90&quot;      <br />#with_dft_flavor=&quot;atompaw+libxc&quot;<br />enable_gw_dpc=&quot;yes&quot;<br />#enable_openmp=&quot;yes&quot;<br />-----------------------------------------------------------------------------------------------------------------------<br />#my_hosts<br />-------------------------------------------------<br />192.168.0.100 node00 slots=4   #master node<br />192.168.0.101 node01 slots=4<br />192.168.0.102 node02 slots=4<br />192.168.0.103 node03 slots=4<br />192.168.0.104 node04 slots=4<br />192.168.0.105 node05 slots=4<br />192.168.0.106 node06 slots=4<br />192.168.0.107 node07 slots=4<br />192.168.0.108 node08 slots=4<br />192.168.0.109 node09 slots=4<br />192.168.0.110 node10 slots=4<br />192.168.0.111 node11 slots=4<br />192.168.0.112 node12 slots=4<br />192.168.0.113 node13 slots=4<br />192.168.0.114 node14 slots=4<br />192.168.0.115 node15 slots=4<br />----------------------------------------------------</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: parallel_run error of abinit 3</h3>
				<div class="date">Posted: <strong>Thu Feb 04, 2016 1:56 am</strong></div>
				<div class="author">by <strong>anemonekgo</strong></div>
				<div class="content">Dear all,<br /><br />I'm always thankful for the help.<br />The other day, I described on my cluster error problems. <br />Then I was able to found the network error and the communication error between the nodes which were under investigation. <br /><br />I'm going to report as a memo. <br /><br />Stated simply, my cluster was crashing for the cause of an error by the traffic jam of LAN. <br /><br />This error is caused when greater &quot;natom&quot; structures.<br /><br />As a countermeasure;<br />I did change the Network interfaces.<br />------------------------------------------------------------------------------------------------------------<br />$ Master node00 NIC :1Gbps     ==&gt;&gt; 10Gbps　　　　　　          　  　#Intel card　　　　　<br />$ LAN switching hub :1Gbpsx16  ==&gt;&gt; 10Gbpsx2+1Gbpsx24        #NETGEAR<br />$ Clients node01-15 :1Gbpsx15  ==&gt;&gt; ~leave~                            #ASUS onboad LAN<br />------------------------------------------------------------------------------------------------------------<br />I could be confirmed until &quot;natom ~300&quot; is running in the current situation with &quot;np = 64&quot;.<br /><br />PS<br />The truth is that I would like to change all Network interfaces into 10 Gbps, but it is very expensive. <br />Therefore I'm going to see a situation at the present setting. <br />Moreover, the value in connection with communication of &quot;net.core.somaxconn etc&quot; is also enlarged. <br />But, essential solution was not completed although the tendency which the setting improves was seen. <br /><br />Best regards,<br />anmonekgo<br />(Haruyuki Satou)</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3176&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 02:17:17 GMT -->
</html>
