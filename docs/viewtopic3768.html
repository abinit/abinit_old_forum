<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=12&t=3019&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 21:04:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Problem with ABINITBandStructureMaker</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Problem with ABINITBandStructureMaker</h2>
		<p><a href="viewtopicb4a6.html?f=12&amp;t=3019">https://forum.abinit.org/viewtopic.php?f=12&amp;t=3019</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Sun Jun 07, 2015 8:20 pm</strong></div>
				<div class="author">by <strong>tom8</strong></div>
				<div class="content">I have successfully installed ABINIT 7.4.3 from <a href="viewtopic0a16.html?f=2&amp;t=1619" class="postlink">http://forum.abinit.org/viewtopic.php?f=2&amp;t=1619</a>, and run the example t30 file and got a correct t30.out. I then installed Python and numpy (using Enthought Canopy). I downloaded ABINITBandStructureMaker, ran it and successfully got the .dbs file. Now I run it again hoping to produce the .agr file, but got the following error:<br /><br />RuntimeWarning: invalid value encountered in double_scalars<br />arg = dot(vector1, vector2)/norm(vector1)/norm(vector2)<br />TraceBack (most recent call last):<br />File: ABINITBandStructureMaker.py, line 1290, in &lt;module&gt;<br />minLUMOList.append(ctrl.Y[i][ctrl.nvalenceband]&gt;<br />IndexError: index out of bounds<br /><br />What is the solution to this problem? It seems to be related to the number of valence bands, which is 4.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Sat Mar 12, 2016 4:56 am</strong></div>
				<div class="author">by <strong>letuan</strong></div>
				<div class="content">I have the similar difficulty with AbinitBandStructureMaker.py at the second step of its running. The first step with the creation .dbs file was made smoothly (probably with &quot;nband&quot; parameter, though in my .dbs file it was figured as 24?):<br />=========================================<br /> AbinitBandStructureMaker.py version 1.3<br />=========================================<br />Traceback (most recent call last):<br />  File &quot;/home/letuan/Tools/Abinit_postproc/AbinitBandStructureMaker.py&quot;, line 1291, in &lt;module&gt;<br />    maxHOMO = max(maxHOMOlist)<br />ValueError: max() arg is an empty sequence<br /><br />I use Python 2.6 as default version in Rocks 6.2 and Abinit v. 7.10.4. <br />I appreciate any suggestion for overcoming it.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Sun Aug 07, 2016 7:28 am</strong></div>
				<div class="author">by <strong>Vladimir</strong></div>
				<div class="content">I've got another issue: ABINITBandStructureMaker can't parse the input file with 2 datasets.<br /><br />traceback<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>=========================================<br />&nbsp;AbinitBandStructureMaker.py version 1.3<br />=========================================<br /><br />2 dataset(s) detected<br /><br />Which dataset(s) do you want to use (1 to 2) ? 2<br />Traceback (most recent call last):<br />&nbsp; File &quot;AbinitBandStructureMaker.py&quot;, line 836, in &lt;module&gt;<br />&nbsp; &nbsp; datasetkey&#91;-1&#93;.append(float(starter&#91;i&#93;.split()&#91;1&#93;))<br />ValueError: could not convert string to float: =</code></pre></div><br /><br />variable <strong class="text-strong">starter[i]</strong> actualy is <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>natom =&nbsp; &nbsp; &nbsp; &nbsp;8&nbsp; nloc_mem =&nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; nspden =&nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp;nspinor =&nbsp; &nbsp; &nbsp; &nbsp;1</code></pre></div>, so .split()[1] is <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>=</code></pre></div><br /><br />the input</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Wed Aug 10, 2016 5:11 pm</strong></div>
				<div class="author">by <strong>Mohamedy002</strong></div>
				<div class="content">Please read the pdf in the following link. <br /><a href="http://www.gnu-darwin.org/www001/ports-1.5a-CURRENT/science/abinit/work/abinit-5.2.4/doc/users/AbinitBandStructureMaker_manual.pdf" class="postlink">http://www.gnu-darwin.org/www001/ports-1.5a-CURRENT/science/abinit/work/abinit-5.2.4/doc/users/AbinitBandStructureMaker_manual.pdf</a><br />I think you need to edit the .dbs file</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Wed Aug 10, 2016 5:23 pm</strong></div>
				<div class="author">by <strong>Mohamedy002</strong></div>
				<div class="content">Hi Vladimir,<br /><br />Actually to fix this error here is a simple trick that ... I suggest modifying the &quot;AbinitBandStructureMaker.py&quot; file by removing the float before the starter. It works well with me  <img class="smilies" src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><br />for the .dbs file <br /><br />$ python AbinitBandStructureMaker.py<br /><br />=========================================<br /> AbinitBandStructureMaker.py version 1.3<br />=========================================<br /><br />Enter the filename :<br />AgN3.out<br /><br />2 dataset(s) detected<br /><br />Which dataset(s) do you want to use (1 to 2) ? 2<br /><br />&quot;AgN3.out.dbs&quot; file created successfully<br /><br /><br /><br /><br />for the .agr file <br />$ python AbinitBandStructureMaker.py AgN3.out.dbs<br /><br />=========================================<br /> AbinitBandStructureMaker.py version 1.3<br />=========================================<br /><br />&quot;AgN3.out.agr&quot; file created successfully<br /><br /><br />Then by using the xmgrace plotting tool you can execute the following command <br /><br />xmgrace AgN3.out.agr <br /><br />Finally you got the attached band structure<br /><br /><br />Mohamed Yousef Hassan,<br />EEE department,<br />Nanyang Technological University,<br />Singapore.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Thu Aug 11, 2016 7:54 am</strong></div>
				<div class="author">by <strong>Vladimir</strong></div>
				<div class="content"><blockquote><div><cite>Mohamedy002 wrote:</cite>Hi Vladimir,<br /><br />Actually to fix this error here is a simple trick that ... I suggest modifying the &quot;AbinitBandStructureMaker.py&quot; file by removing the float before the starter. It works well with me  <img class="smilies" src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" />  <img class="smilies" src="images/smilies/icon_e_biggrin.gif" alt=":D" title="Very Happy" /><br /><br /><br />Mohamed Yousef Hassan,<br />EEE department,<br />Nanyang Technological University,<br />Singapore.</div></blockquote><br /><br />Hi Mohamed.<br /><br />It's very strange workaround because starter[i] is &quot;natom =       8  nloc_mem =       1    nspden =       1   nspinor =       1&quot; but we want natom value, so starter[i].split()[2] is the answer.<br /><br />this string came from:<blockquote class="uncited"><div> DATASET    1 : space group Ib a m (# 72); Bravais oI (body-center ortho.)<br />================================================================================<br /> Values of the parameters that define the memory need for DATASET  1.<br />     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       4<br />     lnmax =       4     mgfft =      60  mpssoang =       4    mqgrid =    3001<br />     natom =       8  nloc_mem =       1    nspden =       1   nspinor =       1<br />    nsppol =       1      nsym =       8    n1xccc =       0    ntypat =       2<br />    occopt =       1   xclevel =       1<br />-    mband =          27        mffmem =           1         mkmem =           1<br />       mpw =        4056          nfft =      216000          nkpt =           1<br />================================================================================<br />P This job should need less than                      62.096 Mbytes of memory.<br />  Rough estimation (10% accuracy) of disk space for files :<br />_ WF disk file :      1.673 Mbytes ; DEN or POT disk file :      1.650 Mbytes.<br />================================================================================<br /><br /><br /> DATASET    2 : space group Ib a m (# 72); Bravais oI (body-center ortho.)<br />================================================================================<br /> Values of the parameters that define the memory need for DATASET  2.<br />     intxc =       0    ionmov =       0      iscf =      -2    lmnmax =       4<br />     lnmax =       4     mgfft =      60  mpssoang =       4    mqgrid =    3001<br />     natom =       8  nloc_mem =       1    nspden =       1   nspinor =       1<br />    nsppol =       1      nsym =       8    n1xccc =       0    ntypat =       2<br />    occopt =       1   xclevel =       1<br />-    mband =          27        mffmem =           1         mkmem =          21<br />       mpw =        8200          nfft =      216000          nkpt =          21<br />================================================================================</div></blockquote><br /><br />but there is another natom definition<br /><blockquote class="uncited"><div>--------------------------------------------------------------------------------<br />------------- Echo of variables that govern the present computation ------------<br />--------------------------------------------------------------------------------<br />....<br /><br />           kptopt1          1<br />           kptopt2         -1<br />         kptrlatt        1    0    0      0    1    0      0    0    1<br />          kptrlen1     9.59379937E+00<br />          kptrlen2     3.00000000E+01<br />P           mkmem1          1<br />P           mkmem2         21<br />            natom           8<br />            nband1         27<br />            nband2         27<br />           nbdbuf1          0<br />           nbdbuf2          2<br />           ndtset           2<br />            ngfft          60      60      60<br />             nkpt1          1<br />             nkpt2         21<br />             nsym           8<br />           ntypat           2<br /></div></blockquote><br /><br />I think if we want to get proper value of input variables we should parse only &quot;Echo of variables that govern the present computation&quot; section or DATASET# section not both.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Thu Aug 11, 2016 9:05 am</strong></div>
				<div class="author">by <strong>Mohamedy002</strong></div>
				<div class="content">Hi Vladimir,<br /><br />First, since the python script can detect the data sets in the output files and ask you to enter the number of the data set you want to manipulate, then the parser will go inside the given data set only and will not go through the &quot; Echo of variables that govern the present computation&quot;. Therefore, I think this is not the problem.<br /><br /><br />Second, from my point of view python see the values inside the output data files as string not integers or float. Therefore when you put float(starter[i],split()[1]) it gives you error <br /><br />Mohamed Yousef Hassan <br />EEE, Nanyang Technological University,<br />Singapore.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Thu Aug 11, 2016 12:01 pm</strong></div>
				<div class="author">by <strong>Vladimir</strong></div>
				<div class="content">Hi Mohamed.<br /><br />look in the end of your AgN3.out.in file attached (11.36 KiB).<br /><br /><br /><blockquote class="uncited"><div>DATABASE KEY:<br />ecut: 40.0<br />natom: = = 8<br />nband: 27.0<br />occopt: = =<br />toldfe: 0.0<br />toldff: 0.0<br />tolvrs: 0.0<br />tolwfr: 1e-12<br />typat: 2 2 1 1 1 1 1 1<br />reciprocalvectors: 0.0 0.0884912 0.0882256 0.0944959 0.0 0.0882256 0.0944959 0.0884912 0.0<br />reducedcoordinates: 0.25 0.25 0.0 0.75 0.75 -0.0 0.1327 0.3422 0.4749 0.0 0.5 0.5 -0.1327 -0.3422 -0.4749 0.6327 0.1578 0.7905 0.5 0.0 0.5 -0.6327 -0.1578 -0.7905</div></blockquote><br /><br /><strong class="text-strong">natom: = = 8</strong> <br />this means that 1st and 2nd DATASET parsed with result '=' (this cannot convert to float) and 'Echo of variables that govern the present computation' section parsed with result '8'.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>starter = ctrl.filedata&#91;:ctrl.datasetlocation&#91;0&#93;&#91;2&#93;-1&#93;</code></pre></div><br />starter is a list of lines from file start to 188 line (&quot;== DATASET  1 ==================================================================&quot;)</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Thu Aug 11, 2016 12:31 pm</strong></div>
				<div class="author">by <strong>Mohamedy002</strong></div>
				<div class="content">I see I can figure now why we have two equal sign in front of each variable like &quot;natom&quot;. But I think after getting the .dbs you can edit it. Right?<br />so at least we have the .dbs file which we can then edit further.<br /><br />That's why we don't have any error concerning &quot;ecut&quot; and &quot;nband&quot; since they are mentioned only in the &quot;Echo of variables that govern the present computation&quot; only in this section compared to &quot;natom&quot; which is mentioned in Data set 1 section, Data set 2 section and the &quot;Echo of variables that govern the present computation&quot; section. <br /><br /><br />Also please find the attached reference band structure of silver azide from literature. <br /><br /><br />Mohamed Yousef Hassan,<br />EEE Nanyang Technological University, <br />Singapore.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Problem with ABINITBandStructureMaker</h3>
				<div class="date">Posted: <strong>Thu Oct 27, 2016 5:32 am</strong></div>
				<div class="author">by <strong>Mutta</strong></div>
				<div class="content">Hi Mohamed and Vladimir<br /><br />For a newbies, how can I fix it ?<br /><br />I ran abinitbandstructuremaker.py and got the error see below<br /><br />=========================================<br /> AbinitBandStructureMaker.py version 1.3<br />=========================================<br /><br />2 dataset(s) detected<br /><br />Which dataset(s) do you want to use (1 to 2) ? 2<br />Traceback (most recent call last):<br />  File &quot;../band.py&quot;, line 836, in &lt;module&gt;<br />    datasetkey[-1].append(float(starter[i].split()[1]))<br />ValueError: could not convert string to float: =<br /><br />How can I fix it by step by step ?<br /><br />Mutta<br /><br />Physics Thailand</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=12&t=3019&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 21:04:00 GMT -->
</html>
