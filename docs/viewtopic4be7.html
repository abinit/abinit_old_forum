<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1429&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:05:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; [WARNING]  Wavefunctions not converged for non-scf cal</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>[WARNING]  Wavefunctions not converged for non-scf cal</h2>
		<p><a href="viewtopicc8da.html?f=10&amp;t=1429">https://forum.abinit.org/viewtopic.php?f=10&amp;t=1429</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>[WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Sat Nov 19, 2011 2:42 pm</strong></div>
				<div class="author">by <strong>Zhang Xiaole</strong></div>
				<div class="content">Dear users <br />    i am trying to calculate the non-linear suscepblity of LiNbO3.After structure optimization, i run the calculation of response fuction.In the process of non-self calculation, the log file warning me wavefunction not converged for nnsclo. i think this will not be good to the results, i wonder how to sovle this promble,besids, my nstep=3000 is not a small one. Why dosnt it converged?<br />this is my input file<div class="inline-attachment">
			
		
		
				<dl class="file">
			<dt><img src="images/upload_icons/txt.gif" alt="" /> <a class="postlink" href="download/filedfca.php?id=464">tnlo_2.in</a></dt>
						<dd>(2.44 KiB) Downloaded 417 times</dd>
		</dl>
		
		
			</div><br />Thanks in advanced <br /><br /><br /><br />--Xiaole</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Sat Nov 19, 2011 2:46 pm</strong></div>
				<div class="author">by <strong>Zhang Xiaole</strong></div>
				<div class="content">this is my log file<br /><br />  vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000    4 max resid=  1.96403E-10<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000   25 max resid=  1.96420E-10<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000   74 max resid=  1.14385E-18<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000   76 max resid=  9.39728E-16<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000   90 max resid=  9.39747E-16<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000  193 max resid=  1.96455E-10<br /><br /> vtowfk: WARNING -<br />  Wavefunctions not converged for nnsclo,ikpt= 3000  202 max resid=  9.39730E-16<br /> leave_test : synchronization done...<br /> vtorho: loop on k-points and spins done in parallel<br /><br /> scprqt:  WARNING -<br />  nstep= 3000 was not enough non-SCF iterations to converge;<br />  maximum residual=  1.965E-10 exceeds tolwfr=  1.000E-20<br /><br /> ioarr: writing density data<br /> ioarr: file name is tnlo_2o_DS2_DEN<br /> ioarr: data written to disk file tnlo_2o_DS2_DEN<br /> leave_test : synchronization done...<br />================================================================================<br /><br /> ----iterations are completed or convergence reached----<br /><br /> outwf  : write wavefunction to file tnlo_2o_DS2_WFK<br /> leave_test : synchronization done...<br /><br /> === Gap info ===<br />  &gt;&gt;&gt;&gt; For spin  1<br />   Minimum optical gap =   2.3507 [eV], located at k-point      :   0.0625  0.0625  0.0625<br />   Fundamental gap     =   2.2908 [eV], Top of valence bands at :   0.0625  0.0625  0.0625<br />                                        Bottom of conduction at :  -0.4375 -0.4375  0.0625<br /><br />================================================================================</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Mon Dec 05, 2011 11:19 am</strong></div>
				<div class="author">by <strong>sponce</strong></div>
				<div class="content">Dear Xiaole, <br /><br />I've look at your input file and I have the following suggestions:<br /><br />1) Are you sure that your atoms are in the relaxed position? A small deviation from the minimum can lead to pretty bad results as the DFPT is based on the assumption that we are in the ground state position and we smally perturb away from it.<br />2) iscf 7 is usually beter than iscf 5 for nc psp (I knwo that in the tutorial it is iscf 5 but it is an old tutorial). <!-- m --><a class="postlink" href="http://www.abinit.org/documentation/helpfiles/for-v6.10/input_variables/varbas.html#iscf">http://www.abinit.org/documentation/hel ... .html#iscf</a><!-- m --><br />3) In your first dataset, why is toldfe at 1E10. We usually take at least 1E12<br />4) why are you putting nbdbuf 0 ? I would put it to something like 4 (and increase nband accordingly). This will help you converge your wf. <br /><br />If non of the above work, I would say that yes your nstep is very high and that a residue of 1E-10 seems not so bad to me...</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Mon Dec 05, 2011 2:03 pm</strong></div>
				<div class="author">by <strong>Zhang Xiaole</strong></div>
				<div class="content"><blockquote><div><cite>sponce wrote:</cite>Dear Xiaole, <br /><br />I've look at your input file and I have the following suggestions:<br /><br />1) Are you sure that your atoms are in the relaxed position? A small deviation from the minimum can lead to pretty bad results as the DFPT is based on the assumption that we are in the ground state position and we smally perturb away from it.<br />2) iscf 7 is usually beter than iscf 5 for nc psp (I knwo that in the tutorial it is iscf 5 but it is an old tutorial). <!-- m --><a class="postlink" href="http://www.abinit.org/documentation/helpfiles/for-v6.10/input_variables/varbas.html#iscf">http://www.abinit.org/documentation/hel ... .html#iscf</a><!-- m --><br />3) In your first dataset, why is toldfe at 1E10. We usually take at least 1E12<br />4) why are you putting nbdbuf 0 ? I would put it to something like 4 (and increase nband accordingly). This will help you converge your wf. <br /><br />If non of the above work, I would say that yes your nstep is very high and that a residue of 1E-10 seems not so bad to me...</div></blockquote><br />Dear sponce,<br />        Thanks for you kind reponses, i am really appreciate. i am also wondering if there someting wrong with my structure optimization, and i noticed the nband parameters as well (i just used the default value that the code generate, i found that the value is equal to the vanlence band.). So this time i just rise  5 or 6 nband above the vanlence band (is that ok?) and is the parameter for nbdbuf neccesery equal to the number that i rised (like 5 or 6)?</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Mon Dec 05, 2011 2:19 pm</strong></div>
				<div class="author">by <strong>sponce</strong></div>
				<div class="content">Dear Xiaole, <br /><br />The <strong class="text-strong">nbdbuf</strong> variable give you the number of band to put in the buffer. What it mean is that the code will use those band as a buffer and therefore you will have a faster convergence on your wavefunction. As those bands are in the buffer it is not consider as true band and then not converged upon. It mean that the buffer bands will not be converged. These bands are just there to allow some flexibility in the convergence. If you material is a semiconductor I would recommend you to use:<br /><br />nband = number of valence band + 4 (conduction bands) + 4 buffer bands<br />nbdbuf = 4<br /><br />It mean that the true band on which the convergence will be done is number of valence band + 4<br /><br />Cheers!</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [WARNING]  Wavefunctions not converged for non-scf cal</h3>
				<div class="date">Posted: <strong>Mon Dec 05, 2011 2:37 pm</strong></div>
				<div class="author">by <strong>Zhang Xiaole</strong></div>
				<div class="content"><blockquote><div><cite>sponce wrote:</cite>Dear Xiaole, <br /><br />The <strong class="text-strong">nbdbuf</strong> variable give you the number of band to put in the buffer. What it mean is that the code will use those band as a buffer and therefore you will have a faster convergence on your wavefunction. As those bands are in the buffer it is not consider as true band and then not converged upon. It mean that the buffer bands will not be converged. These bands are just there to allow some flexibility in the convergence. If you material is a semiconductor I would recommend you to use:<br /><br />nband = number of valence band + 4 (conduction bands) + 4 buffer bands<br />nbdbuf = 4<br /><br />It mean that the true band on which the convergence will be done is number of valence band + 4<br /><br />Cheers!</div></blockquote><br />Dear sponce <br />      Thank you very much, i think i have a little bit deeper understanding for the calculation.i will have a try immediately. Thank you again~<br /><br />       Xiaole</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=1429&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:05:31 GMT -->
</html>
