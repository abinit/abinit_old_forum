<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3982&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 18:40:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; [Linux+gpu] Abinit 8.10.1 Linking fails with error</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>[Linux+gpu] Abinit 8.10.1 Linking fails with error</h2>
		<p><a href="viewtopic2197.html?f=3&amp;t=3982">https://forum.abinit.org/viewtopic.php?f=3&amp;t=3982</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>[Linux+gpu] Abinit 8.10.1 Linking fails with error</h3>
				<div class="date">Posted: <strong>Fri Nov 30, 2018 6:41 am</strong></div>
				<div class="author">by <strong>Lucius</strong></div>
				<div class="content">Hello dear community,<br />I am trying to compile GPU version of abinit-8.10.1 with this configuration:<br /><br />CC=mpicc CXX=mpicxx FC=mpif90 ./configure --enable-gpu --enable-mpi --with-mpi-incs=-I/usr/include/ --with-gpu-libs=&quot;-L/opt/cuda/lib64 -lcublas -lcufft -lcudart&quot; --with-gpu-incs=&quot;-I/opt/cuda/include&quot; --with-linalg-flavor=&quot;magma+custom&quot; --with-linalg-incs=&quot;-I/usr/include -I/home/lucius/local/share/magma/include&quot; --with-linalg-libs=&quot;-L/usr/lib64 -lblas -llapack -L/home/lucius/local/share/magma/lib -lmagma&quot;<br /><br />After successful compilation of source files, linking fails with error:<br /><br />mpif90 -ffree-form -J/home/lucius/local/share/abinit-8.10.1/src/mods   -O2 -mtune=native -march=native -g -ffree-line-length-none    -g -ffree-line-length-none     -o abinit abinit-abinit.o  ../../src/95_drive/lib95_drive.a ../../src/94_scfcv/lib94_scfcv.a ../../src/79_seqpar_mpi/lib79_seqpar_mpi.a ../../src/78_effpot/lib78_effpot.a ../../src/78_eph/lib78_eph.a ../../src/77_ddb/lib77_ddb.a ../../src/77_suscep/lib77_suscep.a ../../src/72_response/lib72_response.a ../../src/71_bse/lib71_bse.a ../../src/71_wannier/lib71_wannier.a ../../src/70_gw/lib70_gw.a ../../src/69_wfdesc/lib69_wfdesc.a ../../src/68_dmft/lib68_dmft.a  ../../src/68_recursion/lib68_recursion.a ../../src/68_rsprc/lib68_rsprc.a  ../../src/67_common/lib67_common.a ../../src/66_vdwxc/lib66_vdwxc.a ../../src/66_wfs/lib66_wfs.a ../../src/66_nonlocal/lib66_nonlocal.a ../../src/65_paw/lib65_paw.a  ../../src/64_psp/lib64_psp.a ../../src/62_iowfdenpot/lib62_iowfdenpot.a ../../src/62_wvl_wfs/lib62_wvl_wfs.a ../../src/62_poisson/lib62_poisson.a ../../src/62_cg_noabirule/lib62_cg_noabirule.a ../../src/62_ctqmc/lib62_ctqmc.a ../../src/61_occeig/lib61_occeig.a ../../src/59_ionetcdf/lib59_ionetcdf.a ../../src/57_iovars/lib57_iovars.a ../../src/57_iopsp_parser/lib57_iopsp_parser.a ../../src/56_recipspace/lib56_recipspace.a ../../src/56_xc/lib56_xc.a ../../src/56_mixing/lib56_mixing.a ../../src/56_io_mpi/lib56_io_mpi.a ../../src/55_abiutil/lib55_abiutil.a ../../src/54_spacepar/lib54_spacepar.a ../../src/53_ffts/lib53_ffts.a ../../src/52_manage_cuda/lib52_manage_cuda.a ../../src/52_fft_mpi_noabirule/lib52_fft_mpi_noabirule.a ../../src/51_manage_mpi/lib51_manage_mpi.a ../../src/49_gw_toolbox_oop/lib49_gw_toolbox_oop.a ../../src/46_diago/lib46_diago.a ../../src/45_xgTools/lib45_xgTools.a ../../src/45_geomoptim/lib45_geomoptim.a ../../src/44_abitypes_defs/lib44_abitypes_defs.a ../../src/44_abitools/lib44_abitools.a ../../src/43_wvl_wrappers/lib43_wvl_wrappers.a ../../src/43_ptgroups/lib43_ptgroups.a ../../src/42_parser/lib42_parser.a ../../src/42_nlstrain/lib42_nlstrain.a ../../src/42_libpaw/lib42_libpaw.a ../../src/41_xc_lowlevel/lib41_xc_lowlevel.a ../../src/41_geometry/lib41_geometry.a ../../src/32_util/lib32_util.a ../../src/29_kpoints/lib29_kpoints.a ../../src/28_numeric_noabirule/lib28_numeric_noabirule.a ../../src/27_toolbox_oop/lib27_toolbox_oop.a ../../src/21_hashfuncs/lib21_hashfuncs.a ../../src/18_timing/lib18_timing.a ../../src/17_libtetra_ext/lib17_libtetra_ext.a ../../src/16_hideleave/lib16_hideleave.a ../../src/15_gpu_toolbox/lib15_gpu_toolbox.a ../../src/14_hidewrite/lib14_hidewrite.a ../../src/12_hide_mpi/lib12_hide_mpi.a ../../src/11_memory_mpi/lib11_memory_mpi.a ../../src/10_dumpinfo/lib10_dumpinfo.a ../../src/10_defs/lib10_defs.a ../../src/02_clib/lib02_clib.a  -L/usr/lib64 -lblas -llapack -L/home/lucius/local/share/magma/lib -lmagma -lrt -L/opt/cuda/lib64 -lcublas -lcufft -lcudart -L/usr/lib64 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../x86_64-pc-linux-gnu/lib -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../.. -lmpi_usempif08 -lmpi_usempi_ignore_tkr -lmpi_mpifh -lmpi -lgfortran -lm -lquadmath -lpthread -L/usr/lib64 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../x86_64-pc-linux-gnu/lib -L/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../.. -lmpi_usempif08 -lmpi_usempi_ignore_tkr -lmpi_mpifh -lmpi -lgfortran -lm -lquadmath -lpthread <br />/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: ../../src/52_manage_cuda/lib52_manage_cuda.a(density.o): undefined reference to symbol '__gxx_personality_v0@@CXXABI_1.3'<br />/usr/lib/gcc/x86_64-pc-linux-gnu/7.3.0/libstdc++.so.6: error adding symbols: DSO missing from command line<br />collect2: error: ld returned 1 exit status<br />make[3]: *** [Makefile:3850: abinit] Error 1<br />make[3]: Leaving directory '/home/lucius/local/share/abinit-8.10.1/src/98_main'<br />make[2]: *** [Makefile:924: all-recursive] Error 1<br />make[2]: Leaving directory '/home/lucius/local/share/abinit-8.10.1/src'<br />make[1]: *** [Makefile:2316: all-recursive] Error 1<br />make[1]: Leaving directory '/home/lucius/local/share/abinit-8.10.1'<br />make: *** [Makefile:2244: all] Error 2<br /><br />please help  <img class="smilies" src="images/smilies/icon_cry.gif" alt=":cry:" title="Crying or Very Sad" /><br /><br />P.S. without --enable-gpu same configuration compiles successfully</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [Linux+gpu] Abinit 8.10.1 Linking fails with error&nbsp;&nbsp;<span style="color: #006600">[SOLVED]</span></h3>
				<div class="date">Posted: <strong>Fri Nov 30, 2018 7:54 pm</strong></div>
				<div class="author">by <strong>jun1234</strong></div>
				<div class="content">I think you should add &quot;-lstdc++&quot; to --with-gpu-libs, because cuda runtime libraries need libstdc++ but fortran compiler doesn't know how to link it.<br />(so, your --with-gpu-libs looks like this:  --with-gpu-libs=&quot;-L/opt/cuda/lib64 -lcublas -lcufft -lcudart -lstdc++&quot;)<br />Best regard, Junho</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: [Linux+gpu] Abinit 8.10.1 Linking fails with error</h3>
				<div class="date">Posted: <strong>Sat Dec 01, 2018 6:34 am</strong></div>
				<div class="author">by <strong>Lucius</strong></div>
				<div class="content">Dear Junho,<br />thank you, it worked.</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=3&t=3982&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 18:40:51 GMT -->
</html>
