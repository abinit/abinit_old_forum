<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?p=1109 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:19:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>mpi-io output for large files - ABINIT Discussion Forums</title>


	<link rel="canonical" href="viewtopicad4c.html?t=356">

<!--
	phpBB style name: Flat Style
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      Ian Bradley
-->

<link href="assets/css/font-awesome.minaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/stylesheetaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/en/stylesheetaea1.css?assets_version=57" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/flat-style/theme/tweaks.css?assets_version=57" rel="stylesheet">
<![endif]-->

<meta name="google-site-verification" content="PLdTN48UENWHvJ5ViWhDTahZKzoMyw5e1QZgw1IECVw" />
<link rel="alternate" type="application/atom+xml" title="ATOM" href="app.php/smartfeed/feed.html" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="app.php/smartfeed/feed9830.html?y=2" />

<link href="ext/crizzo/aboutus/styles/prosilver/theme/aboutusaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/dmzx/topicageday/styles/prosilver/theme/topicagedayaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/clock/styles/all/theme/clockaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/googlesearch/styles/prosilver/theme/googlesearchaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/kinerity/bestanswer/styles/prosilver/theme/bestansweraea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbb/collapsiblecategories/styles/all/theme/collapsiblecategoriesaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbbservices/smartfeed/styles/prosilver/theme/customaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/senky/userstatistics/styles/prosilver/theme/userstatisticsaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/tierra/topicsolved/styles/prosilver/theme/buttonsaea1.css?assets_version=57" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description">
				<a id="logo" class="logo" href="index-2.html" title="Board index"><span class="site_logo"></span></a>
				<div  class="site-description">
					<h1>ABINIT Discussion Forums</h1>
					<p>The meeting place for ABINIT users and developers</p>
					<p class="skiplink"><a href="#start_here">Skip to content</a></p>
				</div>
			</div>

			</div>
					</div>
				<div class="navbar navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
										
										<li class="separator"></li>

									</ul>
			</div>
		</li>

			<li class="small-icon icon-smartfeed no-bulletin"><a href="app.php/smartfeed/ui.html">Smartfeed</a></li>		<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Main Site</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/packages" title="" role="menuitem" target="_blank">
				<i class="icon fa-download fa-fw" aria-hidden="true"></i><span>Download</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-book fa-fw" aria-hidden="true"></i><span>Documentations</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/tutorial/" title="" role="menuitem" target="_blank">
				<i class="icon fa-graduation-cap fa-fw" aria-hidden="true"></i><span>Tutorials</span>
				</a>
			</li>
							
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
						</ul>
    </div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">
	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
								<li class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
										<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope><a href="index-2.html" itemtype="https://schema.org/Thing" itemprop="item" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>
											<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="4"><a href="viewforum31e6.html?f=4" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Running Abinit</span></a><meta itemprop="position" content="2" /></span>
															<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="9"><a href="viewforumfdc5.html?f=9" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Ground state</span></a><meta itemprop="position" content="3" /></span>
												</li>
		<li class="rightside responsive-hide">
	<div id="show-clock">
		<div id="liveclock" class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
</li><!--[if !IE]><!-->
<li id="g-search-box" class="search-box rightside responsive-hide">
	<form action="https://forum.abinit.org/app.php/googlesearch">
	<fieldset>
		<input name="cx" type="hidden" value="017804512478788106347:tlftx8kncg4">
		<input name="q" type="search" maxlength="255" class="inputbox search tiny" value="" placeholder="Google Search ...">
		<button class="button button-search-google" type="submit" name="sitesearch" title="Google Search">
		<i class="icon fa-search fa-fw" aria-hidden="true"></i>
		</button>
	</fieldset>
</form>
</li>
<!--<![endif]-->

							<li id="search-box" class="rightside search-box responsive-hide" role="search">
				<form action="https://forum.abinit.org/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</li>

			<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
					</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		﻿
<h2 class="topic-title"><a href="viewtopic49d2.html?f=9&amp;t=356">mpi-io output for large files</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Total energy, geometry optimization, DFT+U, spin....<br /></div>
<p>
	<strong>Moderator:</strong> <a href="memberlista146.html?mode=viewprofile&amp;u=2687" class="username">bguster</a>
</p>


<div class="action-bar bar-top">
	
			<a href="posting04be.html?mode=reply&amp;f=9&amp;t=356" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic4615.html?f=9&amp;t=356&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://forum.abinit.org/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="356" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			7 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p1075" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1075">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bef.html?author_id=72&amp;sr=posts">655</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 19, 2009 12:01 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1075">

						<h3 class="first"><a href="#p1075">mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingea18-2.html?mode=quote&amp;f=9&amp;p=1075" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicce64-2.html?p=1075#p1075" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a></strong> &raquo; </span>Wed May 26, 2010 2:08 pm
			</p>
			
			
			
			<div class="content">Hello,<br /><br />I have been running paral_kgb with bands and a bit of fft parallelism for a largeish molecule in a box (limited input file below) on xeon intel 11.1 openmpi 1.3.0 cluster nic3 here in Liege. The speedup is appreciated, even if not linear. I notice that band parallelization does not reduce memory use per core much, whereas fft parallelism does (but it is less efficient, and there is definitely an underestimation in the abinit prediction of memory usage - sometimes by half)<br /><br />I now have a problem in the mpi-io writing of the WFK file for the full case with many bands: I get a segfault inside wffreadwrite_mpio:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&#91;node066:03178&#93; *** Process received signal ***<br />&#91;node066:03178&#93; Signal: Segmentation fault (11)<br />&#91;node066:03178&#93; Signal code: Address not mapped (1)<br />&#91;node066:03178&#93; Failing at address: 0x11891a8c0<br />&#91;node066:03176&#93; *** Process received signal ***<br />&#91;node066:03176&#93; Signal: Segmentation fault (11)<br />&#91;node066:03176&#93; Signal code:&nbsp; (128)<br />&#91;node066:03176&#93; Failing at address: (nil)<br />&#91;node066:03178&#93; &#91; 0&#93; /lib64/libpthread.so.0 &#91;0x3246e0e4c0&#93;<br />&#91;node066:03178&#93; &#91; 1&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/openmpi/mca_io_romio.so(ADIOI_Calc_my_req+0x15d) &#91;0x2b2cf916d09d&#93;<br />&#91;node066:03178&#93; &#91; 2&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/openmpi/mca_io_romio.so(ADIOI_GEN_WriteStridedColl+0x3f2) &#91;0x2b2cf917fda2&#93;<br />&#91;node066:03178&#93; &#91; 3&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/openmpi/mca_io_romio.so(MPIOI_File_write_all+0xc0) &#91;0x2b2cf918a6f0&#93;<br />&#91;node066:03178&#93; &#91; 4&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/openmpi/mca_io_romio.so(mca_io_romio_dist_MPI_File_write_all+0x23) &#91;0x2b2cf918a623&#93;<br />&#91;node066:03178&#93; &#91; 5&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/openmpi/mca_io_romio.so &#91;0x2b2cf916c7f0&#93;<br />&#91;node066:03178&#93; &#91; 6&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/libmpi.so.0(MPI_File_write_all+0x4a) &#91;0x2b2cc9a62e0a&#93;<br />&#91;node066:03178&#93; &#91; 7&#93; /cvos/shared/apps/openmpi/intel/64/1.3.0/lib64/libmpi_f77.so.0(mpi_file_write_all_f+0x8f) &#91;0x2b2cc97e71ff&#93;<br />&#91;node066:03178&#93; &#91; 8&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(wffreadwrite_mpio_+0x16f0) &#91;0x1055380&#93;<br />&#91;node066:03178&#93; &#91; 9&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(writewf_+0x1896) &#91;0x104c3a6&#93;<br />&#91;node066:03178&#93; &#91;10&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(rwwf_+0x8e8) &#91;0x104aaf8&#93;<br />&#91;node066:03178&#93; &#91;11&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(outwf_+0x21cd) &#91;0xc3268d&#93;<br />&#91;node066:03178&#93; &#91;12&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(gstate_+0xc3b0) &#91;0x502250&#93;<br />&#91;node066:03178&#93; &#91;13&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(gstateimg_+0x1409) &#91;0x45bd89&#93;<br />&#91;node066:03178&#93; &#91;14&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(driver_+0x6ddb) &#91;0x451dbb&#93;<br />&#91;node066:03178&#93; &#91;15&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(MAIN__+0x3b07) &#91;0x448057&#93;<br />&#91;node066:03178&#93; &#91;16&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(main+0x3c) &#91;0x44453c&#93;<br />&#91;node066:03178&#93; &#91;17&#93; /lib64/libc.so.6(__libc_start_main+0xf4) &#91;0x324621d974&#93;<br />&#91;node066:03178&#93; &#91;18&#93; /u/mverstra/CODES/ABINIT/6.1.2-private/tmp-ifort/src/98_main/abinit(ctrtri_+0x41) &#91;0x444449&#93;<br /></code></pre></div><br /><br />The density file is written correctly (in mpiio).<br /><br />If I lower ecut or make the box smaller the writing works (and the file can be re-used as input). It looks like it is linked to the file size. <a href="http://lists.mcs.anl.gov/pipermail/mpich-discuss/2007-May/002311.html" class="postlink">http://lists.mcs.anl.gov/pipermail/mpich-discuss/2007-May/002311.html</a> is perhaps related, but for mpich, and I have not found a solution to it.<br /><br />I have tried printing out the size of the buffer arrays in wffreadwrite_mpio:<br /><br />call to MPI_FILE_WRITE_ALL      8947488<br /><br />but they look ok, and the values too. The size of the buffer is not that big (a few hundred Mb), and I did not get an actual complaint about memory allocation, so that is probably not the problem.<br /><br /><br />Does anyone have a suggestion? Has anyone tried openmpi 1.4 with better results? Or would downgrading to 1.2.6 help? I doubt it<br /><br />thanks,<br /><br />Matthieu<br /><br /><br /><blockquote class="uncited"><div>nstep    100          # max iteration scf cicle<br />nband    600           # Number of (occ and empty) bands to be computed<br />paral_kgb 1 <br />npkpt  2<br />npband 10      # Nr of Processors at the BAND level, default 1<br />               # npband has to be a divisor or equal to nband  <br />npfft  3       # Nr of Processors at the FFT level, default nproc<br />               # npfft should be a divisor or equal to the number <br />               # of FFT planes along the 2nd and 3rd dimensions  <br />bandpp 1<br />wfoptalg 4  nloalg 4  fftalg 401  intxc 0  fft_opt_lob 2<br />accesswff 1<br /><br />occopt 3            # 7 = gaussian   4 = cold smearing 3 = FD<br />tsmear 0.01 eV<br /><br />optstress 0<br />optforces 0<br />kptopt 1<br />ngkpt 1 1 1<br />nshiftk 1<br />shiftk 0 0 0<br /><br />ndtset  1<br />tolwfr   1.0d-12<br />nbdbuf   10            # buffer: the last 10 wfns will not converge<br />istwfk    1*1   <br />ixc 1<br />ecut 35<br />nline 6<br />diemac 1<br />diemix 0.7<br />####   Don't use iprcel 45<br /><br />nsppol 2<br />spinat<br />0 0 0.5  <br />0 0 -0.2 <br />...<br />0 0 0<br />0 0 0<br />0 0 0<br />0 0 0.5  <br /><br />acell 17 10 40 Angstr  # 10 angst vacuum<br />rprim 1.0000 0.0000 0.0000<br />      0.0000 1.0000 0.0000<br />      0.0000 0.0000 1.0000<br />natom 59<br />ntypat 2<br />typat ...<br />znucl 6 1<br />xcart<br />...<br /></div></blockquote></div>
			
			
			
									
									<div id="sig1075" class="signature">Matthieu Verstraete<br />University of Liege, Belgium</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1080" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1080">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="avatar"><img class="avatar" src="download/file04d0.png?avatar=55_1376078980.png" width="71" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf977.html?author_id=55&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri Aug 14, 2009 7:40 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1080">

						<h3 ><a href="#p1080">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting2346.html?mode=quote&amp;f=9&amp;p=1080" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicc7c9.html?p=1080#p1080" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a></strong> &raquo; </span>Wed May 26, 2010 7:26 pm
			</p>
			
			
			
			<div class="content">Hi MJ,<br /><br />Yes, you should have a better behaviour with openmpi 1.4.1 !<br />We had a lot of of difficulties with the 1.3 version of openmpi (related to mpi-io)... and they disappear with openmpi 1.4.1.<br />I don't know if it will solve you problem, but try it...<br /><br />The estimation of memory usage within &quot;kgb&quot; parallelization has not been implemented (when you lanch a kgb run , you get the k-point parallelization estimation).<br /><br />Marc</div>
			
			
			
									
									<div id="sig1080" class="signature">Marc Torrent<br /><em class="text-italics">CEA - Bruyères-le-Chatel<br />France<br /></em></div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1109" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1109">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bef.html?author_id=72&amp;sr=posts">655</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 19, 2009 12:01 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1109">

						<h3 ><a href="#p1109">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting9d6d.html?mode=quote&amp;f=9&amp;p=1109" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic6a48.html?p=1109#p1109" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a></strong> &raquo; </span>Tue Jun 01, 2010 1:49 pm
			</p>
			
			
			
			<div class="content">Hi again,<br /><br />no, unfortunately openmpi 1.4.2 segfaults in exactly the same way, when writing the wf file...<br /><br />any other suggestions?<br /><br />Matthieu</div>
			
			
			
									
									<div id="sig1109" class="signature">Matthieu Verstraete<br />University of Liege, Belgium</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1113" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1113">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bef.html?author_id=72&amp;sr=posts">655</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 19, 2009 12:01 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1113">

						<h3 ><a href="#p1113">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postinga7c8.html?mode=quote&amp;f=9&amp;p=1113" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic5d7e.html?p=1113#p1113" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a></strong> &raquo; </span>Tue Jun 01, 2010 11:05 pm
			</p>
			
			
			
			<div class="content">Slight progress: ifort with debugging tells me it is trying to access cg_disk while it is not allocated. Unfortunately, the $#^@# compiler is incapable of telling me where and in which routine. Semi useless...<br /><br />Matthieu</div>
			
			
			
									
									<div id="sig1113" class="signature">Matthieu Verstraete<br />University of Liege, Belgium</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1115" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1115">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="avatar"><img class="avatar" src="download/file04d0.png?avatar=55_1376078980.png" width="71" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf977.html?author_id=55&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri Aug 14, 2009 7:40 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1115">

						<h3 ><a href="#p1115">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting53d9.html?mode=quote&amp;f=9&amp;p=1115" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic1efb-2.html?p=1115#p1115" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a></strong> &raquo; </span>Wed Jun 02, 2010 12:00 pm
			</p>
			
			
			
			<div class="content">OK Matthieu,<br /><br />As I'm the one who recently modified (improved), mpi-io access, I feel obliged to help...<br /><br />cg_disk should only be accessed when mkmem=0.<br />Is it the case (I guess no) ?<br /><br />If you &quot;grep&quot; cg_disk in the source files, you find that the only routines concerned with mpi-io are outwf and wfsinp...<br /><br />Marc</div>
			
			
			
									
									<div id="sig1115" class="signature">Marc Torrent<br /><em class="text-italics">CEA - Bruyères-le-Chatel<br />France<br /></em></div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1116" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1116">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="avatar"><img class="avatar" src="download/file04d0.png?avatar=55_1376078980.png" width="71" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="searchf977.html?author_id=55&amp;sr=posts">127</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri Aug 14, 2009 7:40 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1116">

						<h3 ><a href="#p1116">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingaf9d.html?mode=quote&amp;f=9&amp;p=1116" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicd0f6.html?p=1116#p1116" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist913b.html?mode=viewprofile&amp;u=55" class="username">torrent</a></strong> &raquo; </span>Wed Jun 02, 2010 12:36 pm
			</p>
			
			
			
			<div class="content">If I run the automatic MPI-IO tests with -fbounds-check (gcc), everything is correct (no bounds overflow)...<br />??? where is the cg_disk access ?</div>
			
			
			
									
									<div id="sig1116" class="signature">Marc Torrent<br /><em class="text-italics">CEA - Bruyères-le-Chatel<br />France<br /></em></div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p1117" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile1117">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bef.html?author_id=72&amp;sr=posts">655</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 19, 2009 12:01 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content1117">

						<h3 ><a href="#p1117">Re: mpi-io output for large files</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting7565.html?mode=quote&amp;f=9&amp;p=1117" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic9e99.html?p=1117#p1117" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a></strong> &raquo; </span>Thu Jun 03, 2010 12:10 am
			</p>
			
			
			
			<div class="content">my mistake - the complaint came from adding -C for the compilation - ifort complains because we pass unallocated arrays. We had seen this before. I'm now trying what you mentioned with gfortran fcheck-bounds - ifort with bounds checking is unusable for abinit unfortunately <img class="smilies" src="images/smilies/icon_e_sad.gif" alt=":(" title="Sad" /><br /><br />Matthieu</div>
			
			
			
									
									<div id="sig1117" class="signature">Matthieu Verstraete<br />University of Liege, Belgium</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="posting04be.html?mode=reply&amp;f=9&amp;t=356" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic4615.html?f=9&amp;t=356&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://forum.abinit.org/viewtopic.php?f=9&amp;t=356">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			7 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforumfdc5.html?f=9" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Ground state”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforumffeb.html?f=20" class="jumpbox-forum-link"> <span> News &amp; Announcements</span></a></li>
																<li><a href="viewforum8011.html?f=23" class="jumpbox-forum-link"> <span> Jobs and Other Announcements</span></a></li>
																<li><a href="viewforum58da.html?f=1" class="jumpbox-cat-link"> <span> Building ABINIT</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Configuring and compiling ABINIT</span></a></li>
																<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> Running Abinit</span></a></li>
																<li><a href="viewforumfdc5.html?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Ground state</span></a></li>
																<li><a href="viewforum15ca.html?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Response calculations</span></a></li>
																<li><a href="viewforum8a83.html?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Many-body perturbation theory</span></a></li>
																<li><a href="viewforum01c9.html?f=12" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Other tools and postprocessing in ABINIT</span></a></li>
																<li><a href="viewforum345c.html?f=24" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Python interfacing : Abipy ecosystem</span></a></li>
																<li><a href="viewforum9780.html?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Link to other codes</span></a></li>
																<li><a href="viewforume774.html?f=5" class="jumpbox-cat-link"> <span> Developing Abinit</span></a></li>
																<li><a href="viewforum218b.html?f=19" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Improving ABINIT</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar navbar-bottom" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
				
		<li class="rightside" data-last-responsive="true"><a href="app.php/aboutus.html" role="menuitem"><i class="icon fa-info-circle fa-fw" aria-hidden="true"></i><span>About us</span></a></li>			</ul>

	</div>
</div>

	<div class="copyright">
		<script type="text/javascript">
copyright=new Date();

update=copyright.getFullYear();

document.write("Copyright\u0020\u0026copy\u003B 2009 - "+ update +	" ABINIT Discussion Forums All\u0020rights\u0020reserved.");

</script>
<br /><br />		<p class="footer-row">
			<span class="footer-copyright">Flat Style by <a href="http://phpbbstyles.oo.gd/">Ian Bradley</a></span>
		</p>
        <p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row">
			<a class="footer-link" href="ucp4d86.html?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="ucp226b.html?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="assets/javascript/jquery.minaea1.js?assets_version=57"></script>
<script src="assets/javascript/coreaea1.js?assets_version=57"></script>



<script>
	(function() {
		var cx = '017804512478788106347\u003Atlftx8kncg4';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//cse.google.com/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	})();
</script>
<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="ext/hifikabin/clock/styles/all/template/js/js_clockaea1.js?assets_version=57"></script>
<script src="ext/phpbb/collapsiblecategories/styles/all/template/js/collapsiblecategoriesaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/forum_fnaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/ajaxaea1.js?assets_version=57"></script>



</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?p=1109 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 00:19:24 GMT -->
</html>
