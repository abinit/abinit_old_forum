<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=3786&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 19:51:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; Phonon eigendisplacement normalization?</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>Phonon eigendisplacement normalization?</h2>
		<p><a href="viewtopic6d02.html?f=10&amp;t=3786">https://forum.abinit.org/viewtopic.php?f=10&amp;t=3786</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>Phonon eigendisplacement normalization?</h3>
				<div class="date">Posted: <strong>Wed Feb 21, 2018 9:48 pm</strong></div>
				<div class="author">by <strong>aliwho</strong></div>
				<div class="content">Hello,<br /><br />I'm having trouble finding how ABINIT normalizes the phonon eigendisplacements it prints out in doing certain response calculations.<br /><br />My understanding is that for mode m and atom k (dropping indices for direction and wave vector, for simplicity), the phonon eigendisplacement U(m,k) is related to the eigenvector V(m,k) by a factor of 1/Sqrt(M(k)):  <br />U(m,k) = V(m,k)/Sqrt(M(k)).<br />While the eigenvectors are orthonormal, the eigendisplacements are not, unless you include the mass matrix:<br />V(m)*V(n) = delta(m,n)<br />U(m)*M*U(n) = delta(m,n).<br /><br />However, this is not what I'm finding when looking at the output of anaddb. I'm finding that <br />U(m)*M*U(n) = delta(m,n)*0.0005485(3).<br /><br />What is this constant that it seems the displacements are normalized to? I've attached the output of two phonon modes at the gamma point for the system I am looking at from ABINIT, if anyone wants to verify my issue. The first 3 atoms are oxygen, then strontium, and finally, titanium. Their masses (in amu) are 15.999, 87.62, and 47.867, respectively.<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp; Mode number&nbsp; &nbsp; 4&nbsp; &nbsp;Energy&nbsp; &nbsp; 8.338968E-05<br />;&nbsp; 1&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00 -3.19958301E-03<br />;&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />;&nbsp; 2&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00 -3.19958301E-03<br />;&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />;&nbsp; 3&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00 -2.17054046E-03<br />;&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />;&nbsp; 4&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 8.45297852E-04<br />;&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />;&nbsp; 5&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 1.31673168E-03<br />;&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />&nbsp; Mode number&nbsp; &nbsp; 5&nbsp; &nbsp;Energy&nbsp; &nbsp; 5.896087E-04<br />-&nbsp; 1&nbsp; 2.64171714E-03 -1.37062157E-03&nbsp; 0.00000000E+00<br />-&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />-&nbsp; 2&nbsp; 1.37060641E-03 -2.64174635E-03&nbsp; 0.00000000E+00<br />-&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />-&nbsp; 3&nbsp; 1.64708461E-03 -1.64710282E-03&nbsp; 0.00000000E+00<br />-&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />-&nbsp; 4 -1.00824265E-03&nbsp; 1.00825380E-03&nbsp; 0.00000000E+00<br />-&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />-&nbsp; 5 -4.60564758E-05&nbsp; 4.60569850E-05&nbsp; 0.00000000E+00<br />-&nbsp; &nbsp; &nbsp;0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br /></code></pre></div><br /><br />Thanks,<br />-Ali<br /><br />PS: what do the ; next to Mode 4 indicate? They are different from the - next to Mode 5.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Phonon eigendisplacement normalization?&nbsp;&nbsp;<span style="color: #006600">[SOLVED]</span></h3>
				<div class="date">Posted: <strong>Thu Feb 22, 2018 9:08 pm</strong></div>
				<div class="author">by <strong>ebousquet</strong></div>
				<div class="content">Dear Ali,<br />Abinit is using electronic units by default and the electronic mass is 1836.152... times the proton mass such as if you multiply by this factor you get something close to 1.<br /><br /><blockquote class="uncited"><div>    PS: what do the ; next to Mode 4 indicate? They are different from the - next to Mode 5.</div></blockquote><br />I never remarked that, I'll check why the code writes it into two different ways while it should be a generic print do-loop on the modes...</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Phonon eigendisplacement normalization?</h3>
				<div class="date">Posted: <strong>Mon Feb 26, 2018 6:45 pm</strong></div>
				<div class="author">by <strong>aliwho</strong></div>
				<div class="content"><blockquote><div><cite>ebousquet wrote:</cite>Dear Ali,<br />Abinit is using electronic units by default and the electronic mass is 1836.152... times the proton mass such as if you multiply by this factor you get something close to 1.<br /><br /><blockquote class="uncited"><div>    PS: what do the ; next to Mode 4 indicate? They are different from the - next to Mode 5.</div></blockquote><br />I never remarked that, I'll check why the code writes it into two different ways while it should be a generic print do-loop on the modes...</div></blockquote><br />Great, thank you for your reply! That did solve my problems.<br /><br />Should I mark this topic as solved? The question about the ; and - was out of curiosity and not the main issue here. I can leave it open if you would like though, if you intend to post about the ; and -.</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: Phonon eigendisplacement normalization?</h3>
				<div class="date">Posted: <strong>Wed Feb 28, 2018 10:39 am</strong></div>
				<div class="author">by <strong>ebousquet</strong></div>
				<div class="content">Hi Ali,<br />You can mark it as solved since it solves what is in the title of the post.<br />I'll reply later regarding the ; and - as this is not very important at this stage.<br />Thanks and all the best,<br />Eric</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=10&t=3786&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 19:51:47 GMT -->
</html>
