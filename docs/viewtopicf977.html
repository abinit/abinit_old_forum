<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=2961&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 20:26:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex" />

<title>ABINIT Discussion Forums &bull; ZnO calculation</title>

<link href="styles/flat-style/theme/print.css" rel="stylesheet">
<link href="styles/flat-style/theme/bidi.css" rel="stylesheet">
</head>
<body id="phpbb" class="ltr">
<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>

	<div id="page-header">
		<h1>ABINIT Discussion Forums</h1>
		<p>The meeting place for ABINIT users and developers<br /><a href="index.html">https://forum.abinit.org/</a></p>

		<h2>ZnO calculation</h2>
		<p><a href="viewtopic5bbe.html?f=11&amp;t=2961">https://forum.abinit.org/viewtopic.php?f=11&amp;t=2961</a></p>
	</div>

	<div id="page-body" class="page-body">
		<div class="page-number">Page <strong>1</strong> of <strong>1</strong></div>
					<div class="post">
				<h3>ZnO calculation</h3>
				<div class="date">Posted: <strong>Wed Apr 08, 2015 4:39 pm</strong></div>
				<div class="author">by <strong>Lantao</strong></div>
				<div class="content">Hello everyone,<br /><br />I'm running the calculation of ZnO. The gap energy calculated is around 0.66eV which is much lower than the experimental result.<br /><br />So I'm trying to make a correction of the gap by the GW calculations. But I've got a problem.<br /><br />With a plasmon-pole model calculation, I have the following result: <br /><br /> k =    0.000   0.000   0.000<br /> Band     E0 &lt;VxcLDA&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E<br />   20   5.768 -16.078 -13.765   0.524   0.757  -0.320 -13.930   2.148   7.917<br />   21   6.536 -16.306 -12.081  -1.608   0.758  -0.318 -14.321   1.985   8.521<br /><br /> E^0_gap          0.768<br /> E^GW_gap         0.604<br /> DeltaE^GW_gap   -0.163<br /><br />I have two questions about these results:<br /><br />1. From the potential files, I can read that 12 electrons are taken into account for Zn and 6 electrons for O. The direct gap is always computed between the band whose number is equal to the number of electrons in the cell divided by two and the next one. So I think the gap is between the 18th and 19th band ( (12*2+6*2)/2=18). But it seems that the programme found the gap between the 20th and 21st band. I don’t understand this. And I check the eigenvalues of different bands, I got:<br /><br /> k =    0.000   0.000   0.000<br /> Band     E0 &lt;VxcLDA&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E<br />   16   4.172 -14.901 -12.290   1.462   0.693  -0.442 -12.077   2.824   6.996<br />   17   4.172 -14.989 -12.321   1.438   0.693  -0.444 -12.145   2.844   7.016<br />   18   5.465 -14.532 -14.659   2.944   0.714  -0.401 -12.522   2.011   7.476<br />   19   5.465 -14.679 -12.502   0.705   0.712  -0.404 -12.626   2.053   7.519<br />   20   5.768 -16.078 -13.765   0.524   0.757  -0.320 -13.930   2.148   7.917<br />   21   6.536 -16.306 -12.081  -1.608   0.759  -0.318 -14.321   1.985   8.521<br />   22   9.704 -10.396  -5.997  -3.114   0.824  -0.213  -9.337   1.060  10.764<br /><br />2. I work on the GW calculations in order to correct the band gap. But after this calculation, the gap is even lower. I wonder if I made a mistake in the input file. Then I checked my file but I didn’t find anything.<br /><br />Maybe someone can help me by figuring our my mistake?<br /><br />Thanks a lot.<br /><br />Have a good day.<br /><br />Best,<br /><br />Lantao</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnO calculation</h3>
				<div class="date">Posted: <strong>Wed May 06, 2015 8:12 pm</strong></div>
				<div class="author">by <strong>saurinrawal</strong></div>
				<div class="content">Hey can you post your input file.<br /><br />Thanks</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnO calculation</h3>
				<div class="date">Posted: <strong>Wed May 06, 2015 11:14 pm</strong></div>
				<div class="author">by <strong>Lantao</strong></div>
				<div class="content">Finally, someone come to reply me. Thanks.<br /><br />Actually, with more empty bands taken into account, the gap shows between the 18th and 19th band. This is a good news. <br /><br />On the other hand, even I did a careful convergence analysis, I still can not have the good results.<br /><br />I can even have a negative gap which is not at all logic.<br /><br />Help me please. And here's the input file.<br /><br /># ZnO : Calculation of the GW corrections<br /># Dataset 1 : ground state calculation <br /># Dataset 2 : calculation of the KSS file <br /># Dataset 3 : calculation of the screening (epsilon^-1 matrix for W)<br /># Dataset 4 : calculation of the self-Energy matrix elements (GW corrections)<br /><br /># In the first tutorial of GW calculation, we checked the convergence so that we know<br /># for the Self-Energy computation, we need ecutwfn = 5.0 ecutsigx = 6.0 nband = 100<br /># for screening computation, we need ecutwfn = 4.0 ecuteps = 6.0 nband = 100<br /><br /># The program broke after 3 datasets<br />#ndtset 4<br /><br /># restartxf -2    # RESTART from (X,F) history<br />                  # restartxf=-2 :Read the HIST file and select the atomic<br />                  # positions and cell parameters with the lowest energy<br />                  # use restartxf=-1 or -2 to restart a calculation that was not completed<br /><br />#############   Usual self-consistent ground-state calculation   ###############<br /><br />#nshiftk1 1<br />#shiftk1 0.0 0.0 0.5<br />#istwfk1 *0<br />#prtden1 1<br /><br />################################################################################<br /><br />########   Definition of parameters for the calculation of the KSS file ########<br /><br />#iscf2 -2<br />#getden2 -1<br />#nbandkss2 -1 # This lead to the generation (full diagonalization of the KS <br />             # hamiltonian) and storage of the maximum possible number of states<br />             # (or bands) common to all points.<br />#kssform2 1   # The value 1 corresponds to ask a KSS through a diagonalization <br />             # of the KS hamiltonian.<br />#nband2 150<br />#nbdbuf2 120<br /><br />################################################################################<br /><br />##############   Calculation of the screening (epsilon^-1 matrix)   ############<br /><br />#optdriver3 3    # Screening calculation<br />#getkss3 -1      # Obtain KSS file from previous dataset<br />#nband3 150<br />#ecutwfn3 30.0    # Cut-off energy of the planewave set to represent <br />                # the wavefunctions. It would be more convenient to keep <br />                # the default ecut value.<br />#ecuteps3 40.0    # Cut-off energy of the planewave set to represent <br />                # the dielectric matrix.<br />#ppmfrq3 16.7 eV # Imaginary frequency where to calculate the screening<br />#nbdbuf3 120<br /><br />################################################################################<br /><br />#####   Calculation of the Self-Energy matrix elements (GW corrections)   ######<br /><br />optdriver 4   # Self-Energy calculation<br />getkss -1     # Obtain KSS file from dataset 1<br />getscr -1     # Obtain SCR file from previous dataset<br />nband 150     # Bands to be used in the Self-Energy calculation<br />nbdbuf 120<br />ppmfrq 16.7 eVecutwfn 30.0  # Planwaves to be used to present the wavefunctions. <br />               # It would be more convenient to keep the default ecut value.ecutsigx 40.0 # Dimension of the G sum in Sigma-x. <br />               # It would be better to keep the default ecut value.<br />nkptgw 1      # number of k-point where to calculate the GW correction<br />kptgw         # k-point<br />   0.000 0.000 0.000<br />bdgw 18 19    # calculate GW corrections for bands from 4 to 5<br /><br />################################################################################<br /><br /># Data common to the three different datasets<br />#####################   Definition of the atom types   #####################<br /><br />ntypat 2          # There are two types of atoms<br />znucl 30 8        # The keyword &quot;znucl&quot; refers to the atomic number of the<br />                  # possible type(s) of atom. The pseudopotential(s) <br />                  # mentioned in the &quot;files&quot; file must correspond<br />                  # to the type(s) of atom.<br />natom 4           # There are 4 atoms per cell<br />typat 1 2         # 1 Zn atoms (first type), 1 O atom (second type)<br />spgroup 186<br />spgaxor 1<br />spgorig 1<br />brvltt -1         # assign brvltt from the space group information<br />natrd 2           # number of atom read<br />xred              # Definition of the primitive cell<br />  1./3   2./3  1.0951595455E-04    # Position of Zn<br />  1./3   2./3  3.7989048405E-01    # O<br /><br />acell 6.2633392923E+00  6.2633392923E+00  1.0083776580E+01 Bohr   #and scale of Cartisien Coordinate<br />                                       #In unit of angstrom  1Bohr=0.5291772108 Anstrong<br />rprim<br />1.0000000000E+00  4.2710751043E-37 -7.9295776162E-37<br />-5.0000000000E-01  8.6602540378E-01  0.0000000000E+00<br />6.1232339957E-17  1.0605752387E-16  1.0000000000E+00<br /><br /><br />############################################################################<br /><br />#####################   Definition of the k-point grid   ###################<br /><br /> ngkpt 5 5 3<br /> nshiftk 1<br /> shiftk<br />       0.0 0.0 0.0<br />#       0.0 0.0 0.5<br /><br />#kptrlatt<br />#    17   0   0<br />#     0  17   0<br />#     0   0  11<br />#shiftk 0.0 0.0 0.0 # When the primitive vectors of the lattice do NOT form a FCC<br />                    # or a BCC lattice, we usually use nshiftk = 1 and <br />                    # shiftk 0.5 0.5 0.5.<br />istwfk *1           # This is mandatory in all the GW steps<br />symmorphi 1<br />############################################################################<br /><br />################   Exchange-correlation functional  ##############<br /><br />ixc 11            # GGA, Perdew-Burke-Ernzerhof GGA function<br /># pawecutdg 80    # PAW-Energy Cutoff for the double grid<br />timopt 2<br /><br />##################################################################<br /><br />###############  Definition of the SCF procedure  ################<br /><br />nstep 100          # Maximal number of SCF cycles<br />iscf 17<br />ecut 60.0           # Maximal kinetic energy cut-off, in Hartree<br />tolwfr 1.0d-10<br /><br />##################################################################<br /><br />And here's the result in my output file:<br />=== KS Band Gaps ===<br />  &gt;&gt;&gt;&gt; For spin  1<br />   Minimum optical gap =   0.6651 [eV], located at k-point      :   0.0000  0.0000  0.0000<br />   Fundamental gap     =   0.6651 [eV], Top of valence bands at :   0.0000  0.0000  0.0000<br />                                        Bottom of conduction at :   0.0000  0.0000  0.0000<br /> SIGMA fundamental parameters:<br /> PLASMON POLE MODEL  1<br /> number of plane-waves for SigmaX                 4127<br /> number of plane-waves for SigmaC and W           4127<br /> number of plane-waves for wavefunctions          2719<br /> number of bands                                   150<br /> number of independent spin polarizations            1<br /> number of spinorial components                      1<br /> number of k-points in IBZ                          10<br /> number of q-points in IBZ                          10<br /> number of symmetry operations                      12<br /> number of k-points in BZ                           75<br /> number of q-points in BZ                           75<br /> number of frequencies for dSigma/dE                 9<br /> frequency step for dSigma/dE [eV]                0.25<br /> number of omega for Sigma on real axis              0<br /> max omega for Sigma on real axis  [eV]           0.00<br /> zcut for avoiding poles [eV]                     0.10<br /><br /> EPSILON^-1 parameters (SCR file):<br /> dimension of the eps^-1 matrix on file           4127<br /> dimension of the eps^-1 matrix used              4127<br /> number of plane-waves for wavefunctions          2719<br /> number of bands                                   150<br /> number of q-points in IBZ                          10<br /> number of frequencies                               2<br /> number of real frequencies                          1<br /> number of imag frequencies                          1<br /><br /> matrix elements of self-energy operator (all in [eV])<br /><br /> Perturbative Calculation<br /><br /> k =    0.000   0.000   0.000<br /> Band     E0 &lt;VxcLDA&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E<br />   18  -2.174 -22.729 -26.479   4.905   0.741  -0.349 -21.873   0.856  -1.318<br />   19  -1.509 -12.023  -8.581  -3.198   0.798  -0.253 -11.829   0.194  -1.315<br /><br /> E^0_gap          0.665<br /> E^GW_gap         0.003<br /> DeltaE^GW_gap   -0.662</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnO calculation</h3>
				<div class="date">Posted: <strong>Wed May 06, 2015 11:16 pm</strong></div>
				<div class="author">by <strong>Lantao</strong></div>
				<div class="content">Finally, someone come to reply me. Thanks.<br /><br />Actually, with more empty bands taken into account, the gap shows between the 18th and 19th band. This is a good news. <br /><br />On the other hand, even I did a careful convergence analysis, I still can not have the good results.<br /><br />I can even have a negative gap which is not at all logic.<br /><br />Help me please. And here's the input file.<br /><br /># ZnO : Calculation of the GW corrections<br /># Dataset 1 : ground state calculation <br /># Dataset 2 : calculation of the KSS file <br /># Dataset 3 : calculation of the screening (epsilon^-1 matrix for W)<br /># Dataset 4 : calculation of the self-Energy matrix elements (GW corrections)<br /><br /># In the first tutorial of GW calculation, we checked the convergence so that we know<br /># for the Self-Energy computation, we need ecutwfn = 5.0 ecutsigx = 6.0 nband = 100<br /># for screening computation, we need ecutwfn = 4.0 ecuteps = 6.0 nband = 100<br /><br />ndtset 4<br /><br /># restartxf -2    # RESTART from (X,F) history<br />                  # restartxf=-2 :Read the HIST file and select the atomic<br />                  # positions and cell parameters with the lowest energy<br />                  # use restartxf=-1 or -2 to restart a calculation that was not completed<br /><br />#############   Usual self-consistent ground-state calculation   ###############<br /><br />nshiftk1 1<br />shiftk1 0.0 0.0 0.5<br />istwfk1 *0<br />prtden1 1<br /><br />################################################################################<br /><br />########   Definition of parameters for the calculation of the KSS file ########<br /><br />iscf2 -2<br />getden2 -1<br />nbandkss2 -1 # This lead to the generation (full diagonalization of the KS <br />             # hamiltonian) and storage of the maximum possible number of states<br />             # (or bands) common to all points.<br />kssform2 1   # The value 1 corresponds to ask a KSS through a diagonalization <br />             # of the KS hamiltonian.<br />nband2 150<br />nbdbuf2 120<br /><br />################################################################################<br /><br />##############   Calculation of the screening (epsilon^-1 matrix)   ############<br /><br />optdriver3 3    # Screening calculation<br />getkss3 -1      # Obtain KSS file from previous dataset<br />nband3 150<br />ecutwfn3 30.0    # Cut-off energy of the planewave set to represent <br />                # the wavefunctions. It would be more convenient to keep <br />                # the default ecut value.<br />ecuteps3 40.0    # Cut-off energy of the planewave set to represent <br />                # the dielectric matrix.<br />ppmfrq3 16.7 eV # Imaginary frequency where to calculate the screening<br />nbdbuf3 120<br /><br />################################################################################<br /><br />#####   Calculation of the Self-Energy matrix elements (GW corrections)   ######<br /><br />optdriver4 4   # Self-Energy calculation<br />getkss4 -1     # Obtain KSS file from dataset 1<br />getscr4 -1     # Obtain SCR file from previous dataset<br />nband4 150     # Bands to be used in the Self-Energy calculation<br />nbdbuf4 120<br />ppmfrq4 16.7 eVecutwfn 30.0  # Planwaves to be used to present the wavefunctions. <br />               # It would be more convenient to keep the default ecut value.ecutsigx 40.0 # Dimension of the G sum in Sigma-x. <br />               # It would be better to keep the default ecut value.<br />nkptgw4 1      # number of k-point where to calculate the GW correction<br />kptgw4         # k-point<br />   0.000 0.000 0.000<br />bdgw4 18 19    # calculate GW corrections for bands from 4 to 5<br /><br />################################################################################<br /><br /># Data common to the three different datasets<br />#####################   Definition of the atom types   #####################<br /><br />ntypat 2          # There are two types of atoms<br />znucl 30 8        # The keyword &quot;znucl&quot; refers to the atomic number of the<br />                  # possible type(s) of atom. The pseudopotential(s) <br />                  # mentioned in the &quot;files&quot; file must correspond<br />                  # to the type(s) of atom.<br />natom 4           # There are 4 atoms per cell<br />typat 1 2         # 1 Zn atoms (first type), 1 O atom (second type)<br />spgroup 186<br />spgaxor 1<br />spgorig 1<br />brvltt -1         # assign brvltt from the space group information<br />natrd 2           # number of atom read<br />xred              # Definition of the primitive cell<br />  1./3   2./3  1.0951595455E-04    # Position of Zn<br />  1./3   2./3  3.7989048405E-01    # O<br /><br />acell 6.2633392923E+00  6.2633392923E+00  1.0083776580E+01 Bohr   #and scale of Cartisien Coordinate<br />                                       #In unit of angstrom  1Bohr=0.5291772108 Anstrong<br />rprim<br />1.0000000000E+00  4.2710751043E-37 -7.9295776162E-37<br />-5.0000000000E-01  8.6602540378E-01  0.0000000000E+00<br />6.1232339957E-17  1.0605752387E-16  1.0000000000E+00<br /><br /><br />############################################################################<br /><br />#####################   Definition of the k-point grid   ###################<br /><br /> ngkpt 5 5 3<br /> nshiftk 1<br /> shiftk<br />       0.0 0.0 0.0<br />#       0.0 0.0 0.5<br /><br />#kptrlatt<br />#    17   0   0<br />#     0  17   0<br />#     0   0  11<br />#shiftk 0.0 0.0 0.0 # When the primitive vectors of the lattice do NOT form a FCC<br />                    # or a BCC lattice, we usually use nshiftk = 1 and <br />                    # shiftk 0.5 0.5 0.5.<br />istwfk *1           # This is mandatory in all the GW steps<br />symmorphi 1<br />############################################################################<br /><br />################   Exchange-correlation functional  ##############<br /><br />ixc 11            # GGA, Perdew-Burke-Ernzerhof GGA function<br /># pawecutdg 80    # PAW-Energy Cutoff for the double grid<br />timopt 2<br /><br />##################################################################<br /><br />###############  Definition of the SCF procedure  ################<br /><br />nstep 100          # Maximal number of SCF cycles<br />iscf 17<br />ecut 60.0           # Maximal kinetic energy cut-off, in Hartree<br />tolwfr 1.0d-10<br /><br />##################################################################<br /><br />And here's the result in my output file:<br />=== KS Band Gaps ===<br />  &gt;&gt;&gt;&gt; For spin  1<br />   Minimum optical gap =   0.6651 [eV], located at k-point      :   0.0000  0.0000  0.0000<br />   Fundamental gap     =   0.6651 [eV], Top of valence bands at :   0.0000  0.0000  0.0000<br />                                        Bottom of conduction at :   0.0000  0.0000  0.0000<br /> SIGMA fundamental parameters:<br /> PLASMON POLE MODEL  1<br /> number of plane-waves for SigmaX                 4127<br /> number of plane-waves for SigmaC and W           4127<br /> number of plane-waves for wavefunctions          2719<br /> number of bands                                   150<br /> number of independent spin polarizations            1<br /> number of spinorial components                      1<br /> number of k-points in IBZ                          10<br /> number of q-points in IBZ                          10<br /> number of symmetry operations                      12<br /> number of k-points in BZ                           75<br /> number of q-points in BZ                           75<br /> number of frequencies for dSigma/dE                 9<br /> frequency step for dSigma/dE [eV]                0.25<br /> number of omega for Sigma on real axis              0<br /> max omega for Sigma on real axis  [eV]           0.00<br /> zcut for avoiding poles [eV]                     0.10<br /><br /> EPSILON^-1 parameters (SCR file):<br /> dimension of the eps^-1 matrix on file           4127<br /> dimension of the eps^-1 matrix used              4127<br /> number of plane-waves for wavefunctions          2719<br /> number of bands                                   150<br /> number of q-points in IBZ                          10<br /> number of frequencies                               2<br /> number of real frequencies                          1<br /> number of imag frequencies                          1<br /><br /> matrix elements of self-energy operator (all in [eV])<br /><br /> Perturbative Calculation<br /><br /> k =    0.000   0.000   0.000<br /> Band     E0 &lt;VxcLDA&gt;   SigX SigC(E0)      Z dSigC/dE  Sig(E)    E-E0       E<br />   18  -2.174 -22.729 -26.479   4.905   0.741  -0.349 -21.873   0.856  -1.318<br />   19  -1.509 -12.023  -8.581  -3.198   0.798  -0.253 -11.829   0.194  -1.315<br /><br /> E^0_gap          0.665<br /> E^GW_gap         0.003<br /> DeltaE^GW_gap   -0.662</div>
			</div>
			<hr />
					<div class="post">
				<h3>Re: ZnO calculation</h3>
				<div class="date">Posted: <strong>Sun Feb 04, 2018 8:31 pm</strong></div>
				<div class="author">by <strong>hisandeep88</strong></div>
				<div class="content">Hello Lantao<br /><br />I would suggest you to use wurtzite structure(basis) in place of FCC or BCC as you have used in the simulation<br /><br />Regards<br />Sandeep</div>
			</div>
			<hr />
			</div>

	<div id="page-footer" class="page-footer">
		<div class="page-number">All times are <span title="Europe/Brussels">UTC+02:00</span><br />Page <strong>1</strong> of <strong>1</strong></div>
			<div class="copyright">
				<p>Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited
				</p>
							</div>
	</div>
</div>

</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?f=11&t=2961&view=print by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 20 Sep 2024 20:26:27 GMT -->
</html>
