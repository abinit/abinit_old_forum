<!DOCTYPE html>
<html dir="ltr" lang="en-gb">

<!-- Mirrored from forum.abinit.org/viewtopic.php?p=4582 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:05:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Consistency check: finite diff. vs DFPT on el-ph matrix el. - ABINIT Discussion Forums</title>


	<link rel="canonical" href="viewtopic21d0.html?t=1443">

<!--
	phpBB style name: Flat Style
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:      Ian Bradley
-->

<link href="assets/css/font-awesome.minaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/stylesheetaea1.css?assets_version=57" rel="stylesheet">
<link href="styles/flat-style/theme/en/stylesheetaea1.css?assets_version=57" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/flat-style/theme/tweaks.css?assets_version=57" rel="stylesheet">
<![endif]-->

<meta name="google-site-verification" content="PLdTN48UENWHvJ5ViWhDTahZKzoMyw5e1QZgw1IECVw" />
<link rel="alternate" type="application/atom+xml" title="ATOM" href="app.php/smartfeed/feed.html" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="app.php/smartfeed/feed9830.html?y=2" />

<link href="ext/crizzo/aboutus/styles/prosilver/theme/aboutusaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/dmzx/topicageday/styles/prosilver/theme/topicagedayaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/clock/styles/all/theme/clockaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/hifikabin/googlesearch/styles/prosilver/theme/googlesearchaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/kinerity/bestanswer/styles/prosilver/theme/bestansweraea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbb/collapsiblecategories/styles/all/theme/collapsiblecategoriesaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/phpbbservices/smartfeed/styles/prosilver/theme/customaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/senky/userstatistics/styles/prosilver/theme/userstatisticsaea1.css?assets_version=57" rel="stylesheet" media="screen" />
<link href="ext/tierra/topicsolved/styles/prosilver/theme/buttonsaea1.css?assets_version=57" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description">
				<a id="logo" class="logo" href="index-2.html" title="Board index"><span class="site_logo"></span></a>
				<div  class="site-description">
					<h1>ABINIT Discussion Forums</h1>
					<p>The meeting place for ABINIT users and developers</p>
					<p class="skiplink"><a href="#start_here">Skip to content</a></p>
				</div>
			</div>

			</div>
					</div>
				<div class="navbar navbar-top" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
																									<li>
								<a href="search33a7.html?search_id=unanswered" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="search526f.html?search_id=active_topics" role="menuitem">
									<i class="icon fa-file fa-fw" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="search.html" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
										
										<li class="separator"></li>

									</ul>
			</div>
		</li>

			<li class="small-icon icon-smartfeed no-bulletin"><a href="app.php/smartfeed/ui.html">Smartfeed</a></li>		<li data-skip-responsive="true">
			<a href="app.php/help/faq.html" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Main Site</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://www.abinit.org/packages" title="" role="menuitem" target="_blank">
				<i class="icon fa-download fa-fw" aria-hidden="true"></i><span>Download</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/" title="" role="menuitem" target="_blank">
				<i class="icon fa-book fa-fw" aria-hidden="true"></i><span>Documentations</span>
				</a>
			</li>
								<li data-last-responsive="true">
				<a href="https://docs.abinit.org/tutorial/" title="" role="menuitem" target="_blank">
				<i class="icon fa-graduation-cap fa-fw" aria-hidden="true"></i><span>Tutorials</span>
				</a>
			</li>
							
			<li class="rightside"  data-skip-responsive="true">
			<a href="ucp26c3.html?mode=login" title="Login" accesskey="x" role="menuitem">
				<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Login</span>
			</a>
		</li>
						</ul>
    </div>
</div>

<div class="navbar" role="navigation">
	<div class="inner">
	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
								<li class="breadcrumbs" itemscope itemtype="http://schema.org/BreadcrumbList">
										<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope><a href="index-2.html" itemtype="https://schema.org/Thing" itemprop="item" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>
											<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="4"><a href="viewforum31e6.html?f=4" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Running Abinit</span></a><meta itemprop="position" content="2" /></span>
															<span class="crumb"  itemtype="http://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="10"><a href="viewforum15ca.html?f=10" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">Response calculations</span></a><meta itemprop="position" content="3" /></span>
												</li>
		<li class="rightside responsive-hide">
	<div id="show-clock">
		<div id="liveclock" class="outer_face">
			<div class="marker oneseven"></div>
			<div class="marker twoeight"></div>
			<div class="marker fourten"></div>
			<div class="marker fiveeleven"></div>
			<div class="inner_face">
				<div class="hand hour"></div>
				<div class="hand minute"></div>
				<div class="hand second"></div>
			</div>
		</div>
	</div>
</li><!--[if !IE]><!-->
<li id="g-search-box" class="search-box rightside responsive-hide">
	<form action="https://forum.abinit.org/app.php/googlesearch">
	<fieldset>
		<input name="cx" type="hidden" value="017804512478788106347:tlftx8kncg4">
		<input name="q" type="search" maxlength="255" class="inputbox search tiny" value="" placeholder="Google Search ...">
		<button class="button button-search-google" type="submit" name="sitesearch" title="Google Search">
		<i class="icon fa-search fa-fw" aria-hidden="true"></i>
		</button>
	</fieldset>
</form>
</li>
<!--<![endif]-->

							<li id="search-box" class="rightside search-box responsive-hide" role="search">
				<form action="https://forum.abinit.org/search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="search" maxlength="128" title="Search for keywords" class="inputbox search tiny" size="20" value="" placeholder="Search…" />
					<button class="button button-search" type="submit" title="Search">
						<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
					</button>
					<a href="search.html" class="button button-search-end" title="Advanced search">
						<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
					</a>
					
				</fieldset>
				</form>
			</li>

			<li class="rightside responsive-search">
				<a href="search.html" title="View the advanced search options" role="menuitem">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</a>
			</li>
					</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
		﻿
<h2 class="topic-title"><a href="viewtopicb065.html?f=10&amp;t=1443">Consistency check: finite diff. vs DFPT on el-ph matrix el.</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Phonons, DFPT, electron-phonon, electric-field response, mechanical response…<br /></div>
<p>
	<strong>Moderators:</strong> <a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>, <a href="memberlistce31.html?mode=viewprofile&amp;u=2727" class="username">joaocarloscabreu</a>
</p>


<div class="action-bar bar-top">
	
			<a href="postingf3f8.html?mode=reply&amp;f=10&amp;t=1443" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1d67-3.html?f=10&amp;t=1443&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="https://forum.abinit.org/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="search.html" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1443" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			4 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p4452" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4452">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="avatar"><img class="avatar" src="download/file9095.jpg?avatar=677_1376048665.jpg" width="83" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1632.html?author_id=677&amp;sr=posts">60</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 16, 2011 9:44 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4452">

						<h3 class="first"><a href="#p4452">Consistency check: finite diff. vs DFPT on el-ph matrix el.</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd73b.html?mode=quote&amp;f=10&amp;p=4452" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic5517.html?p=4452#p4452" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a></strong> &raquo; </span>Wed Nov 23, 2011 2:15 pm
			</p>
			
			
			
			<div class="content"><strong class="text-strong">Consistency check: finite diff. vs DFPT on el-ph matrix elements along phonon modes: the <em class="text-italics">ep_prt_yambo</em> input variable</strong><br /><br />Dear all, <br /><br />I tried to compare a specific matrix element computed in the rf part of abinit with a finite difference approach.<br /><br />First I choose to look at the contribution of the L q-point on the gamma k point of Diamond. And specifically at the contribution of the LO mode on the first electronic band at gamma. I choose this because of it is a non degenerate mode  and a non degenerate band. The corresponding matrix element is:<br /><br />&lt;n'k+q | dV/dR | nk&gt; = &lt;1L| H(1) | 1G&gt;<br /><br /><strong class="text-strong"><span style="color: #FF0000">1) RF using abinit </span></strong><br /><br />File for generating DDB and GKK<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ndtset 10<br />#<br /># DATASET 1 : make ground state wavefunctions and density<br /># <br /><br />tolwfr1 1.0d-18<br />nline1 8&nbsp; &nbsp; &nbsp;# This is to expedite the convergence of higher-lying bands<br />rfphon1&nbsp; 0&nbsp; # for DS1 do _not_ do perturbation<br />nqpt1 0&nbsp; &nbsp; &nbsp; # for DS1 do _not_ do perturbation<br />prtwf1 1&nbsp; &nbsp; &nbsp;# need GS wavefunctions for further runs<br />getwfk1&nbsp; 0<br /><br /># enforce calculation of forces at each SCF step<br />optforces 1<br /><br />qpt2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.00000000E+00&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />qpt3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.50000000E-01&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />qpt4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.00000000E-01&nbsp; 0.00000000E+00&nbsp; 0.00000000E+00<br />qpt5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.50000000E-01&nbsp; 2.50000000E-01&nbsp; 0.00000000E+00<br />qpt6&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.00000000E-01&nbsp; 2.50000000E-01&nbsp; 0.00000000E+00<br />qpt7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -2.50000000E-01&nbsp; 2.50000000E-01&nbsp; 0.00000000E+00<br />qpt8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;5.00000000E-01&nbsp; 5.00000000E-01&nbsp; 0.00000000E+00<br />qpt9&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -2.50000000E-01&nbsp; 5.00000000E-01&nbsp; 2.50000000E-01<br /><br />#&nbsp; DS5 get DDK perturbation (stored in GKK matrix element files)<br />tolwfr10 1.0d-18<br />qpt10 0 0 0<br />rfphon10 0<br />rfelfd10 2<br />prtwf10 0<br /><br /># General data for all phonon calculations:<br />rfatpol&nbsp; 1 2&nbsp; &nbsp; &nbsp; # Treat displacement of the two atoms.<br />rfdir&nbsp; 1 1 1&nbsp; &nbsp; &nbsp; # Do all direction<br />rfphon&nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Do phonon response<br />prtwf&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# for response function runs, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# do not keep first order wavefunctions<br />tolvrs&nbsp; &nbsp;1.0e-12<br />getwfk&nbsp; 1<br />nqpt 1<br />prepgkk 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# force all perturbations to be calculated for q-points considered<br />prtgkk 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # print out GKK files containing electron-phonon coupling<br /><br />#&nbsp; Common data for GS and perturbation runs<br />ngkpt 4 4 4<br />kptopt 3 <br /><br />#&nbsp; use a centered grid for the kpoints: obligatory for el-ph for the moment<br />nshiftk 1<br />shiftk 0.0 0.0 0.0<br /><br />ecut 20<br />acell 3*6.6709983131<br />rprim <br />&nbsp;0.0 0.5 0.5<br />&nbsp;0.5 0.0 0.5<br />&nbsp;0.5 0.5 0.0<br /><br />nband 10<br /><br /># Cell dependent parameters<br />occopt 1<br />natom 2<br />typat 1 1<br />xred 0.00 0.00 0.00<br />&nbsp; &nbsp; &nbsp;0.25 0.25 0.25<br />nstep 300<br />ntypat 1 <br />znucl 6<br />diemac 6<br />enunit 2</code></pre></div><br /><br />The merge input files:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>telphon_2.ddb.out<br />Total ddb for CaS FCC system<br />8<br />telphon_1o_DS2_DDB<br />telphon_1o_DS3_DDB<br />telphon_1o_DS4_DDB<br />telphon_1o_DS5_DDB<br />telphon_1o_DS6_DDB<br />telphon_1o_DS7_DDB<br />telphon_1o_DS8_DDB<br />telphon_1o_DS9_DDB</code></pre></div><br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>telphon_3o_GKK.bin&nbsp; &nbsp;# Name of output file<br />0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # binary (0) or ascii (1) output<br />telphon_1o_DS1_WFK&nbsp; &nbsp;# GS wavefunction file<br />0&nbsp; 48 48&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # number of 1WF files, of GKK files, and of perturbations in the GKK files<br />telphon_1o_DS2_GKK1&nbsp; # names of the 1WF then the (eventual) GKK files<br />telphon_1o_DS2_GKK2<br />telphon_1o_DS2_GKK3<br />telphon_1o_DS2_GKK4<br />telphon_1o_DS2_GKK5<br />telphon_1o_DS2_GKK6<br />telphon_1o_DS3_GKK1<br />telphon_1o_DS3_GKK2<br />telphon_1o_DS3_GKK3<br />telphon_1o_DS3_GKK4<br />telphon_1o_DS3_GKK5<br />telphon_1o_DS3_GKK6<br />telphon_1o_DS4_GKK1<br />telphon_1o_DS4_GKK2<br />telphon_1o_DS4_GKK3<br />telphon_1o_DS4_GKK4<br />telphon_1o_DS4_GKK5<br />telphon_1o_DS4_GKK6<br />telphon_1o_DS5_GKK1<br />telphon_1o_DS5_GKK2<br />telphon_1o_DS5_GKK3<br />telphon_1o_DS5_GKK4<br />telphon_1o_DS5_GKK5<br />telphon_1o_DS5_GKK6<br />telphon_1o_DS6_GKK1<br />telphon_1o_DS6_GKK2<br />telphon_1o_DS6_GKK3<br />telphon_1o_DS6_GKK4<br />telphon_1o_DS6_GKK5<br />telphon_1o_DS6_GKK6<br />telphon_1o_DS7_GKK1<br />telphon_1o_DS7_GKK2<br />telphon_1o_DS7_GKK3<br />telphon_1o_DS7_GKK4<br />telphon_1o_DS7_GKK5<br />telphon_1o_DS7_GKK6<br />telphon_1o_DS8_GKK1<br />telphon_1o_DS8_GKK2<br />telphon_1o_DS8_GKK3<br />telphon_1o_DS8_GKK4<br />telphon_1o_DS8_GKK5<br />telphon_1o_DS8_GKK6<br />telphon_1o_DS9_GKK1<br />telphon_1o_DS9_GKK2<br />telphon_1o_DS9_GKK3<br />telphon_1o_DS9_GKK4<br />telphon_1o_DS9_GKK5<br />telphon_1o_DS9_GKK6</code></pre></div><br /><br />The anaddb file:<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># turn on calculation of the electron-phonon quantities<br />elphflag 1<br /><br />nqpath 1<br />qpath<br />&nbsp;0.0 0.0 0.0<br /><br />ep_prt_yambo 1<br /><br />#&nbsp; impose acoustic sum rule in a symmetric way<br />asr 2<br />dipdip 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Dipole-dipole interaction treatment<br /><br />#&nbsp; bravais lattice necessary<br />&nbsp;brav 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Bravais lattic simple cubic<br />&nbsp;ngqpt 4 4 4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Monkhorst Pack indices<br />&nbsp;nqshft 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Number of q-points in repeted basic q-cell<br />&nbsp;q1shft 0.0 0.0 0.0<br /><br />ifcflag 1<br />ifcana 1<br /><br />#&nbsp; print dielectric matrix with freq dependence<br />dieflag 0<br /><br />#&nbsp; print out eigenvectors and symmetrize dyn matrix<br />eivec 1<br /><br />#Wavevector list number 1 (Reduced coordinates and normalization factor)<br />nph1l 0<br /><br /># This line added when defaults were changed (v5.3) to keep the previous, old behaviour<br />&nbsp; symdynmat 0</code></pre></div><br /><br />All this give me a <strong class="text-strong">yambo_elphon_gkk_bymode</strong> file that contain the matrix element I'm interested in:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>reduced coord qpoint no&nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp; 0.5000000000E+00&nbsp; &nbsp; 0.0000000000E+00&nbsp; &nbsp; 0.0000000000E+00<br />&nbsp;matrix elements of all phonon modes for this q-point<br />&nbsp;kpoint&nbsp; &nbsp; &nbsp; 1<br />&nbsp;el bands n,np&nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp;1<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; 0.6148462851E-12&nbsp; &nbsp; 0.1910195268E-12<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; 0.3322124045E-12&nbsp; &nbsp; 0.6254075303E-12<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 3&nbsp; &nbsp;-0.1993910522E-11&nbsp; &nbsp; 0.5519944168E-12<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 4&nbsp; &nbsp; 0.1166239653E-02&nbsp; &nbsp;-0.1471911143E-12<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 5&nbsp; &nbsp; 0.4120494136E-13&nbsp; &nbsp; 0.2338180477E-12<br />&nbsp;mat el for phonon mode num =&nbsp; &nbsp; &nbsp; 6&nbsp; &nbsp;-0.4321510669E-11&nbsp; &nbsp;-0.3949574423E-12</code></pre></div><br /><br />We can see that the LO phonon mode give a matrix element of <strong class="text-strong"> 0.1166239653E-02-0.1471911143E-12j</strong><br /><br /><strong class="text-strong"><span style="color: #FF0000">2) Finite difference using abinit </span></strong><br /><br />For the finite difference calculation I used the exact same psp, ecut, acell, conv. criteria etc.. <br />As I'm considering the L phonon mode I made a 2x1x1 supercell with 4 atoms (2 per primitive cell). The k grid is then 2x4x4.<br /><br />As a first check I computed the phonon frequency by making finite difference on the total energy and obtain very good result:<br />For the LO phonon I have 0.0589 Ha by finite difference (the convergence over a small displacement parameter (lambda or h) is made for finite difference calculations). This result compare well with the DFPT phonon freq. of LO phonon of 0.005890477 Ha.<br /><br />Here is my python script used to determine the displacement that I have to made in order to make the finite difference calculation. This script is based on solving the eigenvalue problem based on the knowledge of the dynamical matrix obtained by DFPT. <br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>import numpy as np<br /><br /># ------------------------------------------------------------------<br /># Find the eigenvector and eigenenergies from the dynamical matrix<br /># computed using DFPT in ABINIT<br /># ------------------------------------------------------------------<br /><br /># Location of the Dynamical matrix file<br />L_file = '/home/Samuel/Documents/WorkDiam/AHC_comparison_with_yambo/0/Dynamical-mat-L.dat'<br /><br /># Carbon mass in a.u.<br />Mc=21894.16693<br /><br />def read_dynamical_matrix(datafile):<br />&nbsp; with open(datafile,'r') as f:<br />&nbsp; &nbsp; raw = list()<br />&nbsp; &nbsp; for line in f:<br />&nbsp; &nbsp; &nbsp; if line&#91;0&#93;=='#': continue<br />&nbsp; &nbsp; &nbsp; parts=line.split()<br />&nbsp; &nbsp; &nbsp; if not parts: continue<br />&nbsp; &nbsp; &nbsp; val=float(parts&#91;4&#93;)<br />&nbsp; &nbsp; &nbsp; if np.abs(val) &lt; 0.000000001:<br />&nbsp; &nbsp; &nbsp; &nbsp; val=0.0<br />&nbsp; &nbsp; &nbsp; raw.append(val)<br />&nbsp; &nbsp; dynmat = np.array(raw)<br />&nbsp; &nbsp; dynmat = dynmat.reshape(6,6)<br />&nbsp; return dynmat<br /><br />dynmatL=read_dynamical_matrix(L_file)<br />&#91;eigvalL,eigvectL&#93;=np.linalg.eig(dynmatL)<br /><br />eigvectL=np.transpose(eigvectL)<br /><br />print &quot;eigenvalues at L :&quot;<br />for n in eigvalL:<br />&nbsp; a = np.sqrt(n/Mc)<br />&nbsp; print a<br /><br />print &quot;eigenvectors at L :&quot;<br />for n in eigvectL: print n<br /><br /># -------------------------------------------------------------------<br /># Create Abinit input file for finite difference on eigen energies and other<br /># -------------------------------------------------------------------<br /><br /># Value and number of the displacement (always 1/2 of the previous)<br />h = np.array(&#91;0.1,0.05,0.025,0.0125,0.00625,0.003125,0.0015625&#93;)<br /><br /># Cell parameters<br />acell = np.array(&#91;13.336533,6.6682665177,6.6682665177&#93;)<br />rprim = np.array(&#91;&#91;0.0,0.5,0.5&#93;,&#91;0.5,0.0,0.5&#93;,&#91;0.5,0.5,0.0&#93;&#93;)<br />cell = np.mat(&#91;rprim&#91;0&#93;*acell&#91;0&#93;,rprim&#91;1&#93;*acell&#91;1&#93;,rprim&#91;2&#93;*acell&#91;2&#93;&#93;)<br />xred = np.mat(&#91;&#91;0.0,0.0,0.0&#93;,&#91;0.125,0.25,0.25&#93;,&#91;0.5,0.0,0.0&#93;,\<br />&#91;0.625,0.25,0.25&#93;&#93;)<br /><br /><br /># In the specific case of the L point, h = -h<br /># Indice that record the number of xcart in the input file<br />j = 1<br /><br /># Equilibrium position<br />print &quot;&nbsp; &quot;<br />print &quot;Contribution of the L point on the electronic eigenenergies at Gamma&quot;<br />print &quot;and the first part of the NDDW.&quot;<br />print &quot;Using finite difference.&quot;<br />print &quot; &quot;<br />print &quot; xcart%.0f&nbsp; &nbsp; %.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%(j,(xred&#91;0&#93;*cell)&#91;0,0&#93;,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;0&#93;*cell)&#91;0,1&#93;,(xred&#91;0&#93;*cell)&#91;0,2&#93;)<br />print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;1&#93;*cell)&#91;0,0&#93;,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;1&#93;*cell)&#91;0,1&#93;,(xred&#91;1&#93;*cell)&#91;0,2&#93;)<br />print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;2&#93;*cell)&#91;0,0&#93;,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;2&#93;*cell)&#91;0,1&#93;,(xred&#91;2&#93;*cell)&#91;0,2&#93;)<br />print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;3&#93;*cell)&#91;0,0&#93;,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;3&#93;*cell)&#91;0,1&#93;,(xred&#91;3&#93;*cell)&#91;0,2&#93;)<br />print &quot;&nbsp; &quot;<br />j += 1<br /><br />for disp in h:<br /># LO mode<br />&nbsp; i = 1<br />&nbsp; print &quot; xcart%.0f&nbsp; &nbsp; %.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%(j,(xred&#91;0&#93;*cell)&#91;0,0&#93;+\<br />&nbsp; &nbsp; &nbsp; &nbsp; eigvectL&#91;i&#93;&#91;0&#93;*disp,(xred&#91;0&#93;*cell)&#91;0,1&#93;+eigvectL&#91;i&#93;&#91;1&#93;*disp,\<br />&nbsp; &nbsp; &nbsp; &nbsp; (xred&#91;0&#93;*cell)&#91;0,2&#93;+eigvectL&#91;i&#93;&#91;2&#93;*disp)<br />&nbsp; print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;1&#93;*cell)&#91;0,0&#93;+\<br />&nbsp; &nbsp; &nbsp; &nbsp; eigvectL&#91;i&#93;&#91;3&#93;*disp,(xred&#91;1&#93;*cell)&#91;0,1&#93;+eigvectL&#91;i&#93;&#91;4&#93;*disp,\<br />&nbsp; &nbsp; &nbsp; &nbsp; (xred&#91;1&#93;*cell)&#91;0,2&#93;+eigvectL&#91;i&#93;&#91;5&#93;*disp)<br />&nbsp; print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;2&#93;*cell)&#91;0,0&#93;-\<br />&nbsp; &nbsp; &nbsp; eigvectL&#91;i&#93;&#91;0&#93;*disp,(xred&#91;2&#93;*cell)&#91;0,1&#93;-eigvectL&#91;i&#93;&#91;1&#93;*disp,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;2&#93;*cell)&#91;0,2&#93;-eigvectL&#91;i&#93;&#91;2&#93;*disp)<br />&nbsp; print &quot;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;%.15f&nbsp; %.15f&nbsp; %.15f&nbsp; &quot;%((xred&#91;3&#93;*cell)&#91;0,0&#93;-\<br />&nbsp; &nbsp; &nbsp; eigvectL&#91;i&#93;&#91;3&#93;*disp,(xred&#91;3&#93;*cell)&#91;0,1&#93;-eigvectL&#91;i&#93;&#91;4&#93;*disp,\<br />&nbsp; &nbsp; &nbsp; (xred&#91;3&#93;*cell)&#91;0,2&#93;-eigvectL&#91;i&#93;&#91;5&#93;*disp)<br />&nbsp; print &quot;&nbsp; &quot;<br />&nbsp; j += 1 <br /></code></pre></div><br /><br />As we have a supercell there is a folding that will happen. The matrix element we want to compute is actually:<br /><br />&lt;n'k+q | dV/dR | nk&gt; = &lt;1L| H(1) | 1G&gt; = &lt;2G|H(1)|1G&gt;<br /><br />It can be shown (by making a taylor expansion of |psi_1(lambda)&gt; and other quantities that :<br /><br />&lt;2G|H(1)|1G&gt; = (e_1(lambda) - e_2(0)) &lt;psi_2(0)|psi_1(1)&gt; + O(lambda^2)<br /><br />with indices indicating the band number and (0) an equilibrium position (unperturbed quantity) and with psi_1(1) = (psi_1(lambda)-psi_1(0))/lambda the first order perturbation obtained by finite difference also. <br /><br />Using the following script (using the cut3d tool of abinit):<br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># ----------------------------------------------------------------<br /># This python script is used to compute the matrix element<br />#&nbsp; &lt;n,k+q|H(1)|n',k&gt; <br /># Here we specfically take n=1, n'=2 at gamma<br /># This correspond to k=gamma and q=L <br /># ---------------------------------------------------------------<br />import os<br />import numpy as np<br /><br />def read_eigenenergies(datafile):<br />&nbsp; flag = False<br />&nbsp; with open(datafile,'r') as f:<br />&nbsp; &nbsp; for line in f:<br />&nbsp; &nbsp; &nbsp; if flag:<br />&nbsp; &nbsp; &nbsp; &nbsp; eigenenergies = map(float,line.split())<br />&nbsp; &nbsp; &nbsp; &nbsp; break<br />&nbsp; &nbsp; &nbsp; if &quot;kpt=&nbsp; 0.0000&nbsp; 0.0000&nbsp; 0.0000&quot; in line:<br />&nbsp; &nbsp; &nbsp; &nbsp; flag = True<br />&nbsp; return eigenenergies<br /><br />def use_cut3d(datafile,out,gamma,band):<br />&nbsp; if datafile&#91;len(datafile)-3:len(datafile)&#93; == &quot;POT&quot;:<br />&nbsp; &nbsp; os.system(&quot;rm cut3d.files&quot;)<br />&nbsp; &nbsp; with open(&quot;cut3d.files&quot;,&quot;a&quot;) as files:<br />&nbsp; &nbsp; &nbsp; files.write(str(datafile)+&quot;\n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;1 \n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;5 \n&quot;)&nbsp; #3D formatted data <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#(output the bare 3D data - one column) <br />&nbsp; &nbsp; &nbsp; files.write(str(out)+&quot;\n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;0 \n&quot;)<br />&nbsp; &nbsp; os.system(&quot;cut3d &lt; cut3d.files &quot;)<br />&nbsp; if datafile&#91;len(datafile)-3:len(datafile)&#93; == &quot;WFK&quot;:<br />&nbsp; &nbsp; os.system(&quot;rm wfk.files&quot;)<br />&nbsp; &nbsp; with open(&quot;wfk.files&quot;,&quot;a&quot;) as files:<br />&nbsp; &nbsp; &nbsp; files.write(str(datafile)+&quot;\n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;1 \n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;0 \n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(str(gamma)+&quot; \n&quot;) # Gamma point<br />&nbsp; &nbsp; &nbsp; files.write(str(band)+&quot; \n&quot;) # Band nb 6<br />&nbsp; &nbsp; &nbsp; files.write(&quot;0 \n&quot;) <br />&nbsp; &nbsp; &nbsp; files.write(&quot;0 \n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;1 \n&quot;) # real 3D data one column<br />&nbsp; &nbsp; &nbsp; files.write(str(out)+&quot; \n&quot;)<br />&nbsp; &nbsp; &nbsp; files.write(&quot;0 \n&quot;)<br />&nbsp; &nbsp; os.system(&quot;cut3d &lt; wfk.files &quot;)<br /><br />def first_order_wf(wfk0,wfk1,lam):<br />&nbsp; S=0.0; N=0.0<br />&nbsp; psi0 = np.loadtxt(wfk0).view(complex)<br />&nbsp; psi1 = np.loadtxt(wfk1).view(complex)<br />&nbsp; S = (psi1-psi0)/lam&nbsp; <br />#&nbsp; np.savetxt('first_order_wfc.txt', S)<br />&nbsp; return S<br /><br />def integrationwf(wfk1,wfk2):<br />&nbsp; S=0.0; N=0.0<br />&nbsp; psi1 = np.loadtxt(wfk1).view(complex)<br />&nbsp; if type(wfk2) != str:<br />&nbsp; &nbsp; psi2 = wfk2<br />&nbsp; &nbsp; S = psi1.conj()*psi2<br />&nbsp; &nbsp; N1 = psi1.conj()*psi1<br />&nbsp; &nbsp; return S.sum()/N1.sum()<br />&nbsp; else:<br />&nbsp; &nbsp; psi2 = np.loadtxt(wfk2).view(complex)<br />&nbsp; &nbsp; S = psi1.conj()*psi2<br />&nbsp; &nbsp; N1 = psi1.conj()*psi1<br />&nbsp; &nbsp; return S.sum()/N1.sum()<br /><br />&nbsp; &nbsp; <br /># The base name for the supercell files are assumed to be named &quot;supercell&quot;<br /># and the primitive as assumed to be named &quot;primitive&quot;<br /># Value and number of the displacement<br />h = np.array(&#91;0.1,0.05,0.025,0.0125,0.00625,0.003125,0.0015625&#93;)<br /># Initialisation values<br />k = 0<br /><br /># Frequency (computed in DFPT using ABINIT)<br />omega = np.array(&#91;0.00480084,0.005785943,0.002453274,0.005671174&#93;)<br /><br /># Carbon mass in a.u.<br />Mc = 21894.16693<br /><br /># --------------------------------------------------<br /># Compute &lt;psi|dVscf|psi&gt; = de_1G<br /># --------------------------------------------------<br /><br /># Second derivative using finite centred differences<br /># The second dimension is the number of h in geometric progression<br /># h,h/2,h/4,h/8 etc..<br /># The third index correspond to modes (here 4)<br /># The first index correspond to the Richardson extrapolation<br />D = np.zeros(&#91;len(h),len(h),4&#93;)<br /><br /># Prepare equilibrium files<br /># k=gamma<br /># q = L<br />use_cut3d(&quot;supercello_DS1_WFK&quot;,&quot;wfkEQ&quot;,1,2) # psi_2^{(0)}<br />use_cut3d(&quot;supercello_DS1_WFK&quot;,&quot;wfkEQ&quot;,1,1) # psi_2^{(0)}<br /><br /><br />energy2 = read_eigenenergies(&quot;supercello_DS1_EIG&quot;)<br /><br /><br />while k &lt; len(h):<br />&nbsp; use_cut3d(&quot;supercello_DS&quot;+str(k+2)+&quot;_WFK&quot;,&quot;wfk&quot;,1,1) # psi_1(lambda)<br />&nbsp;<br />&nbsp; psi1 = first_order_wf(&quot;wfkEQ_k1_b1_s1&quot;,&quot;wfk_k1_b1_s1&quot;,h&#91;k&#93;)<br />&nbsp; print &quot;psi1&quot;, psi1<br />&nbsp; LO = integrationwf(&quot;wfkEQ_k1_b2_s1&quot;,psi1) <br />&nbsp; print &quot;LO:&quot;, LO<br />&nbsp; energy1 = read_eigenenergies(&quot;supercello_DS&quot;+str(k+2)+&quot;_EIG&quot;) <br /><br /><br /># Define the phase<br /># phase = &lt;psi1(0)|psi1(lambda)&gt;/| &lt;psi1(0)|psi1(lambda)&gt;|<br />&nbsp; phase_int = integrationwf(&quot;wfkEQ_k1_b1_s1&quot;,&quot;wfk_k1_b1_s1&quot;) <br />&nbsp; phase_mod = np.abs(phase_int)<br />&nbsp; phase = phase_int/phase_mod<br />#&nbsp; print &quot;phase&quot;,phase<br />&nbsp; <br />&nbsp; elph=(energy1&#91;0&#93;-energy2&#91;1&#93;)*LO/phase<br />&nbsp; print &quot;elph&quot;,elph<br />#&nbsp; g12k=elph*(np.sqrt(1/(2*Mc*omega&#91;1&#93;)))<br />#&nbsp; print &quot;g12k&quot;, g12k<br /># LA mode<br />&nbsp; D&#91;0,k,0&#93; = elph<br />&nbsp; k += 1<br /><br />l = 0<br />while l &lt; len(h):<br />&nbsp; k = 0<br />&nbsp; while k &lt; len(h):<br />&nbsp; &nbsp; if (l-1) &gt;= 0 and (k-1) &gt;= 0:<br />#&nbsp; &nbsp; &nbsp;LA mode&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; D&#91;l,k,0&#93; = (D&#91;l-1,k,0&#93;-(D&#91;l-1,k-1,0&#93;*(1.0/(2**(2*l)))))/\<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(1-(1.0/(2**(2*l))))<br />&nbsp; &nbsp; &nbsp; if D&#91;l-1,k-1,0&#93; == 0.0:<br />&nbsp; &nbsp; &nbsp; &nbsp; D&#91;l,k,0&#93; = 0.0<br />#&nbsp; &nbsp; &nbsp;LO mode<br />&nbsp; &nbsp; k += 1<br />&nbsp; l += 1<br />print &quot;Richardson extrapolation of &lt;psi_2^{(0)}|dVscf|psi_1^{(0)} for LO&quot;<br />print D</code></pre></div><br /><br />I obtain a value (after convergence of the finite difference using a Richardson extrapolation) of <strong class="text-strong">0.05747 + 1E-12j </strong><br /><br />This value compare poorly with the one obtained by the 77_ddb/prt_gkk_yambo routine. <br /><br />Am I missing something? Is there additional stuff in the yambo_elphon_gkk_bymode file? (not the yambo_elphon_gkksqtw_bymode)<br /><br />Thank you.<br /><br />Samuel.<br /><br />PS: If you want to run the calculations, it take less than 10 min on a normal desktop computer.</div>
			
			
			
													<div class="notice">
					Last edited by <a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a> on Thu Dec 01, 2011 12:09 pm, edited 1 time in total.
									</div>
			
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p4465" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4465">
			<dt class="no-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1bef.html?author_id=72&amp;sr=posts">655</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 19, 2009 12:01 pm</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4465">

						<h3 ><a href="#p4465">Re: Consistency check: finite diff. vs DFPT on el-ph matrix </a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="posting85bc.html?mode=quote&amp;f=10&amp;p=4465" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopicf2a5.html?p=4465#p4465" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlist32d1.html?mode=viewprofile&amp;u=72" class="username">mverstra</a></strong> &raquo; </span>Sat Nov 26, 2011 1:30 am
			</p>
			
			
			
			<div class="content">Hello Samuel,<br /><br />good that someone is doing these checks - we are in the process of verifying similar things as well.<br /><br />You could start with something simpler, with just 1 type of atom in the unit cell, or even just 1 atom. You may not have interesting DW terms, but we can narrow down if there actually is a problem in elphon or prt_gkk_yambo.<br /><br />The first thing to check would be the agreement between the epc matrix element in the GKK file (use second line of mrggkk input file = 1 for ascii output to read out the matrix elements) for primitive perturbations, not for composite mode-dependent ones. If these agree with the corresponding things you get out of your scripts, good - this means your finite difference is correct. These come straight out of abinit's phonon calculation (perturbed eigenvalue matrix for the psi(1)), so they have not been processed by anaddb/elphon yet.<br /><br />If you want to freeze modes for certain q-points, you can also use the anaddb input variable: <!-- m --><a class="postlink" href="http://www.abinit.org/documentation/helpfiles/for-v6.8/users/anaddb_help.html#freeze_displ">http://www.abinit.org/documentation/hel ... eeze_displ</a><!-- m --><br /><br />Next, the prt gkk yambo outputs the scalar product of the gkk matrix elements with the phonon displacement vectors. This could be part of the difference you observe, if you are just calculating the gkk &quot;along the phonon _eigenvector_&quot; (hence mode specific). I have not analysed your whole code to see exactly what it does, but your procedure looks quite thorough. Could you also check more matrix elements? If there is a constant factor between the RF and finite differences it's another story...<br /><br />We have (only) used some of the prt_gkk_yambo output for some molecules (no q different from gamma) and the orders of magnitude were reasonable compared to experiments.<br /><br />good luck...<br /><br />Matthieu</div>
			
			
			
									
									<div id="sig4465" class="signature">Matthieu Verstraete<br />University of Liege, Belgium</div>
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p4469" class="post has-profile bg2 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4469">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="avatar"><img class="avatar" src="download/file9095.jpg?avatar=677_1376048665.jpg" width="83" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1632.html?author_id=677&amp;sr=posts">60</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 16, 2011 9:44 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4469">

						<h3 ><a href="#p4469">Re: Consistency check: finite diff. vs DFPT on el-ph matrix</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingab6f.html?mode=quote&amp;f=10&amp;p=4469" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic7652.html?p=4469#p4469" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a></strong> &raquo; </span>Sun Nov 27, 2011 6:49 pm
			</p>
			
			
			
			<div class="content">Dear Matthieu, <br /><br />Thank you for your reply.<br /><br />I took a look at the GKK txt file (by the way this file is not very human readable..). You have for each q-point and each perturbations (in my case 8 q-points and 6 perturbation) a bunch of number. As in my case I have 64 column and 8 lines (or 48 column and 6 lines). I suppose the 8/6 lines corresponds to k points and the 64/48 I'm not very sure (maybe symmetries?)<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Second record :<br />&nbsp;bantot,intxc,ixc,natom&nbsp; =&nbsp; &nbsp; 48&nbsp; &nbsp; &nbsp;0&nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp;2<br />&nbsp;ngfft(1:3),nkpt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; &nbsp; 20&nbsp; &nbsp; 20&nbsp; &nbsp; 20&nbsp; &nbsp; &nbsp;6<br />&nbsp;nspden,nspinor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp;1<br />&nbsp;nsppol,nsym,npsp,ntypat =&nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; 48&nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp;1<br />&nbsp;occopt,pertcase,usepaw&nbsp; =&nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp;4&nbsp; &nbsp; &nbsp;0<br />&nbsp;ecut,ecutdg,ecutsm&nbsp; &nbsp; &nbsp; =&nbsp; 2.2000000000E+01&nbsp; 2.2000000000E+01&nbsp; 0.0000000000E+00<br />&nbsp;ecut_eff&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&nbsp; 2.2000000000E+01<br />&nbsp;qptn(1:3)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; 5.0000000000E-01&nbsp; 0.0000000000E+00&nbsp; 0.0000000000E+00<br />&nbsp;rprimd(1:3,1)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; 0.0000000000E+00&nbsp; 3.3150000000E+00&nbsp; 3.3150000000E+00<br />&nbsp;rprimd(1:3,2)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; 3.3150000000E+00&nbsp; 0.0000000000E+00&nbsp; 3.3150000000E+00<br />&nbsp;rprimd(1:3,3)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; 3.3150000000E+00&nbsp; 3.3150000000E+00&nbsp; 0.0000000000E+00<br />&nbsp;stmbias,tphysel,tsmear&nbsp; =&nbsp; 0.0000000000E+00&nbsp; 0.0000000000E+00&nbsp; 4.0000000000E-02</code></pre></div><br /><br />...<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;0.44595139423422464&nbsp; &nbsp; &nbsp; &nbsp;1.77809156287622727E-016&nbsp; 0.62556261897994014&nbsp; &nbsp; &nbsp; -1.16226472890446075E-016 -0.30682675412234534&nbsp; &nbsp; &nbsp; &nbsp;1.94289029309402395E-016&nbsp; 0.19201311145008293&nbsp; &nbsp; &nbsp; -1.80411241501587938E-016 -8.19643252579404236E-002&nbsp; 2.77555756156289135E-017&nbsp; 7.00803806696240206E-002 -2.77555756156289135E-017&nbsp; 9.22065433236523430E-002 -2.49800180540660222E-016&nbsp; 4.01291708801466140E-002 -3.46944695195361419E-018 -0.37962713652926161&nbsp; &nbsp; &nbsp; -2.60208521396521064E-017 -0.26859958650978760&nbsp; &nbsp; &nbsp; &nbsp;1.50573997714786856E-015&nbsp; 0.85066309406647533&nbsp; &nbsp; &nbsp; -4.57966997657877073E-016 -0.49393898705373085&nbsp; &nbsp; &nbsp; &nbsp;4.85722573273505986E-016&nbsp; 0.15021368827388526&nbsp; &nbsp; &nbsp; -8.60422844084496319E-016&nbsp; 0.32862429177217994&nbsp; &nbsp; &nbsp; &nbsp;8.60422844084496319E-016&nbsp; 0.61346448972327849&nbsp; &nbsp; &nbsp; -1.66533453693773481E-016 -1.83142586366989435E-002 -1.74860126378462155E-015 -0.23378226550280476&nbsp; &nbsp; &nbsp; &nbsp;3.81639164714897561E-017 -0.28773904977673476&nbsp; &nbsp; &nbsp; -2.08166817117216851E-016&nbsp; 0.36109031140769726&nbsp; &nbsp; &nbsp; &nbsp;1.24900090270330111E-016 -0.28675358262984174&nbsp; &nbsp; &nbsp; -5.20417042793042128E-016 -0.43883973791676112&nbsp; &nbsp; &nbsp; &nbsp;1.38777878078144568E-016 -0.34809016403378051&nbsp; &nbsp; &nbsp; -6.93889390390722838E-017&nbsp; 0.40020860795904312&nbsp; &nbsp; &nbsp; &nbsp;5.55111512312578270E-017 -4.41069234458554768E-002&nbsp; 4.23272528138340931E-016&nbsp; 2.79210028743514319E-002&nbsp; 1.92207361138230226E-015 -0.53962677235096446&nbsp; &nbsp; &nbsp; -1.49186218934005410E-015 -0.62597631717959035&nbsp; &nbsp; &nbsp; &nbsp;2.35922392732845765E-016&nbsp; 0.40503017872535296&nbsp; &nbsp; &nbsp; -9.71445146547011973E-017 -7.66401033568450130E-002&nbsp; 3.60822483003175876E-016&nbsp; 0.22370544873011475&nbsp; &nbsp; &nbsp; -1.38777878078144568E-016&nbsp; 5.74216541691718874E-002&nbsp; 1.55431223447521916E-015 -0.14876957244473210&nbsp; &nbsp; &nbsp; &nbsp;9.57567358739197516E-016 -5.60184753092377030E-003&nbsp; 3.38162657598228833E-016&nbsp; 0.28114232408925982&nbsp; &nbsp; &nbsp; &nbsp;2.13414355632046693E-015 -0.44160851631024184&nbsp; &nbsp; &nbsp; -2.02095284951298026E-015 -1.02740840100565278E-003&nbsp; 1.21300539057678236E-015&nbsp; 0.19844634419925669&nbsp; &nbsp; &nbsp; -1.39558503642334131E-015&nbsp; 0.80028768460450306&nbsp; &nbsp; &nbsp; &nbsp;1.46931078415235561E-015&nbsp; 0.41130628923019552&nbsp; &nbsp; &nbsp; &nbsp;2.79290479632265942E-016 -0.40381303757292397&nbsp; &nbsp; &nbsp; -2.94686150481560105E-015 -3.48195138152371866E-002 -1.23154524772628449E-015&nbsp; 0.27721407046753532&nbsp; &nbsp; &nbsp; &nbsp;8.13151629364128326E-017 -0.35113226428653666&nbsp; &nbsp; &nbsp; -5.55111512312578270E-017&nbsp; 0.43474789936268315&nbsp; &nbsp; &nbsp; -1.02348685082631619E-016 -0.75338646167169221&nbsp; &nbsp; &nbsp; -1.43982048506074989E-016 -0.10768220711724515&nbsp; &nbsp; &nbsp; -3.47812056933349822E-016&nbsp; 0.49109452094624950&nbsp; &nbsp; &nbsp; -1.04950770296596829E-015 -0.41367732052904099&nbsp; &nbsp; &nbsp; &nbsp;1.90819582357448780E-017&nbsp; 0.20872817982831593&nbsp; &nbsp; &nbsp; &nbsp;1.49403059368502511E-015&nbsp; 0.64673873923870129&nbsp; &nbsp; &nbsp; -3.90312782094781596E-016&nbsp; 0.30793987926721234&nbsp; &nbsp; &nbsp; -9.29811783123568603E-016 -0.16428708911692078&nbsp; &nbsp; &nbsp; &nbsp;1.93421667571413991E-016&nbsp; 0.10195528420346833&nbsp; &nbsp; &nbsp; -5.96744875736021640E-016 -0.18656039925249518&nbsp; &nbsp; &nbsp; &nbsp;4.09394740330526474E-016&nbsp; 0.29912029517154665&nbsp; &nbsp; &nbsp; &nbsp;1.91860416443034865E-015 -0.81162776245840806&nbsp; &nbsp; &nbsp; &nbsp;3.33066907387546962E-016&nbsp; 0.20238776613061746&nbsp; &nbsp; &nbsp; -4.30211422042248159E-016&nbsp; 0.40657805854172357&nbsp; &nbsp; &nbsp; -5.06539254985227672E-016 -0.44524198141133736&nbsp; &nbsp; &nbsp; &nbsp;1.59594559789866253E-016&nbsp; 0.27863377964857727&nbsp; &nbsp; &nbsp; -2.16840434497100887E-016 -0.31825233153517957&nbsp; &nbsp; &nbsp; &nbsp;4.16333634234433703E-017&nbsp; 0.27210917067319196&nbsp; &nbsp; &nbsp; &nbsp;9.71445146547011973E-017 -0.17045228569448914&nbsp; &nbsp; &nbsp; -6.59194920871186696E-016 -0.59498993355888818&nbsp; &nbsp; &nbsp; &nbsp;2.63677968348474678E-016</code></pre></div><br />(6 blocks like this)<br /><br /><br />Thank you for the  <strong class="text-strong">freeze_displ</strong> variable in anaddb. I didn't know it. I tested it in an anaddb input file for the L q-point and a value of <strong class="text-strong">freeze_displ=0.1</strong> and got 6 new files corresponding to the 6 modes. Looking at the 4th one (LO), I found this:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>xcart&nbsp; &nbsp; &nbsp;0.2759019314E-03&nbsp; &nbsp; 0.2759019314E-03&nbsp; &nbsp; 0.2759019314E-03<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.1667473676E+01&nbsp; &nbsp; 0.1667473676E+01&nbsp; &nbsp; 0.1667473676E+01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -0.2759019314E-03&nbsp; &nbsp; 0.3335223255E+01&nbsp; &nbsp; 0.3335223255E+01<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0.1668025480E+01&nbsp; &nbsp; 0.5003524637E+01&nbsp; &nbsp; 0.5003524637E+01</code></pre></div><br /><br />As you can see the norm of the total displacement of the two atoms along the phonon mode gives sqrt(6*(0.2759019314E-03**2))=0.00067581895097836801 and not 0.1 as I would of expected...<br /><br />As a comparison my scripts gives me:<br /><br /><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>&nbsp;xcart&nbsp; &nbsp; 0.040824829810633&nbsp; -0.040824827654666&nbsp; 0.040824830354621&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.626924748911545&nbsp; 1.708574403831663&nbsp; 1.626924746736720&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-0.040824829810633&nbsp; 3.376323977654666&nbsp; 3.294674319645379&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.708574407638455&nbsp; 4.962423899443337&nbsp; 5.044073556538280</code></pre></div><br /><br />for the same mode. This gives sqrt(6*(0.040824829810633**2)) = 0.1<br /><br />Using the displacement given by the variable  <strong class="text-strong">freeze_displ</strong> and using 0.1 as lambda displacement parameter I get: <strong class="text-strong"> -0.00038875+1.13943949909e-18j</strong><br /><br />Cheers!<br /><br />Samuel.<br /><br /><br />EDIT: The difference comes from the normalisation by the carbon mass in atomic unit. I now have the same value.</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
				<div id="p4582" class="post has-profile bg1 offline">
		<div class="inner">

		<dl class="postprofile" id="profile4582">
			<dt class="no-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="avatar"><img class="avatar" src="download/file9095.jpg?avatar=677_1376048665.jpg" width="83" height="92" alt="User avatar" /></a>														</div>
								<a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a>							</dt>

									
		<dd class="profile-posts"><strong>Posts:</strong> <a href="search1632.html?author_id=677&amp;sr=posts">60</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 16, 2011 9:44 am</dd>		
		
						
						
		</dl>

		<div class="postbody">
						<div id="post_content4582">

						<h3 ><a href="#p4582">Re: Consistency check: finite diff. vs DFPT on el-ph matrix</a></h3>

													<ul class="post-buttons">
																																									<li>
							<a href="postingd2aa.html?mode=quote&amp;f=10&amp;p=4582" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
														</ul>
							
						<p class="author">
									<a class="unread" href="viewtopic47fc.html?p=4582#p4582" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="memberlistbd9e.html?mode=viewprofile&amp;u=677" class="username">sponce</a></strong> &raquo; </span>Thu Dec 15, 2011 9:35 pm
			</p>
			
			
			
			<div class="content">Dear all, <br /><br />As suggested by Matthieu I tried to compare matrix element in reducible coordinate rather than along conjugate phonon mode.<br /><br />First I would like to point that the system I choose to study is indeed diamond and not CaS as wrongly mentioned in my first post.<br /><br />I believe that this is the easiest system with two atoms per unit cell (to still have some interesting features).<br /><br />The GKK contain the following el-phonon matrix elements:<br /><br />&lt;n',k+q|dV/dR_tau,alpha|n,k&gt;<br /><br />In order to compute &lt;1,L|dV/dR_tau,alpha|1,G&gt; I created a 2x1x1 supercell with 4 atoms. In the q=L point the atoms from the first unit cell will move in one direction and the atoms from the other will move in the opposite direction.<br /><br />Due to folding of the electronic band structure while doing electroninc bandstructure calculation this matrix element correspond to &lt;2,G|dV/dR_tau,alpha|1,G&gt;<br /><br />Let us make a perturbation expansion of the form \psi(\lambda) = \psi^0 + \lambda \psi^{(1)} + ...<br /><br />&lt;\psi_2^0|\epsilon_1(\lambda)|\psi_1(\lambda)&gt; = &lt;\psi_2^0|H(\lambda)|\psi_1(\lambda)&gt;<br /><br />\epsilon_1(\lambda)( &lt;\psi_2^0|\psi_1^0&gt; + \lambda&lt;\psi_2^0|\psi_1^(1)&gt; + O(\lambda^2) ) = \epsilon_1^0&lt;\psi_2^0|\psi_1^0&gt; + \lambda&lt;\psi_2^(0)|H^(1)|\psi_1^(0)&gt;+\lambda&lt;\psi_2^(0)|H^(0)|\psi_1^(1)&gt; + O(\lambda^2)<br /><br />The first terms on the left and on the right of the last equation are both zero due to orthonormality condition.<br /><br />This last equation reduces itself down to:<br /><br />&lt;\psi_2^0|H^(1)|\psi_1^0&gt; = (\epsilon_1(\lambda)-\epsilon_2^0)&lt;\psi_2^0|\psi_1^(1)&gt; + 0(\lambda^2)<br /><br />avec \psi_1^(1) = (\psi_1(\lambda)-\psi_1^0)/\lambda<br /><br />Using the same pseudo and all (expect the k-point grid. 4x4x4 and 2x4x4 in the supercell case) I got the following result:<br /><br /><strong class="text-strong">GKK</strong><br />qptn 0.5 0.0 0.0<br />pertcase 1 (along 0.0 0.5 0.5 direction)<br />kpoint:<br />0.5 0.0 0.0 <br />==&gt;n'=1, n=1 :::: -0.445951-2.56E-16j <br />==&gt;n'=1, n=2 ::::  0.625562-5.1E-16j <br />1.0 0.0 0.0 <br />==&gt;n'=1, n=1 :::: -0.445951-1.5E-16j<br />==&gt;n'=1, n=2 ::::  0.37962+1.8E-17j <br />==&gt;n'=2, n=1 ::::  0.625562-5.6E-10j<br /><br />pertcase 2 (along 0.5 0.0 0.5 direction)<br />kpoint:<br />0.5 0.0 0.0 <br />==&gt;n'=1, n=1 :::: -2.04E-10+1.05E-16j<br />==&gt;n'=1, n=2 ::::  1.25E-11-2.1E-16j <br />1.0 0.0 0.0 <br />==&gt;n'=1, n=1 :::: -2.04E-16-1.5E-16j<br />==&gt;n'=1, n=2 ::::  0.3185+1.8E-17j <br />==&gt;n'=2, n=1 ::::  1.28E-11-5.6E-16j<br /><br /><strong class="text-strong">FINITE DIFFERENCE</strong><br />qptn 0.5 0.0 0.0<br />pertcase 1 (along 0.0 0.5 0.5 direction)<br />kpoint: <br />0.0 0.0 0.0 <br />==&gt;n'=1, n=1 :::: -0.469973-2E-17j<br />==&gt;n'=2, n=1 ::::  0.74031-1E-16j<br /><br />pertcase 2 (along 0.5 0.0 0.5 direction)<br />kpoint:<br />0.0 0.0 0.0 <br />==&gt;n'=1, n=1 ::::  9.49E-11-1.6E-17j  <br />==&gt;n'=2, n=1 ::::  1.39E-9-2E-17j<br /><br />As we can see the agreement is not that good... any suggestions?<br /><br />PS: The abinit forum should contain latex flag...</div>
			
			
			
									
									
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	<hr class="divider" />
	

	<div class="action-bar bar-bottom">
	
			<a href="postingf3f8.html?mode=reply&amp;f=10&amp;t=1443" class="button" title="This topic is locked, you cannot edit posts or make further replies.">
							<span>Locked</span> <i class="icon fa-lock fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																												<li>
					<a href="viewtopic1d67-3.html?f=10&amp;t=1443&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="https://forum.abinit.org/viewtopic.php?f=10&amp;t=1443">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			4 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="viewforum15ca.html?f=10" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Response calculations”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="viewforumffeb.html?f=20" class="jumpbox-forum-link"> <span> News &amp; Announcements</span></a></li>
																<li><a href="viewforum8011.html?f=23" class="jumpbox-forum-link"> <span> Jobs and Other Announcements</span></a></li>
																<li><a href="viewforum58da.html?f=1" class="jumpbox-cat-link"> <span> Building ABINIT</span></a></li>
																<li><a href="viewforum4d6b.html?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Configuring and compiling ABINIT</span></a></li>
																<li><a href="viewforum31e6.html?f=4" class="jumpbox-cat-link"> <span> Running Abinit</span></a></li>
																<li><a href="viewforumfdc5.html?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Ground state</span></a></li>
																<li><a href="viewforum15ca.html?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Response calculations</span></a></li>
																<li><a href="viewforum8a83.html?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Many-body perturbation theory</span></a></li>
																<li><a href="viewforum01c9.html?f=12" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Other tools and postprocessing in ABINIT</span></a></li>
																<li><a href="viewforum345c.html?f=24" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Python interfacing : Abipy ecosystem</span></a></li>
																<li><a href="viewforum9780.html?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Link to other codes</span></a></li>
																<li><a href="viewforume774.html?f=5" class="jumpbox-cat-link"> <span> Developing Abinit</span></a></li>
																<li><a href="viewforum218b.html?f=19" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Improving ABINIT</span></a></li>
											</ul>
		</div>
	</div>

	</div>


			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar navbar-bottom" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="index-2.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				
							<li class="rightside">
				<a href="ucp033a.html?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
				
		<li class="rightside" data-last-responsive="true"><a href="app.php/aboutus.html" role="menuitem"><i class="icon fa-info-circle fa-fw" aria-hidden="true"></i><span>About us</span></a></li>			</ul>

	</div>
</div>

	<div class="copyright">
		<script type="text/javascript">
copyright=new Date();

update=copyright.getFullYear();

document.write("Copyright\u0020\u0026copy\u003B 2009 - "+ update +	" ABINIT Discussion Forums All\u0020rights\u0020reserved.");

</script>
<br /><br />		<p class="footer-row">
			<span class="footer-copyright">Flat Style by <a href="http://phpbbstyles.oo.gd/">Ian Bradley</a></span>
		</p>
        <p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row">
			<a class="footer-link" href="ucp4d86.html?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="ucp226b.html?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="assets/javascript/jquery.minaea1.js?assets_version=57"></script>
<script src="assets/javascript/coreaea1.js?assets_version=57"></script>



<script>
	(function() {
		var cx = '017804512478788106347\u003Atlftx8kncg4';
		var gcse = document.createElement('script');
		gcse.type = 'text/javascript';
		gcse.async = true;
		gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
			'//cse.google.com/cse.js?cx=' + cx;
		var s = document.getElementsByTagName('script')[0];
		s.parentNode.insertBefore(gcse, s);
	})();
</script>
<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="ext/hifikabin/clock/styles/all/template/js/js_clockaea1.js?assets_version=57"></script>
<script src="ext/phpbb/collapsiblecategories/styles/all/template/js/collapsiblecategoriesaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/forum_fnaea1.js?assets_version=57"></script>
<script src="styles/prosilver/template/ajaxaea1.js?assets_version=57"></script>



</body>

<!-- Mirrored from forum.abinit.org/viewtopic.php?p=4582 by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 21 Sep 2024 03:05:26 GMT -->
</html>
